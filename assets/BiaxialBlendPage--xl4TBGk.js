import{r as o,j as e}from"./vendor-react-D0vdeqNS.js";import{R as k}from"./index-B8AH_Q18.js";import{r as z,g as x}from"./umf-DcIxpM70.js";import{u as E,A as L,m as A}from"./index-Cx-RWLMS.js";import{p as M}from"./validation-D_egBSYF.js";import{a as j}from"./blend-xGiHwjeo.js";import{exportBlendCSV as _,printLabels as D}from"./export-UL09t0Ez.js";import{u as I}from"./usePageTitle-Dfez-EUD.js";import{c as T}from"./calc-styles-u5C4IXOP.js";import{u as G}from"./vendor-router-DjLFn5nj.js";import"./vendor-state-DTYbmM1J.js";const f={matte:"#4caf50",satin:"#8bc34a",gloss:"#2196f3",underfired:"#9e9e9e",crazed:"#f44336",unknown:"#444"};function te(){I("Biaxial Blend");const[c,N]=o.useState(null),[s,g]=o.useState({material:"",maxPercent:15}),[l,v]=o.useState({material:"",maxPercent:15}),[i,B]=o.useState(5),[m,C]=o.useState([]),[y,F]=o.useState("6"),{setBlendResults:b}=E(),w=G(),S=o.useCallback(()=>{if(!c||!s.material.trim()||!l.material.trim())return;const t=[];for(let r=0;r<=i;r++)for(let d=0;d<=i;d++){const n=r/i*s.maxPercent,h=d/i*l.maxPercent,P={...c,id:`biaxial_${r}_${d}`,name:`${s.material} ${n.toFixed(1)}% + ${l.material} ${h.toFixed(1)}%`,ingredients:[...c.ingredients,...n>0?[{material:s.material,amount:n,unit:"weight"}]:[],...h>0?[{material:l.material,amount:h,unit:"weight"}]:[]]},p=z(P,A).value||null,O=p?M(p):"unknown";t.push({row:r,col:d,addAPercent:n,addBPercent:h,umf:p,surface:O,recipe:P})}C(t);const a=t.filter(r=>r.umf).map((r,d)=>({index:d,coordinates:[1-(r.addAPercent+r.addBPercent)/100,r.addAPercent/100,r.addBPercent/100],recipe:r.recipe,umf:r.umf}));b(a)},[c,s,l,i,y,b]),$=c&&c.ingredients.some(t=>t.material.trim()&&t.amount>0)&&s.material.trim()&&l.material.trim(),R=(i+1)*(i+1);return e.jsxs("div",{className:"calc-page",children:[e.jsxs("div",{className:"calc-sidebar",onKeyDown:t=>{t.key==="Enter"&&!(t.target instanceof HTMLTextAreaElement)&&S()},children:[e.jsxs("div",{className:"calc-section",children:[e.jsx("h2",{children:"Biaxial Blend"}),e.jsxs("p",{className:"subtitle",children:["Add two materials independently to a base recipe — creates a ",i+1,"×",i+1," grid"]})]}),e.jsxs("div",{className:"calc-section",children:[e.jsx("h3",{children:"Base Recipe"}),e.jsx(k,{label:"Base Glaze",color:"#6366F1",recipe:c,onChange:N})]}),e.jsxs("div",{className:"calc-section",children:[e.jsx("h3",{children:"Addition A (rows ↓)"}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"end"},children:[e.jsx("div",{style:{flex:1},children:e.jsx("input",{type:"text",value:s.material,onChange:t=>g(a=>({...a,material:t.target.value})),placeholder:"Material name...",list:"common-materials",style:u})}),e.jsxs("div",{style:{width:80},children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-secondary)",display:"block",marginBottom:2},children:"Max %"}),e.jsx("input",{type:"number",value:s.maxPercent,onChange:t=>g(a=>({...a,maxPercent:parseFloat(t.target.value)||0})),min:1,max:50,step:1,style:u})]})]})]}),e.jsxs("div",{className:"calc-section",children:[e.jsx("h3",{children:"Addition B (columns →)"}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"end"},children:[e.jsx("div",{style:{flex:1},children:e.jsx("input",{type:"text",value:l.material,onChange:t=>v(a=>({...a,material:t.target.value})),placeholder:"Material name...",list:"common-materials",style:u})}),e.jsxs("div",{style:{width:80},children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-secondary)",display:"block",marginBottom:2},children:"Max %"}),e.jsx("input",{type:"number",value:l.maxPercent,onChange:t=>v(a=>({...a,maxPercent:parseFloat(t.target.value)||0})),min:1,max:50,step:1,style:u})]})]})]}),e.jsxs("div",{className:"calc-section",children:[e.jsx("h3",{children:"Grid"}),e.jsxs("div",{className:"calc-controls",children:[e.jsxs("div",{className:"control-row",children:[e.jsx("label",{children:"Divisions"}),e.jsx("input",{type:"range",min:2,max:10,step:1,value:i,onChange:t=>B(Number(t.target.value))}),e.jsx("span",{className:"range-value",children:i})]}),e.jsxs("div",{className:"point-count",children:[e.jsx("strong",{children:R})," test tiles"]}),e.jsxs("div",{className:"control-row",children:[e.jsx("label",{children:"Cone"}),e.jsx("select",{value:y,onChange:t=>F(t.target.value),style:{flex:1,padding:"6px 8px",background:"var(--bg-input)",border:"1px solid var(--border-secondary)",borderRadius:6,color:"var(--text-bright)",fontSize:13},children:L.map(t=>e.jsxs("option",{value:t,children:["Cone ",t]},t))})]})]})]}),e.jsx("button",{className:"calc-button",onClick:S,disabled:!$,children:"Generate Grid"})]}),e.jsx("div",{className:"calc-main",children:m.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"results-panel",children:[e.jsxs("div",{className:"results-header",children:[e.jsx("h3",{children:"Surface Prediction Grid"}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{onClick:()=>w("/"),style:j,children:"View on Explorer"}),e.jsx("button",{onClick:()=>_(m.filter(t=>t.umf).map(t=>({label:`${s.material} ${t.addAPercent.toFixed(1)}% + ${l.material} ${t.addBPercent.toFixed(1)}%`,umf:t.umf,meta:{[`${s.material}%`]:t.addAPercent,[`${l.material}%`]:t.addBPercent,surface:t.surface}})),"biaxial-blend.csv"),style:j,children:"CSV"}),e.jsx("button",{onClick:()=>D(m.filter(t=>t.umf).map(t=>({label:`${s.material} ${t.addAPercent.toFixed(1)}% / ${l.material} ${t.addBPercent.toFixed(1)}%`,umf:t.umf}))),style:j,children:"Print Labels"})]})]}),e.jsxs("div",{style:{padding:16,overflowX:"auto"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx("div",{style:{display:"flex",gap:2,marginLeft:60},children:Array.from({length:i+1},(t,a)=>e.jsxs("div",{style:{width:48,textAlign:"center",fontSize:10,color:"var(--text-secondary)"},children:[(a/i*l.maxPercent).toFixed(1),"%"]},a))}),e.jsxs("div",{style:{textAlign:"center",fontSize:10,color:"var(--text-muted)",marginLeft:60,marginBottom:4},children:["→ ",l.material]}),Array.from({length:i+1},(t,a)=>e.jsxs("div",{style:{display:"flex",gap:2,alignItems:"center"},children:[e.jsxs("div",{style:{width:56,textAlign:"right",fontSize:10,color:"var(--text-secondary)",paddingRight:4},children:[(a/i*s.maxPercent).toFixed(1),"%"]}),Array.from({length:i+1},(r,d)=>{const n=m[a*(i+1)+d];return n?e.jsx("div",{title:`${s.material}: ${n.addAPercent.toFixed(1)}%
${l.material}: ${n.addBPercent.toFixed(1)}%
Surface: ${n.surface}`,style:{width:48,height:48,background:f[n.surface],borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,color:"var(--text-bright)",fontWeight:600,opacity:n.umf?1:.3,cursor:"default"},children:n.surface==="unknown"?"?":n.surface.charAt(0).toUpperCase()},d):null})]},a)),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",width:56,textAlign:"right",marginTop:4},children:["↓ ",s.material]})]}),e.jsx("div",{style:{display:"flex",gap:12,marginTop:16,flexWrap:"wrap"},children:Object.entries(f).filter(([t])=>t!=="unknown").map(([t,a])=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:11,color:"var(--text-secondary)"},children:[e.jsx("div",{style:{width:12,height:12,background:a,borderRadius:2}}),t]},t))})]})]}),e.jsxs("div",{className:"results-panel",children:[e.jsx("div",{className:"results-header",children:e.jsx("h3",{children:"UMF Data"})}),e.jsx("div",{className:"results-scroll",style:{maxHeight:400},children:e.jsxs("table",{className:"results-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s.material}),e.jsx("th",{children:l.material}),e.jsx("th",{children:"Surface"}),e.jsx("th",{children:"SiO₂"}),e.jsx("th",{children:"Al₂O₃"}),e.jsx("th",{children:"B₂O₃"}),e.jsx("th",{children:"CaO"}),e.jsx("th",{children:"Na₂O+K₂O"})]})}),e.jsx("tbody",{children:m.filter(t=>t.umf).map((t,a)=>e.jsxs("tr",{children:[e.jsxs("td",{children:[t.addAPercent.toFixed(1),"%"]}),e.jsxs("td",{children:[t.addBPercent.toFixed(1),"%"]}),e.jsx("td",{style:{color:f[t.surface]},children:t.surface}),e.jsx("td",{children:x(t.umf,"SiO2").toFixed(2)}),e.jsx("td",{children:x(t.umf,"Al2O3").toFixed(3)}),e.jsx("td",{children:x(t.umf,"B2O3").toFixed(3)}),e.jsx("td",{children:x(t.umf,"CaO").toFixed(3)}),e.jsx("td",{children:(x(t.umf,"Na2O")+x(t.umf,"K2O")).toFixed(3)})]},a))})]})})]})]}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"icon",children:"▦"}),e.jsx("p",{children:"Enter a base recipe + two additions"}),e.jsx("p",{style:{fontSize:12,color:"var(--text-dim)"},children:"For example: add silica and alumina independently to explore the Stull chart"})]})}),e.jsx("style",{children:T}),e.jsx("datalist",{id:"common-materials",children:A.getAllMaterials().map(t=>e.jsx("option",{value:t.primaryName},t.primaryName))})]})}const u={width:"100%",padding:"8px 10px",background:"var(--bg-input)",border:"1px solid var(--border-secondary)",borderRadius:6,color:"var(--text-bright)",fontSize:13,boxSizing:"border-box"};export{te as BiaxialBlendPage,te as default};
