import{r as n,j as e}from"./vendor-react-D0vdeqNS.js";import{R as N}from"./index-C6l8ZLGi.js";import{s as E,a as L}from"./simplex-I_iDn5AG.js";import{r as C}from"./umf-Bef8OHIG.js";import{u as k,m as O}from"./index-DFhyK2mv.js";import{a as x,f as a,b as w}from"./blend-xGiHwjeo.js";import{exportBlendCSV as z,printLabels as D}from"./export-BXZ-GFcd.js";import{u as T}from"./usePageTitle-Dfez-EUD.js";import{c as P}from"./calc-styles-u5C4IXOP.js";import{u as $}from"./vendor-router-DjLFn5nj.js";import"./vendor-state-DTYbmM1J.js";const y=["#e74c3c","#3498db"];function Q(){T("Line Blend");const[t,j]=n.useState([null,null]),[c,B]=n.useState(10),[r,u]=n.useState(null),[f,d]=n.useState([]),{setBlendResults:R,blendRecipes:p,clearBlendRecipes:S}=k(),M=$(),A=L(2,c);n.useEffect(()=>{p.length>=2&&(j(p.slice(0,2)),S())},[]);const v=n.useCallback((s,l)=>{j(o=>{const i=[...o];return i[s]=l,i}),u(null)},[]),m=n.useMemo(()=>t.every(s=>s&&s.ingredients.some(l=>l.material.trim()&&l.amount>0)),[t]),b=n.useCallback(()=>{if(!m)return;d([]);const[s,l]=t,o=C(s,O),i=C(l,O),g=[...o.errors,...i.errors];if(!o.value||!i.value){d(g.length>0?g:["Could not calculate UMF for one or both recipes"]);return}const h=E({recipes:[s,l],divisions:c},[o.value,i.value]);h.value?(u(h.value),d([...h.warnings])):d([...h.errors])},[t,c,m]);return e.jsxs("div",{className:"calc-page",children:[e.jsxs("div",{className:"calc-sidebar",onKeyDown:s=>{s.key==="Enter"&&!(s.target instanceof HTMLTextAreaElement)&&b()},children:[e.jsxs("div",{className:"calc-section",children:[e.jsx("h2",{children:"Line Blend"}),e.jsx("p",{className:"subtitle",children:"Two glazes, blended in equal steps from 100:0 to 0:100"})]}),e.jsxs("div",{className:"calc-section",children:[e.jsx("h3",{children:"Recipes"}),e.jsx(N,{label:"Glaze A",color:y[0],recipe:t[0],onChange:s=>v(0,s)}),e.jsx(N,{label:"Glaze B",color:y[1],recipe:t[1],onChange:s=>v(1,s)})]}),e.jsxs("div",{className:"calc-section",children:[e.jsx("h3",{children:"Divisions"}),e.jsx("div",{className:"calc-controls",children:e.jsxs("div",{className:"control-row",children:[e.jsx("input",{type:"range",min:"2",max:"20",value:c,onChange:s=>{B(Number(s.target.value)),u(null)}}),e.jsx("span",{className:"range-value",children:c})]})}),e.jsxs("div",{className:"point-count",children:[e.jsx("strong",{children:A})," blend points"]})]}),f.length>0&&e.jsx("div",{className:"calc-section",children:f.map((s,l)=>e.jsxs("p",{style:{color:"#e74c3c",fontSize:13,margin:"4px 0"},children:["⚠ ",s]},l))}),e.jsx("button",{className:"calc-button",onClick:b,disabled:!m,children:"Calculate Line Blend"})]}),e.jsx("div",{className:"calc-main",children:r?e.jsxs("div",{className:"results-panel",children:[e.jsxs("div",{className:"results-header",children:[e.jsxs("h3",{children:["Results — ",r.length," points"]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{onClick:()=>{R(r),M("/")},style:x,children:"View on Explorer"}),e.jsx("button",{onClick:()=>z(r.map((s,l)=>({label:`${Math.round(s.coordinates[0]*100)}:${Math.round(s.coordinates[1]*100)}`,umf:s.umf,meta:{"A%":Math.round(s.coordinates[0]*100),"B%":Math.round(s.coordinates[1]*100)}})),"line-blend.csv"),style:x,children:"CSV"}),e.jsx("button",{onClick:()=>D(r.map((s,l)=>({label:`${Math.round(s.coordinates[0]*100)}A : ${Math.round(s.coordinates[1]*100)}B`,umf:s.umf}))),style:x,children:"Print Labels"})]})]}),e.jsx("div",{className:"results-scroll",children:e.jsxs("table",{className:"results-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"A%"}),e.jsx("th",{children:"B%"}),e.jsx("th",{children:"SiO₂"}),e.jsx("th",{children:"Al₂O₃"}),e.jsx("th",{children:"B₂O₃"}),e.jsx("th",{children:"Na₂O"}),e.jsx("th",{children:"K₂O"}),e.jsx("th",{children:"CaO"}),e.jsx("th",{children:"MgO"}),e.jsx("th",{children:"ZnO"}),e.jsx("th",{children:"Si:Al"})]})}),e.jsx("tbody",{children:r.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:Math.round(s.coordinates[0]*100)}),e.jsx("td",{children:Math.round(s.coordinates[1]*100)}),e.jsx("td",{children:a(s.umf,"SiO2")}),e.jsx("td",{children:a(s.umf,"Al2O3")}),e.jsx("td",{children:a(s.umf,"B2O3")}),e.jsx("td",{children:a(s.umf,"Na2O")}),e.jsx("td",{children:a(s.umf,"K2O")}),e.jsx("td",{children:a(s.umf,"CaO")}),e.jsx("td",{children:a(s.umf,"MgO")}),e.jsx("td",{children:a(s.umf,"ZnO")}),e.jsx("td",{children:w(s.umf)})]},l))})]})})]}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"icon",children:"━━━"}),e.jsx("p",{children:"Enter two glaze recipes and hit calculate"}),e.jsx("p",{style:{fontSize:12,color:"var(--text-dim)"},children:"Materials are resolved against the Digitalfire database"})]})}),e.jsx("style",{children:P})]})}export{Q as LineBlendPage,Q as default};
