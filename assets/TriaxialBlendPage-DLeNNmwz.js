import{r as n,j as e}from"./vendor-react-D380Hx73.js";import{R as S}from"./index-KfmdK8FF.js";import{s as B,a as p}from"./simplex-qauDIMe5.js";import{r as E}from"./umf-WIqXF4ty.js";import{u as A,m as T}from"./index-Djbrw6no.js";import{a as f,f as t,b as k}from"./blend-xGiHwjeo.js";import{exportBlendCSV as $,printLabels as D}from"./export-DmptQqxz.js";import{u as L}from"./usePageTitle-DBGH44HI.js";import{c as w}from"./calc-styles-u5C4IXOP.js";import{u as P}from"./vendor-router-1trnvaIQ.js";import"./vendor-state-CUnBHQ16.js";const m=["#e74c3c","#2ecc71","#3498db"],K=["A","B","C"];function W(){L("Triaxial Blend");const[c,N]=n.useState([null,null,null]),[o,b]=n.useState(5),[a,x]=n.useState(null),[v,h]=n.useState([]),{setBlendResults:g}=A(),y=P(),M=p(3,o),O=n.useCallback((s,l)=>{N(i=>{const d=[...i];return d[s]=l,d}),x(null)},[]),j=n.useMemo(()=>c.every(s=>s&&s.ingredients.some(l=>l.material.trim()&&l.amount>0)),[c]),C=n.useCallback(()=>{if(!j)return;h([]);const s=c,l=s.map(r=>E(r,T)),i=l.flatMap(r=>r.errors),d=l.map(r=>r.value);if(d.some(r=>!r)){h(i.length>0?i:["Could not calculate UMF for one or more recipes"]);return}const R=d.filter(r=>r!==null),u=B({recipes:s,divisions:o},R);u.value?(x(u.value),h([...u.warnings])):h([...u.errors])},[c,o,j]);return e.jsxs("div",{className:"calc-page",children:[e.jsxs("div",{className:"calc-sidebar",onKeyDown:s=>{s.key==="Enter"&&!(s.target instanceof HTMLTextAreaElement)&&C()},children:[e.jsxs("div",{className:"calc-section",children:[e.jsx("h2",{children:"Triaxial Blend"}),e.jsx("p",{className:"subtitle",children:"Three corners on a simplex triangle — every combination that sums to 100%"})]}),e.jsxs("div",{className:"calc-section",children:[e.jsx("h3",{children:"Corner Recipes"}),K.map((s,l)=>e.jsx(S,{label:`Corner ${s}`,color:m[l],recipe:c[l],onChange:i=>O(l,i),compact:!0},s))]}),e.jsxs("div",{className:"calc-section",children:[e.jsx("h3",{children:"Divisions"}),e.jsx("div",{className:"calc-controls",children:e.jsxs("div",{className:"control-row",children:[e.jsx("input",{type:"range",min:"2",max:"15",value:o,onChange:s=>{b(Number(s.target.value)),x(null)}}),e.jsx("span",{className:"range-value",children:o})]})}),e.jsxs("div",{className:"point-count",children:[e.jsx("strong",{children:M})," blend points"]})]}),v.length>0&&e.jsx("div",{className:"calc-section",children:v.map((s,l)=>e.jsxs("p",{style:{color:"#e74c3c",fontSize:13,margin:"4px 0"},children:["⚠ ",s]},l))}),e.jsx("button",{className:"calc-button",onClick:C,disabled:!j,children:"Calculate Triaxial"})]}),e.jsx("div",{className:"calc-main",children:a?e.jsxs("div",{className:"results-panel",children:[e.jsxs("div",{className:"results-header",children:[e.jsxs("h3",{children:["Results — ",a.length," points"]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{onClick:()=>{g(a),y("/")},style:f,children:"View on Explorer"}),e.jsx("button",{onClick:()=>$(a.map(s=>({label:`${Math.round(s.coordinates[0]*100)}:${Math.round(s.coordinates[1]*100)}:${Math.round(s.coordinates[2]*100)}`,umf:s.umf,meta:{"A%":Math.round(s.coordinates[0]*100),"B%":Math.round(s.coordinates[1]*100),"C%":Math.round(s.coordinates[2]*100)}})),"triaxial-blend.csv"),style:f,children:"CSV"}),e.jsx("button",{onClick:()=>D(a.map(s=>({label:`${Math.round(s.coordinates[0]*100)}A:${Math.round(s.coordinates[1]*100)}B:${Math.round(s.coordinates[2]*100)}C`,umf:s.umf}))),style:f,children:"Print Labels"})]})]}),e.jsx("div",{className:"results-scroll",children:e.jsxs("table",{className:"results-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{style:{color:m[0]},children:"A%"}),e.jsx("th",{style:{color:m[1]},children:"B%"}),e.jsx("th",{style:{color:m[2]},children:"C%"}),e.jsx("th",{children:"SiO₂"}),e.jsx("th",{children:"Al₂O₃"}),e.jsx("th",{children:"B₂O₃"}),e.jsx("th",{children:"Na₂O"}),e.jsx("th",{children:"K₂O"}),e.jsx("th",{children:"CaO"}),e.jsx("th",{children:"MgO"}),e.jsx("th",{children:"Si:Al"})]})}),e.jsx("tbody",{children:a.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:Math.round(s.coordinates[0]*100)}),e.jsx("td",{children:Math.round(s.coordinates[1]*100)}),e.jsx("td",{children:Math.round(s.coordinates[2]*100)}),e.jsx("td",{children:t(s.umf,"SiO2")}),e.jsx("td",{children:t(s.umf,"Al2O3")}),e.jsx("td",{children:t(s.umf,"B2O3")}),e.jsx("td",{children:t(s.umf,"Na2O")}),e.jsx("td",{children:t(s.umf,"K2O")}),e.jsx("td",{children:t(s.umf,"CaO")}),e.jsx("td",{children:t(s.umf,"MgO")}),e.jsx("td",{children:k(s.umf)})]},l))})]})})]}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"icon",children:"△"}),e.jsx("p",{children:"Enter three corner recipes and hit calculate"}),e.jsxs("p",{style:{fontSize:12,color:"var(--text-dim)"},children:["Division of 5 → ",p(3,5)," points, 10 → ",p(3,10)," points"]})]})}),e.jsx("style",{children:w})]})}export{W as TriaxialBlendPage,W as default};
