import{r,j as e}from"./vendor-react-D380Hx73.js";import{R as B}from"./index-CKJkX_Fm.js";import{s as E,a as p}from"./simplex-fPJ5sx54.js";import{r as M}from"./umf-Bpe2KrgL.js";import{u as A,m as D}from"./index-Beyst0Xe.js";import{a as f,f as c,b as k}from"./blend-xGiHwjeo.js";import{exportBlendCSV as L,printLabels as $}from"./export-CUxvy3P4.js";import{u as w}from"./usePageTitle-DBGH44HI.js";import{c as P}from"./calc-styles-u5C4IXOP.js";import{u as Q}from"./vendor-router-1trnvaIQ.js";import"./vendor-state-CUnBHQ16.js";const h=["#e74c3c","#2ecc71","#3498db","#f39c12"],T=["A","B","C","D"];function W(){w("Quadaxial Blend");const[i,b]=r.useState([null,null,null,null]),[o,y]=r.useState(4),[a,x]=r.useState(null),[v,u]=r.useState([]),{setBlendResults:g}=A(),O=Q(),C=p(4,o),R=r.useCallback((s,l)=>{b(t=>{const d=[...t];return d[s]=l,d}),x(null)},[]),j=r.useMemo(()=>i.every(s=>s&&s.ingredients.some(l=>l.material.trim()&&l.amount>0)),[i]),N=r.useCallback(()=>{if(!j)return;u([]);const s=i,l=s.map(n=>M(n,D)),t=l.flatMap(n=>n.errors),d=l.map(n=>n.value);if(d.some(n=>!n)){u(t.length>0?t:["Could not calculate UMF for one or more recipes"]);return}const S=d.filter(n=>n!==null),m=E({recipes:s,divisions:o},S);m.value?(x(m.value),u([...m.warnings])):u([...m.errors])},[i,o,j]);return e.jsxs("div",{className:"calc-page",children:[e.jsxs("div",{className:"calc-sidebar",onKeyDown:s=>{s.key==="Enter"&&!(s.target instanceof HTMLTextAreaElement)&&N()},children:[e.jsxs("div",{className:"calc-section",children:[e.jsx("h2",{children:"Quadaxial Blend"}),e.jsx("p",{className:"subtitle",children:"Four corners on a simplex tetrahedron — systematic four-component exploration"})]}),e.jsxs("div",{className:"calc-section",children:[e.jsx("h3",{children:"Corner Recipes"}),T.map((s,l)=>e.jsx(B,{label:`Corner ${s}`,color:h[l],recipe:i[l],onChange:t=>R(l,t),compact:!0},s))]}),e.jsxs("div",{className:"calc-section",children:[e.jsx("h3",{children:"Divisions"}),e.jsx("div",{className:"calc-controls",children:e.jsxs("div",{className:"control-row",children:[e.jsx("input",{type:"range",min:"2",max:"10",value:o,onChange:s=>{y(Number(s.target.value)),x(null)}}),e.jsx("span",{className:"range-value",children:o})]})}),e.jsxs("div",{className:"point-count",children:[e.jsx("strong",{children:C})," blend points",C>200&&e.jsx("span",{style:{color:"#e67e22",marginLeft:8},children:"(that's a lot of test tiles)"})]})]}),v.length>0&&e.jsx("div",{className:"calc-section",children:v.map((s,l)=>e.jsxs("p",{style:{color:"#e74c3c",fontSize:13,margin:"4px 0"},children:["⚠ ",s]},l))}),e.jsx("button",{className:"calc-button",onClick:N,disabled:!j,children:"Calculate Quadaxial"})]}),e.jsx("div",{className:"calc-main",children:a?e.jsxs("div",{className:"results-panel",children:[e.jsxs("div",{className:"results-header",children:[e.jsxs("h3",{children:["Results — ",a.length," points"]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{onClick:()=>{g(a),O("/")},style:f,children:"View on Explorer"}),e.jsx("button",{onClick:()=>L(a.map(s=>({label:s.coordinates.map((l,t)=>`${Math.round(l*100)}${["A","B","C","D"][t]}`).join(":"),umf:s.umf,meta:Object.fromEntries(s.coordinates.map((l,t)=>[`${["A","B","C","D"][t]}%`,Math.round(l*100)]))})),"quadaxial-blend.csv"),style:f,children:"CSV"}),e.jsx("button",{onClick:()=>$(a.map(s=>({label:s.coordinates.map((l,t)=>`${Math.round(l*100)}${["A","B","C","D"][t]}`).join(":"),umf:s.umf}))),style:f,children:"Print Labels"})]})]}),e.jsx("div",{className:"results-scroll",children:e.jsxs("table",{className:"results-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{style:{color:h[0]},children:"A%"}),e.jsx("th",{style:{color:h[1]},children:"B%"}),e.jsx("th",{style:{color:h[2]},children:"C%"}),e.jsx("th",{style:{color:h[3]},children:"D%"}),e.jsx("th",{children:"SiO₂"}),e.jsx("th",{children:"Al₂O₃"}),e.jsx("th",{children:"B₂O₃"}),e.jsx("th",{children:"Na₂O"}),e.jsx("th",{children:"K₂O"}),e.jsx("th",{children:"CaO"}),e.jsx("th",{children:"Si:Al"})]})}),e.jsx("tbody",{children:a.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:Math.round(s.coordinates[0]*100)}),e.jsx("td",{children:Math.round(s.coordinates[1]*100)}),e.jsx("td",{children:Math.round(s.coordinates[2]*100)}),e.jsx("td",{children:Math.round(s.coordinates[3]*100)}),e.jsx("td",{children:c(s.umf,"SiO2")}),e.jsx("td",{children:c(s.umf,"Al2O3")}),e.jsx("td",{children:c(s.umf,"B2O3")}),e.jsx("td",{children:c(s.umf,"Na2O")}),e.jsx("td",{children:c(s.umf,"K2O")}),e.jsx("td",{children:c(s.umf,"CaO")}),e.jsx("td",{children:k(s.umf)})]},l))})]})})]}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"icon",children:"◇"}),e.jsx("p",{children:"Enter four corner recipes and hit calculate"}),e.jsxs("p",{style:{fontSize:12,color:"var(--text-dim)"},children:["Division of 4 → ",p(4,4)," points,"," ","6 → ",p(4,6)," points"]})]})}),e.jsx("style",{children:P})]})}export{W as QuadaxialBlendPage,W as default};
