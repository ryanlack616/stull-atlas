import{o as p,t as x,g,m as d,a as y}from"./data-digitalfire-CCT-bSzB.js";import{D as O}from"./data-digitalfire-CCT-bSzB.js";let i=null,a=null;function h(){if(!i){i=new Map;for(const t of p){i.set(t.formula.toLowerCase(),t);const l=t.title.toLowerCase();if(l.includes("(")){const r=l.match(/\(([^)]+)\)/g);r==null||r.forEach(o=>{const s=o.replace(/[()]/g,"").trim();i.set(s.toLowerCase(),t)})}}}return i}function L(){if(!a){a=new Map;for(const t of d)if(t.name&&(a.set(t.name.toLowerCase(),t),t.altNames))for(const l of t.altNames.split(","))a.set(l.trim().toLowerCase(),t)}return a}function C(t){const r=h().get(t.toLowerCase());return r?{title:r.title,excerpt:r.excerpt,url:r.url,category:"oxide"}:null}function R(t){const l=L(),r=l.get(t.toLowerCase());if(r)return{title:r.name,excerpt:r.excerpt,url:r.url,category:"material"};const o=t.toLowerCase();for(const[s,e]of l)if(s.startsWith(o)||o.startsWith(s))return{title:e.name,excerpt:e.excerpt,url:e.url,category:"material"};return null}function m(t,l=8){const r=t.toLowerCase().trim();if(!r)return[];const o=[],s=r.split(/\s+/);for(const e of g){const c=u(r,s,e.term,e.keywords,e.excerpt);c>0&&o.push({title:e.term,excerpt:e.excerpt,url:e.url,category:"glossary",score:c+10})}for(const e of x){const c=u(r,s,e.term,"",e.excerpt);c>0&&o.push({title:e.term,excerpt:e.excerpt,url:e.url,category:"trouble",score:c+8})}for(const e of p){const c=u(r,s,e.formula,e.title,e.excerpt);c>0&&o.push({title:e.title,excerpt:e.excerpt,url:e.url,category:"oxide",score:c+6})}for(const e of d){const c=u(r,s,e.name,e.altNames,e.excerpt);c>0&&o.push({title:e.name,excerpt:e.excerpt,url:e.url,category:"material",score:c+4})}for(const e of y){const c=u(r,s,e.title,"",e.excerpt);c>0&&o.push({title:e.title,excerpt:e.excerpt,url:e.url,category:"article",score:c+2})}return o.sort((e,c)=>c.score-e.score),o.slice(0,l).map(({score:e,...c})=>c)}function I(t){const l=[],r=new Set,o=s=>{s&&!r.has(s.url)&&(r.add(s.url),l.push(s))};if(t.glazeFamily&&m(t.glazeFamily,2).forEach(o),t.surfaceType&&t.surfaceType!=="unknown"&&m(t.surfaceType+" glaze",1).forEach(o),t.oxideSymbols){const s=t.oxideSymbols.filter(e=>!["SiO2","Al2O3"].includes(e));for(const e of s.slice(0,3))o(C(e))}if(t.materialNames)for(const s of t.materialNames.slice(0,3))o(R(s));return t.atmosphere&&t.atmosphere!=="unknown"&&m(t.atmosphere+" firing",1).forEach(o),l.slice(0,8)}function T(t){const l=t.toLowerCase();for(const o of x)if(o.term.toLowerCase().includes(l)||l.includes(o.term.toLowerCase()))return{title:o.term,excerpt:o.excerpt,url:o.url,category:"trouble"};return m(t,1)[0]||null}function b(){const t=new Map;for(const l of p)t.set(l.formula,l.url);return t}function u(t,l,r,o,s){const e=(r??"").toLowerCase(),c=(o??"").toLowerCase(),w=(s??"").toLowerCase();let n=0;e===t?n+=100:e.includes(t)?n+=50:t.includes(e)&&e.length>3?n+=30:c.includes(t)&&(n+=25);for(const f of l)f.length<2||(e.includes(f)&&(n+=15),c.includes(f)&&(n+=10),w.includes(f)&&(n+=3));return n}export{O as DIGITALFIRE_ATTRIBUTION,I as getContextualRefs,b as getOxideLinks,T as getTroubleRef,R as lookupMaterial,C as lookupOxide,m as searchKnowledge};
