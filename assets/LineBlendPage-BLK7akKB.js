import{r as a,j as e}from"./vendor-react-D380Hx73.js";import{R as b}from"./index-wg4Rv0n1.js";import{s as R,a as A}from"./simplex-Bpoj0AZT.js";import{r as g}from"./umf-Bx7e6FOm.js";import{u as E,m as N}from"./index-DUKXpxkf.js";import{a as x,f as n,b as L}from"./blend-xGiHwjeo.js";import{exportBlendCSV as k,printLabels as w}from"./export-BPAFPFXr.js";import{u as z}from"./usePageTitle-DBGH44HI.js";import{c as D}from"./calc-styles-u5C4IXOP.js";import{u as T}from"./vendor-router-1trnvaIQ.js";import"./vendor-state-CUnBHQ16.js";const C=["#e74c3c","#3498db"];function _(){z("Line Blend");const[r,O]=a.useState([null,null]),[c,y]=a.useState(10),[t,u]=a.useState(null),[j,d]=a.useState([]),{setBlendResults:S}=E(),B=T(),M=A(2,c),f=a.useCallback((s,l)=>{O(o=>{const i=[...o];return i[s]=l,i}),u(null)},[]),m=a.useMemo(()=>r.every(s=>s&&s.ingredients.some(l=>l.material.trim()&&l.amount>0)),[r]),p=a.useCallback(()=>{if(!m)return;d([]);const[s,l]=r,o=g(s,N),i=g(l,N),v=[...o.errors,...i.errors];if(!o.value||!i.value){d(v.length>0?v:["Could not calculate UMF for one or both recipes"]);return}const h=R({recipes:[s,l],divisions:c},[o.value,i.value]);h.value?(u(h.value),d([...h.warnings])):d([...h.errors])},[r,c,m]);return e.jsxs("div",{className:"calc-page",children:[e.jsxs("div",{className:"calc-sidebar",onKeyDown:s=>{s.key==="Enter"&&!(s.target instanceof HTMLTextAreaElement)&&p()},children:[e.jsxs("div",{className:"calc-section",children:[e.jsx("h2",{children:"Line Blend"}),e.jsx("p",{className:"subtitle",children:"Two glazes, blended in equal steps from 100:0 to 0:100"})]}),e.jsxs("div",{className:"calc-section",children:[e.jsx("h3",{children:"Recipes"}),e.jsx(b,{label:"Glaze A",color:C[0],recipe:r[0],onChange:s=>f(0,s)}),e.jsx(b,{label:"Glaze B",color:C[1],recipe:r[1],onChange:s=>f(1,s)})]}),e.jsxs("div",{className:"calc-section",children:[e.jsx("h3",{children:"Divisions"}),e.jsx("div",{className:"calc-controls",children:e.jsxs("div",{className:"control-row",children:[e.jsx("input",{type:"range",min:"2",max:"20",value:c,onChange:s=>{y(Number(s.target.value)),u(null)}}),e.jsx("span",{className:"range-value",children:c})]})}),e.jsxs("div",{className:"point-count",children:[e.jsx("strong",{children:M})," blend points"]})]}),j.length>0&&e.jsx("div",{className:"calc-section",children:j.map((s,l)=>e.jsxs("p",{style:{color:"#e74c3c",fontSize:13,margin:"4px 0"},children:["⚠ ",s]},l))}),e.jsx("button",{className:"calc-button",onClick:p,disabled:!m,children:"Calculate Line Blend"})]}),e.jsx("div",{className:"calc-main",children:t?e.jsxs("div",{className:"results-panel",children:[e.jsxs("div",{className:"results-header",children:[e.jsxs("h3",{children:["Results — ",t.length," points"]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{onClick:()=>{S(t),B("/")},style:x,children:"View on Explorer"}),e.jsx("button",{onClick:()=>k(t.map((s,l)=>({label:`${Math.round(s.coordinates[0]*100)}:${Math.round(s.coordinates[1]*100)}`,umf:s.umf,meta:{"A%":Math.round(s.coordinates[0]*100),"B%":Math.round(s.coordinates[1]*100)}})),"line-blend.csv"),style:x,children:"CSV"}),e.jsx("button",{onClick:()=>w(t.map((s,l)=>({label:`${Math.round(s.coordinates[0]*100)}A : ${Math.round(s.coordinates[1]*100)}B`,umf:s.umf}))),style:x,children:"Print Labels"})]})]}),e.jsx("div",{className:"results-scroll",children:e.jsxs("table",{className:"results-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"A%"}),e.jsx("th",{children:"B%"}),e.jsx("th",{children:"SiO₂"}),e.jsx("th",{children:"Al₂O₃"}),e.jsx("th",{children:"B₂O₃"}),e.jsx("th",{children:"Na₂O"}),e.jsx("th",{children:"K₂O"}),e.jsx("th",{children:"CaO"}),e.jsx("th",{children:"MgO"}),e.jsx("th",{children:"ZnO"}),e.jsx("th",{children:"Si:Al"})]})}),e.jsx("tbody",{children:t.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:Math.round(s.coordinates[0]*100)}),e.jsx("td",{children:Math.round(s.coordinates[1]*100)}),e.jsx("td",{children:n(s.umf,"SiO2")}),e.jsx("td",{children:n(s.umf,"Al2O3")}),e.jsx("td",{children:n(s.umf,"B2O3")}),e.jsx("td",{children:n(s.umf,"Na2O")}),e.jsx("td",{children:n(s.umf,"K2O")}),e.jsx("td",{children:n(s.umf,"CaO")}),e.jsx("td",{children:n(s.umf,"MgO")}),e.jsx("td",{children:n(s.umf,"ZnO")}),e.jsx("td",{children:L(s.umf)})]},l))})]})})]}):e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"icon",children:"━━━"}),e.jsx("p",{children:"Enter two glaze recipes and hit calculate"}),e.jsx("p",{style:{fontSize:12,color:"var(--text-dim)"},children:"Materials are resolved against the Digitalfire database"})]})}),e.jsx("style",{children:D})]})}export{_ as LineBlendPage,_ as default};
