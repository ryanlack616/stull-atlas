import{s as rm,l as wr,r as vn,g as tm,a as Ls,e as nm,b as Rs,c as Bd,f as am,d as Ms,h as Is,i as im,j as Ns,k as eo,m as om,x as lm,p as Dd,n as fm,o as sm,t as um,q as cm,u as kd,v as zd,w as Pd,y as Gd,z as vm,A as Ud,B as hm,C as Xa,D as $d,E as Ya,F as dm,G as Ln,H as pm,I as ym,J as Za,K as Bs,L as mm,M as ro,N as gm,O as xm,P as jd,Q as bm,R as _m,S as Am,T as Vd,U as wm,V as Tm,W as hn,X as Em,Y as Sm,Z as Cm,_ as Rn,$ as Fm,a0 as Ja,a1 as Om,a2 as qd,a3 as Lm,a4 as Rm,a5 as Mm,a6 as Im}from"./find_empties-DRiZhjAu.js";import{g as Ds,a as Hd,b as un}from"./vendor-react-D0vdeqNS.js";var Nm=rm;const Bm=Ds(Nm);var Dm=vn,dt=wr,km=tm;function zm(r,e,t,n){var i=r.cd,a=i[0].t,o=i[0].trace,f=r.xa,l=r.ya,s=a.x,u=a.y,v=f.c2p(e),d=l.c2p(t),c=r.distance,p;if(a.tree){var O=f.p2c(v-c),g=f.p2c(v+c),y=l.p2c(d-c),R=l.p2c(d+c);n==="x"?p=a.tree.range(Math.min(O,g),Math.min(l._rl[0],l._rl[1]),Math.max(O,g),Math.max(l._rl[0],l._rl[1])):p=a.tree.range(Math.min(O,g),Math.min(y,R),Math.max(O,g),Math.max(y,R))}else p=a.ids;var T,M,B,V,I,F,j,z,q,C=c;if(n==="x"){var G=!!o.xperiodalignment,Q=!!o.yperiodalignment;for(I=0;I<p.length;I++){if(T=p[I],B=s[T],F=Math.abs(f.c2p(B)-v),G){var fe=f.c2p(o._xStarts[T]),ue=f.c2p(o._xEnds[T]);F=v>=Math.min(fe,ue)&&v<=Math.max(fe,ue)?0:1/0}if(F<C){if(C=F,V=u[T],j=l.c2p(V)-d,Q){var K=l.c2p(o._yStarts[T]),se=l.c2p(o._yEnds[T]);j=d>=Math.min(K,se)&&d<=Math.max(K,se)?0:1/0}q=Math.sqrt(F*F+j*j),M=p[I]}}}else for(I=p.length-1;I>-1;I--)T=p[I],B=s[T],V=u[T],F=f.c2p(B)-v,j=l.c2p(V)-d,z=Math.sqrt(F*F+j*j),z<C&&(C=q=z,M=T);return r.index=M,r.distance=C,r.dxy=q,M===void 0?[r]:[Pm(r,s,u,o)]}function Pm(r,e,t,n){var i=r.xa,a=r.ya,o=r.distance,f=r.dxy,l=r.index,s={pointNumber:l,x:e[l],y:t[l]};s.tx=dt.isArrayOrTypedArray(n.text)?n.text[l]:n.text,s.htx=Array.isArray(n.hovertext)?n.hovertext[l]:n.hovertext,s.data=Array.isArray(n.customdata)?n.customdata[l]:n.customdata,s.tp=Array.isArray(n.textposition)?n.textposition[l]:n.textposition;var u=n.textfont;u&&(s.ts=dt.isArrayOrTypedArray(u.size)?u.size[l]:u.size,s.tc=dt.isArrayOrTypedArray(u.color)?u.color[l]:u.color,s.tf=Array.isArray(u.family)?u.family[l]:u.family,s.tw=Array.isArray(u.weight)?u.weight[l]:u.weight,s.ty=Array.isArray(u.style)?u.style[l]:u.style,s.tv=Array.isArray(u.variant)?u.variant[l]:u.variant);var v=n.marker;v&&(s.ms=dt.isArrayOrTypedArray(v.size)?v.size[l]:v.size,s.mo=dt.isArrayOrTypedArray(v.opacity)?v.opacity[l]:v.opacity,s.mx=dt.isArrayOrTypedArray(v.symbol)?v.symbol[l]:v.symbol,s.ma=dt.isArrayOrTypedArray(v.angle)?v.angle[l]:v.angle,s.mc=dt.isArrayOrTypedArray(v.color)?v.color[l]:v.color);var d=v&&v.line;d&&(s.mlc=Array.isArray(d.color)?d.color[l]:d.color,s.mlw=dt.isArrayOrTypedArray(d.width)?d.width[l]:d.width);var c=v&&v.gradient;c&&c.type!=="none"&&(s.mgt=Array.isArray(c.type)?c.type[l]:c.type,s.mgc=Array.isArray(c.color)?c.color[l]:c.color);var p=i.c2p(s.x,!0),O=a.c2p(s.y,!0),g=s.mrc||1,y=n.hoverlabel;y&&(s.hbg=Array.isArray(y.bgcolor)?y.bgcolor[l]:y.bgcolor,s.hbc=Array.isArray(y.bordercolor)?y.bordercolor[l]:y.bordercolor,s.hts=dt.isArrayOrTypedArray(y.font.size)?y.font.size[l]:y.font.size,s.htc=Array.isArray(y.font.color)?y.font.color[l]:y.font.color,s.htf=Array.isArray(y.font.family)?y.font.family[l]:y.font.family,s.hnl=dt.isArrayOrTypedArray(y.namelength)?y.namelength[l]:y.namelength);var R=n.hoverinfo;R&&(s.hi=Array.isArray(R)?R[l]:R);var T=n.hovertemplate;T&&(s.ht=Array.isArray(T)?T[l]:T);var M={};M[r.index]=s;var B=n._origX,V=n._origY,I=dt.extendFlat({},r,{color:km(n,s),x0:p-g,x1:p+g,xLabelVal:B?B[l]:s.x,y0:O-g,y1:O+g,yLabelVal:V?V[l]:s.y,cd:M,distance:o,spikeDistance:f,hovertemplate:s.ht});return s.htx?I.text=s.htx:s.tx?I.text=s.tx:n.text&&(I.text=n.text),dt.fillText(s,n,I),Dm.getComponentMethod("errorbars","hoverInfo")(s,n,I),I}var Gm={hoverPoints:zm},Wd={exports:{}},Sc=20,to={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:Sc,SYMBOL_STROKE:Sc/20,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}},Um=Bd,$m=Ns,jm=am,Tr=Rs,Cc=Ls.axisHoverFormat,Fc=Is,Vm=im,Ll=Ms.extendFlat,qm=nm.overrideAll,Hm=to.DASHES,Oc=Tr.line,Zt=Tr.marker,Wm=Zt.line,va=Wd.exports=qm({x:Tr.x,x0:Tr.x0,dx:Tr.dx,y:Tr.y,y0:Tr.y0,dy:Tr.dy,xperiod:Tr.xperiod,yperiod:Tr.yperiod,xperiod0:Tr.xperiod0,yperiod0:Tr.yperiod0,xperiodalignment:Tr.xperiodalignment,yperiodalignment:Tr.yperiodalignment,xhoverformat:Cc("x"),yhoverformat:Cc("y"),text:Tr.text,hovertext:Tr.hovertext,textposition:Tr.textposition,textfont:$m({noFontShadow:!0,noFontLineposition:!0,noFontTextcase:!0,editType:"calc",colorEditType:"style",arrayOk:!0,noNumericWeightValues:!0,variantValues:["normal","small-caps"],description:"Sets the text font."}),mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],description:["Determines the drawing mode for this scatter trace."].join(" ")},line:{color:Oc.color,width:Oc.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot",description:["Determines the line shape.","The values correspond to step-wise line shapes."].join(" ")},dash:{valType:"enumerated",values:Vm(Hm),dflt:"solid",description:"Sets the style of the lines."}},marker:Ll({},Fc("marker"),{symbol:Zt.symbol,angle:Zt.angle,size:Zt.size,sizeref:Zt.sizeref,sizemin:Zt.sizemin,sizemode:Zt.sizemode,opacity:Zt.opacity,colorbar:Zt.colorbar,line:Ll({},Fc("marker.line"),{width:Wm.width})}),connectgaps:Tr.connectgaps,fill:Ll({},Tr.fill,{dflt:"none"}),fillcolor:jm(),selected:{marker:Tr.selected.marker,textfont:Tr.selected.textfont},unselected:{marker:Tr.unselected.marker,textfont:Tr.unselected.textfont},opacity:Um.opacity},"calc","nested");va.x.editType=va.y.editType=va.x0.editType=va.y0.editType="calc+clearAxisTypes";va.hovertemplate=Tr.hovertemplate;va.texttemplate=Tr.texttemplate;var Xd=Wd.exports,no={},Yd=to;no.isOpenSymbol=function(r){return typeof r=="string"?Yd.OPEN_RE.test(r):r%200>100};no.isDotSymbol=function(r){return typeof r=="string"?Yd.DOT_RE.test(r):r>200};var Lc=wr,Xm=vn,Ym=no,Zm=Xd,Jm=om,Si=eo,Qm=lm,Km=Dd,eg=fm,rg=sm,tg=cm,ng=um,ag=function(e,t,n,i){function a(c,p){return Lc.coerce(e,t,Zm,c,p)}var o=e.marker?Ym.isOpenSymbol(e.marker.symbol):!1,f=Si.isBubble(e),l=Qm(e,t,i,a);if(!l){t.visible=!1;return}Km(e,t,i,a),a("xhoverformat"),a("yhoverformat");var s=l<Jm.PTS_LINESONLY?"lines+markers":"lines";a("text"),a("hovertext"),a("hovertemplate"),a("mode",s),Si.hasMarkers(t)&&(eg(e,t,n,i,a,{noAngleRef:!0,noStandOff:!0}),a("marker.line.width",o||f?1:0)),Si.hasLines(t)&&(a("connectgaps"),rg(e,t,n,i,a),a("line.shape")),Si.hasText(t)&&(a("texttemplate"),ng(e,t,i,a,{noFontShadow:!0,noFontLineposition:!0,noFontTextcase:!0}));var u=(t.line||{}).color,v=(t.marker||{}).color;a("fill"),t.fill!=="none"&&tg(e,t,n,a);var d=Xm.getComponentMethod("errorbars","supplyDefaults");d(e,t,u||v||n,{axis:"y"}),d(e,t,u||v||n,{axis:"x",inherit:"y"}),Lc.coerceSelectionMarkerOpacity(t,a)},ig=kd,og=function(e,t,n){var i=e.i;return"x"in e||(e.x=t._x[i]),"y"in e||(e.y=t._y[i]),ig(e,t,n)};function lg(r,e,t,n,i){for(var a=i+1;n<=i;){var o=n+i>>>1,f=r[o],l=t!==void 0?t(f,e):f-e;l>=0?(a=o,i=o-1):n=o+1}return a}function fg(r,e,t,n,i){for(var a=i+1;n<=i;){var o=n+i>>>1,f=r[o],l=t!==void 0?t(f,e):f-e;l>0?(a=o,i=o-1):n=o+1}return a}function sg(r,e,t,n,i){for(var a=n-1;n<=i;){var o=n+i>>>1,f=r[o],l=t!==void 0?t(f,e):f-e;l<0?(a=o,n=o+1):i=o-1}return a}function ug(r,e,t,n,i){for(var a=n-1;n<=i;){var o=n+i>>>1,f=r[o],l=t!==void 0?t(f,e):f-e;l<=0?(a=o,n=o+1):i=o-1}return a}function cg(r,e,t,n,i){for(;n<=i;){var a=n+i>>>1,o=r[a],f=t!==void 0?t(o,e):o-e;if(f===0)return a;f<=0?n=a+1:i=a-1}return-1}function Ba(r,e,t,n,i,a){return typeof t=="function"?a(r,e,t,n===void 0?0:n|0,i===void 0?r.length-1:i|0):a(r,e,void 0,t===void 0?0:t|0,n===void 0?r.length-1:n|0)}var vg={ge:function(r,e,t,n,i){return Ba(r,e,t,n,i,lg)},gt:function(r,e,t,n,i){return Ba(r,e,t,n,i,fg)},lt:function(r,e,t,n,i){return Ba(r,e,t,n,i,sg)},le:function(r,e,t,n,i){return Ba(r,e,t,n,i,ug)},eq:function(r,e,t,n,i){return Ba(r,e,t,n,i,cg)}},dn=function(e,t,n){var i={},a,o;if(typeof t=="string"&&(t=Rc(t)),Array.isArray(t)){var f={};for(o=0;o<t.length;o++)f[t[o]]=!0;t=f}for(a in t)t[a]=Rc(t[a]);var l={};for(a in t){var s=t[a];if(Array.isArray(s))for(o=0;o<s.length;o++){var u=s[o];if(n&&(l[u]=!0),u in e){if(i[a]=e[u],n)for(var v=o;v<s.length;v++)l[s[v]]=!0;break}}else a in e&&(t[a]&&(i[a]=e[a]),n&&(l[a]=!0))}if(n)for(a in e)l[a]||(i[a]=e[a]);return i},Rl={};function Rc(r){return Rl[r]?Rl[r]:(typeof r=="string"&&(r=Rl[r]=r.split(/\s*,\s*|\s+/)),r)}var hg=dn,ao=dg;function dg(r){var e;return arguments.length>1&&(r=arguments),typeof r=="string"?r=r.split(/\s/).map(parseFloat):typeof r=="number"&&(r=[r]),r.length&&typeof r[0]=="number"?r.length===1?e={width:r[0],height:r[0],x:0,y:0}:r.length===2?e={width:r[0],height:r[1],x:0,y:0}:e={x:r[0],y:r[1],width:r[2]-r[0]||0,height:r[3]-r[1]||0}:r&&(r=hg(r,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),e={x:r.left||0,y:r.top||0},r.width==null?r.right?e.width=r.right-e.x:e.width=0:e.width=r.width,r.height==null?r.bottom?e.height=r.bottom-e.y:e.height=0:e.height=r.height),e}var Qa=pg;function pg(r,e){if(!r||r.length==null)throw Error("Argument should be an array");e==null?e=1:e=Math.floor(e);for(var t=Array(e*2),n=0;n<e;n++){for(var i=-1/0,a=1/0,o=n,f=r.length;o<f;o+=e)r[o]>i&&(i=r[o]),r[o]<a&&(a=r[o]);t[n]=a,t[e+n]=i}return t}var yg=function(){for(var e=0;e<arguments.length;e++)if(typeof arguments[e]<"u")return arguments[e]},Mc=zd,Ka=mg;function mg(r,e,t){if(!r)throw new TypeError("must specify data as first parameter");if(t=+(t||0)|0,Array.isArray(r)&&r[0]&&typeof r[0][0]=="number"){var n=r[0].length,i=r.length*n,a,o,f,l;(!e||typeof e=="string")&&(e=new(Mc(e||"float32"))(i+t));var s=e.length-t;if(i!==s)throw new Error("source length "+i+" ("+n+"x"+r.length+") does not match destination length "+s);for(a=0,f=t;a<r.length;a++)for(o=0;o<n;o++)e[f++]=r[a][o]===null?NaN:r[a][o]}else if(!e||typeof e=="string"){var u=Mc(e||"float32");if(Array.isArray(r)||e==="array")for(e=new u(r.length+t),a=0,f=t,l=e.length;f<l;f++,a++)e[f]=r[a]===null?NaN:r[a];else t===0?e=new u(r):(e=new u(r.length+t),e.set(r,t))}else e.set(r,t);return e}var gg=function(r){var e=typeof r;return r!==null&&(e==="object"||e==="function")},xg=Math.log2||function(r){return Math.log(r)*Math.LOG2E};const Ic=vg,Nc=Pd,bg=ao,_g=Qa,Bc=dn,Ml=yg,Ag=Ka,wg=gg,Tg=zd,Dc=xg,Eg=1073741824;var Sg=function(e,t){t||(t={}),e=Ag(e,"float64"),t=Bc(t,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});let n=Ml(t.maxDepth,255),i=Ml(t.bounds,_g(e,2));i[0]===i[2]&&i[2]++,i[1]===i[3]&&i[3]++;let a=kc(e,i),o=e.length>>>1,f;t.dtype||(t.dtype="array"),typeof t.dtype=="string"?f=new(Tg(t.dtype))(o):t.dtype&&(f=t.dtype,Array.isArray(f)&&(f.length=o));for(let y=0;y<o;++y)f[y]=y;let l=[],s=[],u=[],v=[];c(0,0,1,f,0,1);let d=0;for(let y=0;y<l.length;y++){let R=l[y];if(f.set)f.set(R,d);else for(let M=0,B=R.length;M<B;M++)f[M+d]=R[M];let T=d+l[y].length;v[y]=[d,T],d=T}return f.range=p,f;function c(y,R,T,M,B,V){if(!M.length)return null;let I=l[B]||(l[B]=[]),F=u[B]||(u[B]=[]),j=s[B]||(s[B]=[]),z=I.length;if(B++,B>n||V>Eg){for(let se=0;se<M.length;se++)I.push(M[se]),F.push(V),j.push(null,null,null,null);return z}if(I.push(M[0]),F.push(V),M.length<=1)return j.push(null,null,null,null),z;let q=T*.5,C=y+q,G=R+q,Q=[],fe=[],ue=[],K=[];for(let se=1,Te=M.length;se<Te;se++){let ye=M[se],Fe=a[ye*2],Qe=a[ye*2+1];Fe<C?Qe<G?Q.push(ye):fe.push(ye):Qe<G?ue.push(ye):K.push(ye)}return V<<=2,j.push(c(y,R,q,Q,B,V),c(y,G,q,fe,B,V+1),c(C,R,q,ue,B,V+2),c(C,G,q,K,B,V+3)),z}function p(...y){let R;if(wg(y[y.length-1])){let ue=y.pop();!y.length&&(ue.x!=null||ue.l!=null||ue.left!=null)&&(y=[ue],R={}),R=Bc(ue,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else R={};y.length||(y=i);let T=bg(...y),[M,B,V,I]=[Math.min(T.x,T.x+T.width),Math.min(T.y,T.y+T.height),Math.max(T.x,T.x+T.width),Math.max(T.y,T.y+T.height)],[F,j,z,q]=kc([M,B,V,I],i),C=Ml(R.level,l.length);if(R.d!=null){let ue;typeof R.d=="number"?ue=[R.d,R.d]:R.d.length&&(ue=R.d),C=Math.min(Math.max(Math.ceil(-Dc(Math.abs(ue[0])/(i[2]-i[0]))),Math.ceil(-Dc(Math.abs(ue[1])/(i[3]-i[1])))),C)}if(C=Math.min(C,l.length),R.lod)return O(F,j,z,q,C);let G=[];Q(0,0,1,0,0,1);function Q(ue,K,se,Te,ye,Fe){if(ye===null||Fe===null)return;let Qe=ue+se,qe=K+se;if(F>Qe||j>qe||z<ue||q<K||Te>=C||ye===Fe)return;let pe=l[Te];Fe===void 0&&(Fe=pe.length);for(let Rr=ye;Rr<Fe;Rr++){let Sr=pe[Rr],Nr=e[Sr*2],pr=e[Sr*2+1];Nr>=M&&Nr<=V&&pr>=B&&pr<=I&&G.push(Sr)}let Se=s[Te],xe=Se[ye*4+0],je=Se[ye*4+1],tr=Se[ye*4+2],He=Se[ye*4+3],Je=fe(Se,ye+1),or=se*.5,ir=Te+1;Q(ue,K,or,ir,xe,je||tr||He||Je),Q(ue,K+or,or,ir,je,tr||He||Je),Q(ue+or,K,or,ir,tr,He||Je),Q(ue+or,K+or,or,ir,He,Je)}function fe(ue,K){let se=null,Te=0;for(;se===null;)if(se=ue[K*4+Te],Te++,Te>ue.length)return null;return se}return G}function O(y,R,T,M,B){let V=[];for(let I=0;I<B;I++){let F=u[I],j=v[I][0],z=g(y,R,I),q=g(T,M,I),C=Ic.ge(F,z),G=Ic.gt(F,q,C,F.length-1);V[I]=[C+j,G+j]}return V}function g(y,R,T){let M=1,B=.5,V=.5,I=.5;for(let F=0;F<T;F++)M<<=2,M+=y<B?R<V?0:1:R<V?2:3,I*=.5,B+=y<B?-I:I,V+=R<V?-I:I;return M}};function kc(r,e){let[t,n,i,a]=e,o=1/(i-t),f=1/(a-n),l=new Array(r.length);for(let s=0,u=r.length/2;s<u;s++)l[2*s]=Nc((r[2*s]-t)*o,0,1),l[2*s+1]=Nc((r[2*s+1]-n)*f,0,1);return l}var Zd=Sg,Jd=Cg;function Cg(r){var e=0,t=0,n=0,i=0;return r.map(function(a){a=a.slice();var o=a[0],f=o.toUpperCase();if(o!=f)switch(a[0]=f,o){case"a":a[6]+=n,a[7]+=i;break;case"v":a[1]+=i;break;case"h":a[1]+=n;break;default:for(var l=1;l<a.length;)a[l++]+=n,a[l++]+=i}switch(f){case"Z":n=e,i=t;break;case"H":n=a[1];break;case"V":i=a[1];break;case"M":n=e=a[1],i=t=a[2];break;default:n=a[a.length-2],i=a[a.length-1]}return a})}var Fg=function(){function r(e,t){var n=[],i=!0,a=!1,o=void 0;try{for(var f=e[Symbol.iterator](),l;!(i=(l=f.next()).done)&&(n.push(l.value),!(t&&n.length===t));i=!0);}catch(s){a=!0,o=s}finally{try{!i&&f.return&&f.return()}finally{if(a)throw o}}return n}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return r(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),$a=Math.PI*2,Il=function(e,t,n,i,a,o,f){var l=e.x,s=e.y;l*=t,s*=n;var u=i*l-a*s,v=a*l+i*s;return{x:u+o,y:v+f}},Og=function(e,t){var n=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=Math.cos(e),a=Math.sin(e),o=Math.cos(e+t),f=Math.sin(e+t);return[{x:i-a*n,y:a+i*n},{x:o+f*n,y:f-o*n},{x:o,y:f}]},zc=function(e,t,n,i){var a=e*i-t*n<0?-1:1,o=e*n+t*i;return o>1&&(o=1),o<-1&&(o=-1),a*Math.acos(o)},Lg=function(e,t,n,i,a,o,f,l,s,u,v,d){var c=Math.pow(a,2),p=Math.pow(o,2),O=Math.pow(v,2),g=Math.pow(d,2),y=c*p-c*g-p*O;y<0&&(y=0),y/=c*g+p*O,y=Math.sqrt(y)*(f===l?-1:1);var R=y*a/o*d,T=y*-o/a*v,M=u*R-s*T+(e+n)/2,B=s*R+u*T+(t+i)/2,V=(v-R)/a,I=(d-T)/o,F=(-v-R)/a,j=(-d-T)/o,z=zc(1,0,V,I),q=zc(V,I,F,j);return l===0&&q>0&&(q-=$a),l===1&&q<0&&(q+=$a),[M,B,z,q]},Rg=function(e){var t=e.px,n=e.py,i=e.cx,a=e.cy,o=e.rx,f=e.ry,l=e.xAxisRotation,s=l===void 0?0:l,u=e.largeArcFlag,v=u===void 0?0:u,d=e.sweepFlag,c=d===void 0?0:d,p=[];if(o===0||f===0)return[];var O=Math.sin(s*$a/360),g=Math.cos(s*$a/360),y=g*(t-i)/2+O*(n-a)/2,R=-O*(t-i)/2+g*(n-a)/2;if(y===0&&R===0)return[];o=Math.abs(o),f=Math.abs(f);var T=Math.pow(y,2)/Math.pow(o,2)+Math.pow(R,2)/Math.pow(f,2);T>1&&(o*=Math.sqrt(T),f*=Math.sqrt(T));var M=Lg(t,n,i,a,o,f,v,c,O,g,y,R),B=Fg(M,4),V=B[0],I=B[1],F=B[2],j=B[3],z=Math.abs(j)/($a/4);Math.abs(1-z)<1e-7&&(z=1);var q=Math.max(Math.ceil(z),1);j/=q;for(var C=0;C<q;C++)p.push(Og(F,j)),F+=j;return p.map(function(G){var Q=Il(G[0],o,f,g,O,V,I),fe=Q.x,ue=Q.y,K=Il(G[1],o,f,g,O,V,I),se=K.x,Te=K.y,ye=Il(G[2],o,f,g,O,V,I),Fe=ye.x,Qe=ye.y;return{x1:fe,y1:ue,x2:se,y2:Te,x:Fe,y:Qe}})};const Mg=Object.freeze(Object.defineProperty({__proto__:null,default:Rg},Symbol.toStringTag,{value:"Module"})),Ig=Hd(Mg);var Ng=Dg,Bg=Ig;function Dg(r){for(var e,t=[],n=0,i=0,a=0,o=0,f=null,l=null,s=0,u=0,v=0,d=r.length;v<d;v++){var c=r[v],p=c[0];switch(p){case"M":a=c[1],o=c[2];break;case"A":var O=Bg({px:s,py:u,cx:c[6],cy:c[7],rx:c[1],ry:c[2],xAxisRotation:c[3],largeArcFlag:c[4],sweepFlag:c[5]});if(!O.length)continue;for(var g=0,y;g<O.length;g++)y=O[g],c=["C",y.x1,y.y1,y.x2,y.y2,y.x,y.y],g<O.length-1&&t.push(c);break;case"S":var R=s,T=u;(e=="C"||e=="S")&&(R+=R-n,T+=T-i),c=["C",R,T,c[1],c[2],c[3],c[4]];break;case"T":e=="Q"||e=="T"?(f=s*2-f,l=u*2-l):(f=s,l=u),c=Pc(s,u,f,l,c[1],c[2]);break;case"Q":f=c[1],l=c[2],c=Pc(s,u,c[1],c[2],c[3],c[4]);break;case"L":c=Ci(s,u,c[1],c[2]);break;case"H":c=Ci(s,u,c[1],u);break;case"V":c=Ci(s,u,s,c[1]);break;case"Z":c=Ci(s,u,a,o);break}e=p,s=c[c.length-2],u=c[c.length-1],c.length>4?(n=c[c.length-4],i=c[c.length-3]):(n=s,i=u),t.push(c)}return t}function Ci(r,e,t,n){return["C",r,e,t,n,t,n]}function Pc(r,e,t,n,i,a){return["C",r/3+2/3*t,e/3+2/3*n,i/3+2/3*t,a/3+2/3*n,i,a]}var Qd=function(e){return typeof e!="string"?!1:(e=e.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\dz]$/i.test(e)&&e.length>4))},kg=Gd,zg=Jd,Pg=Ng,Gg=Qd,Ug=$g;function $g(r){if(Array.isArray(r)&&r.length===1&&typeof r[0]=="string"&&(r=r[0]),typeof r=="string"){if(!Gg(r))throw Error("String is not an SVG path.");r=kg(r)}if(!Array.isArray(r))throw Error("Argument should be a string or an array of path segments.");if(r=zg(r),r=Pg(r),!r.length)return[0,0,0,0];for(var e=[1/0,1/0,-1/0,-1/0],t=0,n=r.length;t<n;t++)for(var i=r[t].slice(1),a=0;a<i.length;a+=2)i[a+0]<e[0]&&(e[0]=i[a+0]),i[a+1]<e[1]&&(e[1]=i[a+1]),i[a+0]>e[2]&&(e[2]=i[a+0]),i[a+1]>e[3]&&(e[3]=i[a+1]);return e}var En=Math.PI,Gc=ep(120),jg=Vg;function Vg(r){for(var e,t=[],n=0,i=0,a=0,o=0,f=null,l=null,s=0,u=0,v=0,d=r.length;v<d;v++){var c=r[v],p=c[0];switch(p){case"M":a=c[1],o=c[2];break;case"A":c=Kd(s,u,c[1],c[2],ep(c[3]),c[4],c[5],c[6],c[7]),c.unshift("C"),c.length>7&&(t.push(c.splice(0,7)),c.unshift("C"));break;case"S":var O=s,g=u;(e=="C"||e=="S")&&(O+=O-n,g+=g-i),c=["C",O,g,c[1],c[2],c[3],c[4]];break;case"T":e=="Q"||e=="T"?(f=s*2-f,l=u*2-l):(f=s,l=u),c=Uc(s,u,f,l,c[1],c[2]);break;case"Q":f=c[1],l=c[2],c=Uc(s,u,c[1],c[2],c[3],c[4]);break;case"L":c=Fi(s,u,c[1],c[2]);break;case"H":c=Fi(s,u,c[1],u);break;case"V":c=Fi(s,u,s,c[1]);break;case"Z":c=Fi(s,u,a,o);break}e=p,s=c[c.length-2],u=c[c.length-1],c.length>4?(n=c[c.length-4],i=c[c.length-3]):(n=s,i=u),t.push(c)}return t}function Fi(r,e,t,n){return["C",r,e,t,n,t,n]}function Uc(r,e,t,n,i,a){return["C",r/3+2/3*t,e/3+2/3*n,i/3+2/3*t,a/3+2/3*n,i,a]}function Kd(r,e,t,n,i,a,o,f,l,s){if(s)T=s[0],M=s[1],y=s[2],R=s[3];else{var u=Nl(r,e,-i);r=u.x,e=u.y,u=Nl(f,l,-i),f=u.x,l=u.y;var v=(r-f)/2,d=(e-l)/2,c=v*v/(t*t)+d*d/(n*n);c>1&&(c=Math.sqrt(c),t=c*t,n=c*n);var p=t*t,O=n*n,g=(a==o?-1:1)*Math.sqrt(Math.abs((p*O-p*d*d-O*v*v)/(p*d*d+O*v*v)));g==1/0&&(g=1);var y=g*t*d/n+(r+f)/2,R=g*-n*v/t+(e+l)/2,T=Math.asin(((e-R)/n).toFixed(9)),M=Math.asin(((l-R)/n).toFixed(9));T=r<y?En-T:T,M=f<y?En-M:M,T<0&&(T=En*2+T),M<0&&(M=En*2+M),o&&T>M&&(T=T-En*2),!o&&M>T&&(M=M-En*2)}if(Math.abs(M-T)>Gc){var B=M,V=f,I=l;M=T+Gc*(o&&M>T?1:-1),f=y+t*Math.cos(M),l=R+n*Math.sin(M);var F=Kd(f,l,t,n,i,0,o,V,I,[M,B,y,R])}var j=Math.tan((M-T)/4),z=4/3*t*j,q=4/3*n*j,C=[2*r-(r+z*Math.sin(T)),2*e-(e-q*Math.cos(T)),f+z*Math.sin(M),l-q*Math.cos(M),f,l];if(s)return C;F&&(C=C.concat(F));for(var G=0;G<C.length;){var Q=Nl(C[G],C[G+1],i);C[G++]=Q.x,C[G++]=Q.y}return C}function Nl(r,e,t){return{x:r*Math.cos(t)-e*Math.sin(t),y:r*Math.sin(t)+e*Math.cos(t)}}function ep(r){return r*(En/180)}var qg=Jd,Hg=jg,Wg={M:"moveTo",C:"bezierCurveTo"},Xg=function(r,e){r.beginPath(),Hg(qg(e)).forEach(function(t){var n=t[0],i=t.slice(1);r[Wg[n]].apply(r,i)}),r.closePath()},Yg=Zg,ja=1e20;function Zg(r,e){e||(e={});var t=e.cutoff==null?.25:e.cutoff,n=e.radius==null?8:e.radius,i=e.channel||0,a,o,f,l,s,u,v,d,c,p,O;if(ArrayBuffer.isView(r)||Array.isArray(r)){if(!e.width||!e.height)throw Error("For raw data width and height should be provided by options");a=e.width,o=e.height,l=r,e.stride?u=e.stride:u=Math.floor(r.length/a/o)}else window.HTMLCanvasElement&&r instanceof window.HTMLCanvasElement?(d=r,v=d.getContext("2d"),a=d.width,o=d.height,c=v.getImageData(0,0,a,o),l=c.data,u=4):window.CanvasRenderingContext2D&&r instanceof window.CanvasRenderingContext2D?(d=r.canvas,v=r,a=d.width,o=d.height,c=v.getImageData(0,0,a,o),l=c.data,u=4):window.ImageData&&r instanceof window.ImageData&&(c=r,a=r.width,o=r.height,l=c.data,u=4);if(f=Math.max(a,o),window.Uint8ClampedArray&&l instanceof window.Uint8ClampedArray||window.Uint8Array&&l instanceof window.Uint8Array)for(s=l,l=Array(a*o),p=0,O=Math.floor(s.length/u);p<O;p++)l[p]=s[p*u+i]/255;else if(u!==1)throw Error("Raw data can have only 1 value per pixel");var g=Array(a*o),y=Array(a*o),R=Array(f),T=Array(f),M=Array(f+1),B=Array(f);for(p=0,O=a*o;p<O;p++){var V=l[p];g[p]=V===1?0:V===0?ja:Math.pow(Math.max(0,.5-V),2),y[p]=V===1?ja:V===0?0:Math.pow(Math.max(0,V-.5),2)}$c(g,a,o,R,T,B,M),$c(y,a,o,R,T,B,M);var I=window.Float32Array?new Float32Array(a*o):new Array(a*o);for(p=0,O=a*o;p<O;p++)I[p]=Math.min(Math.max(1-((g[p]-y[p])/n+t),0),1);return I}function $c(r,e,t,n,i,a,o){for(var f=0;f<e;f++){for(var l=0;l<t;l++)n[l]=r[l*e+f];for(jc(n,i,a,o,t),l=0;l<t;l++)r[l*e+f]=i[l]}for(l=0;l<t;l++){for(f=0;f<e;f++)n[f]=r[l*e+f];for(jc(n,i,a,o,e),f=0;f<e;f++)r[l*e+f]=Math.sqrt(i[f])}}function jc(r,e,t,n,i){t[0]=0,n[0]=-ja,n[1]=+ja;for(var a=1,o=0;a<i;a++){for(var f=(r[a]+a*a-(r[t[o]]+t[o]*t[o]))/(2*a-2*t[o]);f<=n[o];)o--,f=(r[a]+a*a-(r[t[o]]+t[o]*t[o]))/(2*a-2*t[o]);o++,t[o]=a,n[o]=f,n[o+1]=+ja}for(a=0,o=0;a<i;a++){for(;n[o+1]<a;)o++;e[a]=(a-t[o])*(a-t[o])+r[t[o]]}}var Jg=Ug,Qg=Gd,Kg=Xg,ex=Qd,rx=Yg,xs=document.createElement("canvas"),et=xs.getContext("2d"),tx=nx;function nx(r,e){if(!ex(r))throw Error("Argument should be valid svg path string");e||(e={});var t,n;e.shape?(t=e.shape[0],n=e.shape[1]):(t=xs.width=e.w||e.width||200,n=xs.height=e.h||e.height||200);var i=Math.min(t,n),a=e.stroke||0,o=e.viewbox||e.viewBox||Jg(r),f=[t/(o[2]-o[0]),n/(o[3]-o[1])],l=Math.min(f[0]||0,f[1]||0)/2;if(et.fillStyle="black",et.fillRect(0,0,t,n),et.fillStyle="white",a&&(typeof a!="number"&&(a=1),a>0?et.strokeStyle="white":et.strokeStyle="black",et.lineWidth=Math.abs(a)),et.translate(t*.5,n*.5),et.scale(l,l),ax()){var s=new Path2D(r);et.fill(s),a&&et.stroke(s)}else{var u=Qg(r);Kg(et,u),et.fill(),a&&et.stroke()}et.setTransform(1,0,0,1,0,0);var v=rx(et,{cutoff:e.cutoff!=null?e.cutoff:.5,radius:e.radius!=null?e.radius:i*.5});return v}var Oi;function ax(){if(Oi!=null)return Oi;var r=document.createElement("canvas").getContext("2d");if(r.canvas.width=r.canvas.height=1,!window.Path2D)return Oi=!1;var e=new Path2D("M0,0h1v1h-1v-1Z");r.fillStyle="black",r.fill(e);var t=r.getImageData(0,0,1,1);return Oi=t&&t.data&&t.data[3]===255}var Wi=Ln,ix=tx,Li=Ya,ox=vn,ma=wr,Fr=ma.isArrayOrTypedArray,ca=Xa,Vc=$d,qc=vm.formatColor,pa=eo,lx=dm,bs=no,ei=to,fx=Ud.DESELECTDIM,Hc={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},sx=hm.appendArrayPointValue;function ux(r,e){var t,n={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},i=r._context.plotGlPixelRatio;if(e.visible!==!0)return n;if(pa.hasText(e)&&(n.text=rp(r,e),n.textSel=Xc(r,e,e.selected),n.textUnsel=Xc(r,e,e.unselected)),pa.hasMarkers(e)&&(n.marker=ks(r,e),n.markerSel=_s(r,e,e.selected),n.markerUnsel=_s(r,e,e.unselected),!e.unselected&&Fr(e.marker.opacity))){var a=e.marker.opacity;for(n.markerUnsel.opacity=new Array(a.length),t=0;t<a.length;t++)n.markerUnsel.opacity[t]=fx*a[t]}if(pa.hasLines(e)){n.line={overlay:!0,thickness:e.line.width*i,color:e.line.color,opacity:e.opacity};var o=(ei.DASHES[e.line.dash]||[1]).slice();for(t=0;t<o.length;++t)o[t]*=e.line.width*i;n.line.dashes=o}return e.error_x&&e.error_x.visible&&(n.errorX=Yc(e,e.error_x,i)),e.error_y&&e.error_y.visible&&(n.errorY=Yc(e,e.error_y,i)),e.fill&&e.fill!=="none"&&(n.fill={closed:!0,fill:e.fillcolor,thickness:0}),n}function rp(r,e){var t=r._fullLayout,n=e._length,i=e.textfont,a=e.textposition,o=Fr(a)?a:[a],f=i.color,l=i.size,s=i.family,u=i.weight,v=i.style,d=i.variant,c={},p,O=r._context.plotGlPixelRatio,g=e.texttemplate;if(g){c.text=[];var y=t._d3locale,R=Array.isArray(g),T=R?Math.min(g.length,n):n,M=R?function(q){return g[q]}:function(){return g};for(p=0;p<T;p++){var B={i:p},V=e._module.formatLabels(B,e,t),I={};sx(I,e,p);var F=e._meta||{};c.text.push(ma.texttemplateString(M(p),V,y,I,B,F))}}else Fr(e.text)&&e.text.length<n?c.text=e.text.slice():c.text=e.text;if(Fr(c.text))for(p=c.text.length;p<n;p++)c.text[p]="";for(c.opacity=e.opacity,c.font={},c.align=[],c.baseline=[],p=0;p<o.length;p++){var j=o[p].split(/\s+/);switch(j[1]){case"left":c.align.push("right");break;case"right":c.align.push("left");break;default:c.align.push(j[1])}switch(j[0]){case"top":c.baseline.push("bottom");break;case"bottom":c.baseline.push("top");break;default:c.baseline.push(j[0])}}if(Fr(f))for(c.color=new Array(n),p=0;p<n;p++)c.color[p]=f[p];else c.color=f;if(Fr(l)||Array.isArray(s)||Fr(u)||Array.isArray(v)||Array.isArray(d))for(c.font=new Array(n),p=0;p<n;p++){var z=c.font[p]={};z.size=(ma.isTypedArray(l)?l[p]:Fr(l)?Wi(l[p])?l[p]:0:l)*O,z.family=Array.isArray(s)?s[p]:s,z.weight=Wc(Fr(u)?u[p]:u),z.style=Array.isArray(v)?v[p]:v,z.variant=Array.isArray(d)?d[p]:d}else c.font={size:l*O,family:s,weight:Wc(u),style:v,variant:d};return c}function Wc(r){return r<=1e3?r>500?"bold":"normal":r}function ks(r,e){var t=e._length,n=e.marker,i={},a,o=Fr(n.symbol),f=Fr(n.angle),l=Fr(n.color),s=Fr(n.line.color),u=Fr(n.opacity),v=Fr(n.size),d=Fr(n.line.width),c;if(o||(c=bs.isOpenSymbol(n.symbol)),o||l||s||u||f){i.symbols=new Array(t),i.angles=new Array(t),i.colors=new Array(t),i.borderColors=new Array(t);var p=n.symbol,O=n.angle,g=qc(n,n.opacity,t),y=qc(n.line,n.opacity,t);if(!Fr(y[0])){var R=y;for(y=Array(t),a=0;a<t;a++)y[a]=R}if(!Fr(g[0])){var T=g;for(g=Array(t),a=0;a<t;a++)g[a]=T}if(!Fr(p)){var M=p;for(p=Array(t),a=0;a<t;a++)p[a]=M}if(!Fr(O)){var B=O;for(O=Array(t),a=0;a<t;a++)O[a]=B}for(i.symbols=p,i.angles=O,i.colors=g,i.borderColors=y,a=0;a<t;a++)o&&(c=bs.isOpenSymbol(n.symbol[a])),c&&(y[a]=g[a].slice(),g[a]=g[a].slice(),g[a][3]=0);for(i.opacity=e.opacity,i.markers=new Array(t),a=0;a<t;a++)i.markers[a]=Qc({mx:i.symbols[a],ma:i.angles[a]},e)}else c?(i.color=Li(n.color,"uint8"),i.color[3]=0,i.borderColor=Li(n.color,"uint8")):(i.color=Li(n.color,"uint8"),i.borderColor=Li(n.line.color,"uint8")),i.opacity=e.opacity*n.opacity,i.marker=Qc({mx:n.symbol,ma:n.angle},e);var V=1,I=lx(e,V),F;if(v||d){var j=i.sizes=new Array(t),z=i.borderSizes=new Array(t),q=0,C;if(v){for(a=0;a<t;a++)j[a]=I(n.size[a]),q+=j[a];C=q/t}else for(F=I(n.size),a=0;a<t;a++)j[a]=F;if(d)for(a=0;a<t;a++)z[a]=n.line.width[a];else for(F=n.line.width,a=0;a<t;a++)z[a]=F;i.sizeAvg=C}else i.size=I(n&&n.size||10),i.borderSizes=I(n.line.width);return i}function _s(r,e,t){var n=e.marker,i={};return t&&(t.marker&&t.marker.symbol?i=ks(r,ma.extendFlat({},n,t.marker)):t.marker&&(t.marker.size&&(i.size=t.marker.size),t.marker.color&&(i.colors=t.marker.color),t.marker.opacity!==void 0&&(i.opacity=t.marker.opacity))),i}function Xc(r,e,t){var n={};if(!t)return n;if(t.textfont){var i={opacity:1,text:e.text,texttemplate:e.texttemplate,textposition:e.textposition,textfont:ma.extendFlat({},e.textfont)};t.textfont&&ma.extendFlat(i.textfont,t.textfont),n=rp(r,i)}return n}function Yc(r,e,t){var n={capSize:e.width*2*t,lineWidth:e.thickness*t,color:e.color};return e.copy_ystyle&&(n=r.error_y),n}var Zc=ei.SYMBOL_SDF_SIZE,Sn=ei.SYMBOL_SIZE,Jc=ei.SYMBOL_STROKE,Bl={},cx=ca.symbolFuncs[0](Sn*.05);function Qc(r,e){var t=r.mx;if(t==="circle")return null;var n,i,a=ca.symbolNumber(t),o=ca.symbolFuncs[a%100],f=!!ca.symbolNoDot[a%100],l=!!ca.symbolNoFill[a%100],s=bs.isDotSymbol(t);if(r.ma&&(t+="_"+r.ma),Bl[t])return Bl[t];var u=ca.getMarkerAngle(r,e);return s&&!f?n=o(Sn*1.1,u)+cx:n=o(Sn,u),i=ix(n,{w:Zc,h:Zc,viewBox:[-Sn,-Sn,Sn,Sn],stroke:l?Jc:-Jc}),Bl[t]=i,i||null}function vx(r,e,t){var n=t.length,i=n/2,a,o;if(pa.hasLines(e)&&i)if(e.line.shape==="hv"){for(a=[],o=0;o<i-1;o++)isNaN(t[o*2])||isNaN(t[o*2+1])?a.push(NaN,NaN,NaN,NaN):(a.push(t[o*2],t[o*2+1]),!isNaN(t[o*2+2])&&!isNaN(t[o*2+3])?a.push(t[o*2+2],t[o*2+1]):a.push(NaN,NaN));a.push(t[n-2],t[n-1])}else if(e.line.shape==="hvh"){for(a=[],o=0;o<i-1;o++)if(isNaN(t[o*2])||isNaN(t[o*2+1])||isNaN(t[o*2+2])||isNaN(t[o*2+3]))!isNaN(t[o*2])&&!isNaN(t[o*2+1])?a.push(t[o*2],t[o*2+1]):a.push(NaN,NaN),a.push(NaN,NaN);else{var f=(t[o*2]+t[o*2+2])/2;a.push(t[o*2],t[o*2+1],f,t[o*2+1],f,t[o*2+3])}a.push(t[n-2],t[n-1])}else if(e.line.shape==="vhv"){for(a=[],o=0;o<i-1;o++)if(isNaN(t[o*2])||isNaN(t[o*2+1])||isNaN(t[o*2+2])||isNaN(t[o*2+3]))!isNaN(t[o*2])&&!isNaN(t[o*2+1])?a.push(t[o*2],t[o*2+1]):a.push(NaN,NaN),a.push(NaN,NaN);else{var l=(t[o*2+1]+t[o*2+3])/2;a.push(t[o*2],t[o*2+1],t[o*2],l,t[o*2+2],l)}a.push(t[n-2],t[n-1])}else if(e.line.shape==="vh"){for(a=[],o=0;o<i-1;o++)isNaN(t[o*2])||isNaN(t[o*2+1])?a.push(NaN,NaN,NaN,NaN):(a.push(t[o*2],t[o*2+1]),!isNaN(t[o*2+2])&&!isNaN(t[o*2+3])?a.push(t[o*2],t[o*2+3]):a.push(NaN,NaN));a.push(t[n-2],t[n-1])}else a=t;var s=!1;for(o=0;o<a.length;o++)if(isNaN(a[o])){s=!0;break}var u=s||a.length>ei.TOO_MANY_POINTS||pa.hasMarkers(e)?"rect":"round";if(s&&e.connectgaps){var v=a[0],d=a[1];for(o=0;o<a.length;o+=2)isNaN(a[o])||isNaN(a[o+1])?(a[o]=v,a[o+1]=d):(v=a[o],d=a[o+1])}return{join:u,positions:a}}function hx(r,e,t,n,i){var a=ox.getComponentMethod("errorbars","makeComputeError"),o=Vc.getFromId(r,e.xaxis,"x"),f=Vc.getFromId(r,e.yaxis,"y"),l=t.length/2,s={};function u(v,d){var c=d._id.charAt(0),p=e["error_"+c];if(p&&p.visible&&(d.type==="linear"||d.type==="log")){for(var O=a(p),g={x:0,y:1}[c],y={x:[0,1,2,3],y:[2,3,0,1]}[c],R=new Float64Array(4*l),T=1/0,M=-1/0,B=0,V=0;B<l;B++,V+=4){var I=v[B];if(Wi(I)){var F=t[B*2+g],j=O(I,B),z=j[0],q=j[1];if(Wi(z)&&Wi(q)){var C=I-z,G=I+q;R[V+y[0]]=F-d.c2l(C),R[V+y[1]]=d.c2l(G)-F,R[V+y[2]]=0,R[V+y[3]]=0,T=Math.min(T,I-z),M=Math.max(M,I+q)}}}s[c]={positions:t,errors:R,_bnds:[T,M]}}}return u(n,o),u(i,f),s}function dx(r,e,t,n){var i=e._length,a={},o;if(pa.hasMarkers(e)){var f=t.font,l=t.align,s=t.baseline;for(a.offset=new Array(i),o=0;o<i;o++){var u=n.sizes?n.sizes[o]:n.size,v=Fr(f)?f[o].size:f.size,d=Fr(l)?l.length>1?l[o]:l[0]:l,c=Fr(s)?s.length>1?s[o]:s[0]:s,p=Hc[d],O=Hc[c],g=u?u/.8+1:0,y=-O*g-O*.5;a.offset[o]=[p*g/v,y/v]}}return a}var px={style:ux,markerStyle:ks,markerSelection:_s,linePositions:vx,errorBarPositions:hx,textPosition:dx},Ri=wr,yx=function(e,t){var n=t._scene,i={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},a={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return t._scene||(n=t._scene={},n.init=function(){Ri.extendFlat(n,a,i)},n.init(),n.update=function(f){var l=Ri.repeat(f,n.count);if(n.fill2d&&n.fill2d.update(l),n.scatter2d&&n.scatter2d.update(l),n.line2d&&n.line2d.update(l),n.error2d&&n.error2d.update(l.concat(l)),n.select2d&&n.select2d.update(l),n.glText)for(var s=0;s<n.count;s++)n.glText[s].update(f)},n.draw=function(){for(var f=n.count,l=n.fill2d,s=n.error2d,u=n.line2d,v=n.scatter2d,d=n.glText,c=n.select2d,p=n.selectBatch,O=n.unselectBatch,g=0;g<f;g++){if(l&&n.fillOrder[g]&&l.draw(n.fillOrder[g]),u&&n.lineOptions[g]&&u.draw(g),s&&(n.errorXOptions[g]&&s.draw(g),n.errorYOptions[g]&&s.draw(g+f)),v&&n.markerOptions[g])if(O[g].length){var y=Ri.repeat([],n.count);y[g]=O[g],v.draw(y)}else p[g].length||v.draw(g);d[g]&&n.textOptions[g]&&d[g].render()}c&&c.draw(p),n.dirty=!1},n.destroy=function(){n.fill2d&&n.fill2d.destroy&&n.fill2d.destroy(),n.scatter2d&&n.scatter2d.destroy&&n.scatter2d.destroy(),n.error2d&&n.error2d.destroy&&n.error2d.destroy(),n.line2d&&n.line2d.destroy&&n.line2d.destroy(),n.select2d&&n.select2d.destroy&&n.select2d.destroy(),n.glText&&n.glText.forEach(function(f){f.destroy&&f.destroy()}),n.lineOptions=null,n.fillOptions=null,n.markerOptions=null,n.markerSelectedOptions=null,n.markerUnselectedOptions=null,n.errorXOptions=null,n.errorYOptions=null,n.textOptions=null,n.textSelectedOptions=null,n.textUnselectedOptions=null,n.selectBatch=null,n.unselectBatch=null,t._scene=null}),n.dirty||Ri.extendFlat(n,i),n},mx=Zd,aa=wr,Kc=$d,gx=pm.findExtremes,ev=Bs,zs=ym,xx=zs.calcMarkerSize,bx=zs.calcAxisExpansion,_x=zs.setFirstScatter,Ax=mm,ia=px,wx=yx,rv=Za.BADNUM,Tx=to.TOO_MANY_POINTS,Ex=function(e,t){var n=e._fullLayout,i=t._xA=Kc.getFromId(e,t.xaxis,"x"),a=t._yA=Kc.getFromId(e,t.yaxis,"y"),o=n._plots[t.xaxis+t.yaxis],f=t._length,l=f>=Tx,s=f*2,u={},v,d=i.makeCalcdata(t,"x"),c=a.makeCalcdata(t,"y"),p=ev(t,i,"x",d),O=ev(t,a,"y",c),g=p.vals,y=O.vals;t._x=g,t._y=y,t.xperiodalignment&&(t._origX=d,t._xStarts=p.starts,t._xEnds=p.ends),t.yperiodalignment&&(t._origY=c,t._yStarts=O.starts,t._yEnds=O.ends);var R=new Array(s),T=new Array(f);for(v=0;v<f;v++)R[v*2]=g[v]===rv?NaN:g[v],R[v*2+1]=y[v]===rv?NaN:y[v],T[v]=v;if(i.type==="log")for(v=0;v<s;v+=2)R[v]=i.c2l(R[v]);if(a.type==="log")for(v=1;v<s;v+=2)R[v]=a.c2l(R[v]);l&&i.type!=="log"&&a.type!=="log"?u.tree=mx(R):u.ids=T,Ax(e,t);var M=Sx(e,o,t,R,g,y),B=wx(e,o);_x(n,t);var V;return l?M.marker&&(V=M.marker.sizeAvg||Math.max(M.marker.size,3)):V=xx(t,f),bx(e,t,i,a,g,y,V),M.errorX&&tv(t,i,M.errorX),M.errorY&&tv(t,a,M.errorY),M.fill&&!B.fill2d&&(B.fill2d=!0),M.marker&&!B.scatter2d&&(B.scatter2d=!0),M.line&&!B.line2d&&(B.line2d=!0),(M.errorX||M.errorY)&&!B.error2d&&(B.error2d=!0),M.text&&!B.glText&&(B.glText=!0),M.marker&&(M.marker.snap=f),B.lineOptions.push(M.line),B.errorXOptions.push(M.errorX),B.errorYOptions.push(M.errorY),B.fillOptions.push(M.fill),B.markerOptions.push(M.marker),B.markerSelectedOptions.push(M.markerSel),B.markerUnselectedOptions.push(M.markerUnsel),B.textOptions.push(M.text),B.textSelectedOptions.push(M.textSel),B.textUnselectedOptions.push(M.textUnsel),B.selectBatch.push([]),B.unselectBatch.push([]),u._scene=B,u.index=B.count,u.x=g,u.y=y,u.positions=R,B.count++,[{x:!1,y:!1,t:u,trace:t}]};function tv(r,e,t){var n=r._extremes[e._id],i=gx(e,t._bnds,{padded:!0});n.min=n.min.concat(i.min),n.max=n.max.concat(i.max)}function Sx(r,e,t,n,i,a){var o=ia.style(r,t);if(o.marker&&(o.marker.positions=n),o.line&&n.length>1&&aa.extendFlat(o.line,ia.linePositions(r,t,n)),o.errorX||o.errorY){var f=ia.errorBarPositions(r,t,n,i,a);o.errorX&&aa.extendFlat(o.errorX,f.x),o.errorY&&aa.extendFlat(o.errorY,f.y)}return o.text&&(aa.extendFlat(o.text,{positions:n},ia.textPosition(r,t,o.text,o.marker)),aa.extendFlat(o.textSel,{positions:n},ia.textPosition(r,t,o.text,o.markerSel)),aa.extendFlat(o.textUnsel,{positions:n},ia.textPosition(r,t,o.text,o.markerUnsel))),o}var nv=wr,Cx=ro,Fx=Ud.DESELECTDIM;function Ox(r){var e=r[0],t=e.trace,n=e.t,i=n._scene,a=n.index,o=i.selectBatch[a],f=i.unselectBatch[a],l=i.textOptions[a],s=i.textSelectedOptions[a]||{},u=i.textUnselectedOptions[a]||{},v=nv.extendFlat({},l),d,c;if(o.length||f.length){var p=s.color,O=u.color,g=l.color,y=nv.isArrayOrTypedArray(g);for(v.color=new Array(t._length),d=0;d<o.length;d++)c=o[d],v.color[c]=p||(y?g[c]:g);for(d=0;d<f.length;d++){c=f[d];var R=y?g[c]:g;v.color[c]=O||(p?R:Cx.addOpacity(R,Fx))}}i.glText[a].update(v)}var tp={styleTextSelection:Ox},av=eo,Lx=tp.styleTextSelection,Rx=function(e,t){var n=e.cd,i=e.xaxis,a=e.yaxis,o=[],f=n[0].trace,l=n[0].t,s=f._length,u=l.x,v=l.y,d=l._scene,c=l.index;if(!d)return o;var p=av.hasText(f),O=av.hasMarkers(f),g=!O&&!p;if(f.visible!==!0||g)return o;var y=[],R=[];if(t!==!1&&!t.degenerate)for(var T=0;T<s;T++)t.contains([l.xpx[T],l.ypx[T]],!1,T,e)?(y.push(T),o.push({pointNumber:T,x:i.c2d(u[T]),y:a.c2d(v[T])})):R.push(T);if(O){var M=d.scatter2d;if(!y.length&&!R.length){var B=new Array(d.count);B[c]=d.markerOptions[c],M.update.apply(M,B)}else if(!d.selectBatch[c].length&&!d.unselectBatch[c].length){var V=new Array(d.count);V[c]=d.markerUnselectedOptions[c],M.update.apply(M,V)}}return d.selectBatch[c]=y,d.unselectBatch[c]=R,p&&Lx(n),o},Mx=Gm,Ix={moduleType:"trace",name:"scattergl",basePlotModule:jd,categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:Xd,supplyDefaults:ag,crossTraceDefaults:xm,colorbar:gm,formatLabels:og,calc:Ex,hoverPoints:Mx.hoverPoints,selectPoints:Rx,meta:{hrName:"scatter_gl",description:["The data visualized as scatter point or lines is set in `x` and `y`","using the WebGL plotting engine.","Bubble charts are achieved by setting `marker.size` and/or `marker.color`","to a numerical arrays."].join(" ")}},np={exports:{}},io={exports:{}},Mi=Pd;io.exports=ap;io.exports.to=ap;io.exports.from=Nx;function ap(r,e){e==null&&(e=!0);var t=r[0],n=r[1],i=r[2],a=r[3];a==null&&(a=e?1:255),e&&(t*=255,n*=255,i*=255,a*=255),t=Mi(t,0,255)&255,n=Mi(n,0,255)&255,i=Mi(i,0,255)&255,a=Mi(a,0,255)&255;var o=t*16777216+(n<<16)+(i<<8)+a;return o}function Nx(r,e){r=+r;var t=r>>>24,n=(r&16711680)>>>16,i=(r&65280)>>>8,a=r&255;return e===!1?[t,n,i,a]:[t/255,n/255,i/255,a/255]}var Bx=io.exports;/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var iv=Object.getOwnPropertySymbols,Dx=Object.prototype.hasOwnProperty,kx=Object.prototype.propertyIsEnumerable;function zx(r){if(r==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function Px(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de",Object.getOwnPropertyNames(r)[0]==="5")return!1;for(var e={},t=0;t<10;t++)e["_"+String.fromCharCode(t)]=t;var n=Object.getOwnPropertyNames(e).map(function(a){return e[a]});if(n.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(a){i[a]=a}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var ri=Px()?Object.assign:function(r,e){for(var t,n=zx(r),i,a=1;a<arguments.length;a++){t=Object(arguments[a]);for(var o in t)Dx.call(t,o)&&(n[o]=t[o]);if(iv){i=iv(t);for(var f=0;f<i.length;f++)kx.call(t,i[f])&&(n[i[f]]=t[i[f]])}}return n},Gx=function(r){typeof r=="string"&&(r=[r]);for(var e=[].slice.call(arguments,1),t=[],n=0;n<r.length-1;n++)t.push(r[n],e[n]||"");return t.push(r[n]),t.join("")},ip=function(e,t,n){Array.isArray(n)||(n=[].slice.call(arguments,2));for(var i=0,a=n.length;i<a;i++){var o=n[i];for(var f in o)if(!(t[f]!==void 0&&!Array.isArray(t[f])&&e[f]===t[f])&&f in t){var l;if(o[f]===!0)l=t[f];else{if(o[f]===!1)continue;if(typeof o[f]=="function"&&(l=o[f](t[f],e,t),l===void 0))continue}e[f]=l}}return e},Ux=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)),ga={exports:{}};ga.exports=Va;ga.exports.float32=ga.exports.float=Va;ga.exports.fract32=ga.exports.fract=$x;var ov=new Float32Array(1);function $x(r,e){if(r.length){if(r instanceof Float32Array)return new Float32Array(r.length);e instanceof Float32Array||(e=Va(r));for(var t=0,n=e.length;t<n;t++)e[t]=r[t]-e[t];return e}return Va(r-Va(r))}function Va(r){return r.length?r instanceof Float32Array?r:new Float32Array(r):(ov[0]=r,ov[0])}var Ps=ga.exports;function jx(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n,i,a,o,f=[],l=!0,s=!1;try{if(a=(t=t.call(r)).next,e!==0)for(;!(l=(n=a.call(t)).done)&&(f.push(n.value),f.length!==e);l=!0);}catch(u){s=!0,i=u}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(s)throw i}}return f}}function Vx(r,e){return Wx(r)||jx(r,e)||op(r,e)||Zx()}function qx(r){return Hx(r)||Xx(r)||op(r)||Yx()}function Hx(r){if(Array.isArray(r))return As(r)}function Wx(r){if(Array.isArray(r))return r}function Xx(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function op(r,e){if(r){if(typeof r=="string")return As(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return As(r,e)}}function As(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Yx(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zx(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Jx=Ya,Qx=Qa,Kx=Bx,e1=Zd,Cn=ri,Ii=Gx,r1=dn,t1=ip,n1=Ka,lv=Ux,Ni=Ps,a1=ao,i1=qr;function qr(r,e){var t=this;if(!(this instanceof qr))return new qr(r,e);typeof r=="function"?(e||(e={}),e.regl=r):(e=r,r=null),e&&e.length&&(e.positions=e),r=e.regl;var n=r._gl,i,a=[],o={},f=[],l=[null],s=[null],u=255,v=100;this.tooManyColors=lv,i=r.texture({data:new Uint8Array(u*4),width:u,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),Cn(this,{regl:r,gl:n,groups:f,markerCache:s,markerTextures:l,palette:a,paletteIds:o,paletteTexture:i,maxColors:u,maxSize:v,canvas:n.canvas}),this.update(e);var d={uniforms:{constPointSize:!!e.constPointSize,opacity:r.prop("opacity"),paletteSize:function(g,y){return[t.tooManyColors?0:u,i.height]},pixelRatio:r.context("pixelRatio"),scale:r.prop("scale"),scaleFract:r.prop("scaleFract"),translate:r.prop("translate"),translateFract:r.prop("translateFract"),markerTexture:r.prop("markerTexture"),paletteTexture:i},attributes:{x:function(g,y){return y.xAttr||{buffer:y.positionBuffer,stride:8,offset:0}},y:function(g,y){return y.yAttr||{buffer:y.positionBuffer,stride:8,offset:4}},xFract:function(g,y){return y.xAttr?{constant:[0,0]}:{buffer:y.positionFractBuffer,stride:8,offset:0}},yFract:function(g,y){return y.yAttr?{constant:[0,0]}:{buffer:y.positionFractBuffer,stride:8,offset:4}},size:function(g,y){return y.size.length?{buffer:y.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(y.size*255/t.maxSize)]}},borderSize:function(g,y){return y.borderSize.length?{buffer:y.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(y.borderSize*255/t.maxSize)]}},colorId:function(g,y){return y.color.length?{buffer:y.colorBuffer,stride:t.tooManyColors?8:4,offset:0}:{constant:t.tooManyColors?a.slice(y.color*4,y.color*4+4):[y.color]}},borderColorId:function(g,y){return y.borderColor.length?{buffer:y.colorBuffer,stride:t.tooManyColors?8:4,offset:t.tooManyColors?4:2}:{constant:t.tooManyColors?a.slice(y.borderColor*4,y.borderColor*4+4):[y.borderColor]}},isActive:function(g,y){return y.activation===!0?{constant:[1]}:y.activation?y.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:r.prop("viewport")},viewport:r.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:r.prop("elements"),count:r.prop("count"),offset:r.prop("offset"),primitive:"points"},c=Cn({},d);c.frag=Ii([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),c.vert=Ii([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

// \`invariant\` effectively turns off optimizations for the position.
// We need this because -fast-math on M1 Macs is re-ordering
// floating point operations in a way that causes floating point
// precision limits to put points in the wrong locations.
invariant gl_Position;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}
`]),this.drawMarker=r(c);var p=Cn({},d);p.frag=Ii([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),p.vert=Ii([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

// \`invariant\` effectively turns off optimizations for the position.
// We need this because -fast-math on M1 Macs is re-ordering
// floating point operations in a way that causes floating point
// precision limits to put points in the wrong locations.
invariant gl_Position;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),lv&&(p.frag=p.frag.replace("smoothstep","smoothStep"),c.frag=c.frag.replace("smoothstep","smoothStep")),this.drawCircle=r(p)}qr.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4};qr.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this};qr.prototype.draw=function(){for(var r=this,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=this.groups;if(t.length===1&&Array.isArray(t[0])&&(t[0][0]===null||Array.isArray(t[0][0]))&&(t=t[0]),this.regl._refresh(),t.length)for(var a=0;a<t.length;a++)this.drawItem(a,t[a]);else i.forEach(function(o,f){r.drawItem(f)});return this};qr.prototype.drawItem=function(r,e){var t=this.groups,n=t[r];if(typeof e=="number"&&(r=e,n=t[e],e=null),!!(n&&n.count&&n.opacity)){n.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,n,e));for(var i=[],a=1;a<n.activation.length;a++)!n.activation[a]||n.activation[a]!==!0&&!n.activation[a].data.length||i.push.apply(i,qx(this.getMarkerDrawOptions(a,n,e)));i.length&&this.drawMarker(i)}};qr.prototype.getMarkerDrawOptions=function(r,e,t){var n=e.range,i=e.tree,a=e.viewport,o=e.activation,f=e.selectionBuffer,l=e.count;if(this.regl,!i)return t?[Cn({},e,{markerTexture:this.markerTextures[r],activation:o[r],count:t.length,elements:t,offset:0})]:[Cn({},e,{markerTexture:this.markerTextures[r],activation:o[r],offset:0})];var s=[],u=i.range(n,{lod:!0,px:[(n[2]-n[0])/a.width,(n[3]-n[1])/a.height]});if(t){for(var v=o[r],d=v.data,c=new Uint8Array(l),p=0;p<t.length;p++){var O=t[p];c[O]=d?d[O]:1}f.subdata(c)}for(var g=u.length;g--;){var y=Vx(u[g],2),R=y[0],T=y[1];s.push(Cn({},e,{markerTexture:this.markerTextures[r],activation:t?f:o[r],offset:R,count:T-R}))}return s};qr.prototype.update=function(){for(var r=this,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length){t.length===1&&Array.isArray(t[0])&&(t=t[0]);var i=this.groups,a=this.gl,o=this.regl,f=this.maxSize,l=this.maxColors,s=this.palette;this.groups=i=t.map(function(u,v){var d=i[v];if(u===void 0)return d;u===null?u={positions:null}:typeof u=="function"?u={ondraw:u}:typeof u[0]=="number"&&(u={positions:u}),u=r1(u,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"}),u.positions===null&&(u.positions=[]),u.tooManyColors!=null&&(r.tooManyColors=u.tooManyColors),d||(i[v]=d={id:v,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:o.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:o.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:o.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:o.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:o.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},u=Cn({},qr.defaults,u)),u.positions&&!("marker"in u)&&(u.marker=d.marker,delete d.marker),u.marker&&!("positions"in u)&&(u.positions=d.positions,delete d.positions);var c=0,p=0;if(t1(d,u,[{snap:!0,size:function(K,se){return K==null&&(K=qr.defaults.size),c+=K&&K.length?1:0,K},borderSize:function(K,se){return K==null&&(K=qr.defaults.borderSize),c+=K&&K.length?1:0,K},opacity:parseFloat,color:function(K,se){return K==null&&(K=qr.defaults.color),K=r.updateColor(K),p++,K},borderColor:function(K,se){return K==null&&(K=qr.defaults.borderColor),K=r.updateColor(K),p++,K},bounds:function(K,se,Te){return"range"in Te||(Te.range=null),K},positions:function(K,se,Te){var ye=se.snap,Fe=se.positionBuffer,Qe=se.positionFractBuffer,qe=se.selectionBuffer;if(K.x||K.y)return K.x.length?se.xAttr={buffer:o.buffer(K.x),offset:0,stride:4,count:K.x.length}:se.xAttr={buffer:K.x.buffer,offset:K.x.offset*4||0,stride:(K.x.stride||1)*4,count:K.x.count},K.y.length?se.yAttr={buffer:o.buffer(K.y),offset:0,stride:4,count:K.y.length}:se.yAttr={buffer:K.y.buffer,offset:K.y.offset*4||0,stride:(K.y.stride||1)*4,count:K.y.count},se.count=Math.max(se.xAttr.count,se.yAttr.count),K;K=n1(K,"float64");var pe=se.count=Math.floor(K.length/2),Se=se.bounds=pe?Qx(K,2):null;if(!Te.range&&!se.range&&(delete se.range,Te.range=Se),!Te.marker&&!se.marker&&(delete se.marker,Te.marker=null),ye&&(ye===!0||pe>ye)?se.tree=e1(K,{bounds:Se}):ye&&ye.length&&(se.tree=ye),se.tree){var xe={primitive:"points",usage:"static",data:se.tree,type:"uint32"};se.elements?se.elements(xe):se.elements=o.elements(xe)}var je=Ni.float32(K);Fe({data:je,usage:"dynamic"});var tr=Ni.fract32(K,je);return Qe({data:tr,usage:"dynamic"}),qe({data:new Uint8Array(pe),type:"uint8",usage:"stream"}),K}},{marker:function(K,se,Te){var ye=se.activation;if(ye.forEach(function(tr){return tr&&tr.destroy&&tr.destroy()}),ye.length=0,!K||typeof K[0]=="number"){var Fe=r.addMarker(K);ye[Fe]=!0}else{for(var Qe=[],qe=0,pe=Math.min(K.length,se.count);qe<pe;qe++){var Se=r.addMarker(K[qe]);Qe[Se]||(Qe[Se]=new Uint8Array(se.count)),Qe[Se][qe]=1}for(var xe=0;xe<Qe.length;xe++)if(Qe[xe]){var je={data:Qe[xe],type:"uint8",usage:"static"};ye[xe]?ye[xe](je):ye[xe]=o.buffer(je),ye[xe].data=Qe[xe]}}return K},range:function(K,se,Te){var ye=se.bounds;if(ye)return K||(K=ye),se.scale=[1/(K[2]-K[0]),1/(K[3]-K[1])],se.translate=[-K[0],-K[1]],se.scaleFract=Ni.fract(se.scale),se.translateFract=Ni.fract(se.translate),K},viewport:function(K){var se=a1(K||[a.drawingBufferWidth,a.drawingBufferHeight]);return se}}]),c){var O=d,g=O.count,y=O.size,R=O.borderSize,T=O.sizeBuffer,M=new Uint8Array(g*2);if(y.length||R.length)for(var B=0;B<g;B++)M[B*2]=Math.round((y[B]==null?y:y[B])*255/f),M[B*2+1]=Math.round((R[B]==null?R:R[B])*255/f);T({data:M,usage:"dynamic"})}if(p){var V=d,I=V.count,F=V.color,j=V.borderColor,z=V.colorBuffer,q;if(r.tooManyColors){if(F.length||j.length){q=new Uint8Array(I*8);for(var C=0;C<I;C++){var G=F[C];q[C*8]=s[G*4],q[C*8+1]=s[G*4+1],q[C*8+2]=s[G*4+2],q[C*8+3]=s[G*4+3];var Q=j[C];q[C*8+4]=s[Q*4],q[C*8+5]=s[Q*4+1],q[C*8+6]=s[Q*4+2],q[C*8+7]=s[Q*4+3]}}}else if(F.length||j.length){q=new Uint8Array(I*4+2);for(var fe=0;fe<I;fe++)F[fe]!=null&&(q[fe*4]=F[fe]%l,q[fe*4+1]=Math.floor(F[fe]/l)),j[fe]!=null&&(q[fe*4+2]=j[fe]%l,q[fe*4+3]=Math.floor(j[fe]/l))}z({data:q||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return d})}};qr.prototype.addMarker=function(r){var e=this.markerTextures,t=this.regl,n=this.markerCache,i=r==null?0:n.indexOf(r);if(i>=0)return i;var a;if(r instanceof Uint8Array||r instanceof Uint8ClampedArray)a=r;else{a=new Uint8Array(r.length);for(var o=0,f=r.length;o<f;o++)a[o]=r[o]*255}var l=Math.floor(Math.sqrt(a.length));return i=e.length,n.push(r),e.push(t.texture({channels:1,data:a,radius:l,mag:"linear",min:"linear"})),i};qr.prototype.updateColor=function(r){var e=this.paletteIds,t=this.palette,n=this.maxColors;Array.isArray(r)||(r=[r]);var i=[];if(typeof r[0]=="number"){var a=[];if(Array.isArray(r))for(var o=0;o<r.length;o+=4)a.push(r.slice(o,o+4));else for(var f=0;f<r.length;f+=4)a.push(r.subarray(f,f+4));r=a}for(var l=0;l<r.length;l++){var s=r[l];s=Jx(s,"uint8");var u=Kx(s,!1);if(e[u]==null){var v=t.length;e[u]=Math.floor(v/4),t[v]=s[0],t[v+1]=s[1],t[v+2]=s[2],t[v+3]=s[3]}i[l]=e[u]}return!this.tooManyColors&&t.length>n*4&&(this.tooManyColors=!0),this.updatePalette(t),i.length===1?i[0]:i};qr.prototype.updatePalette=function(r){if(!this.tooManyColors){var e=this.maxColors,t=this.paletteTexture,n=Math.ceil(r.length*.25/e);if(n>1){r=r.slice();for(var i=r.length*.25%e;i<n*e;i++)r.push(0,0,0,0)}t.height<n&&t.resize(e,n),t.subimage({width:Math.min(r.length*.25,e),height:n,data:r},0,0)}};qr.prototype.destroy=function(){return this.groups.forEach(function(r){r.sizeBuffer.destroy(),r.positionBuffer.destroy(),r.positionFractBuffer.destroy(),r.colorBuffer.destroy(),r.activation.forEach(function(e){return e&&e.destroy&&e.destroy()}),r.selectionBuffer.destroy(),r.elements&&r.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(r){return r&&r.destroy&&r.destroy()}),this};var o1=ri,l1=function(e,t){var n=new i1(e,t),i=n.render.bind(n);return o1(i,{render:i,update:n.update.bind(n),draw:n.draw.bind(n),destroy:n.destroy.bind(n),regl:n.regl,gl:n.gl,canvas:n.gl.canvas,groups:n.groups,markers:n.markerCache,palette:n.palette}),i},f1=l1,Gs={exports:{}};Gs.exports=oo;Gs.exports.default=oo;function oo(r,e,t){t=t||2;var n=e&&e.length,i=n?e[0]*t:r.length,a=lp(r,0,i,t,!0),o=[];if(!a||a.next===a.prev)return o;var f,l,s,u,v,d,c;if(n&&(a=h1(r,e,a,t)),r.length>80*t){f=s=r[0],l=u=r[1];for(var p=t;p<i;p+=t)v=r[p],d=r[p+1],v<f&&(f=v),d<l&&(l=d),v>s&&(s=v),d>u&&(u=d);c=Math.max(s-f,u-l),c=c!==0?32767/c:0}return qa(a,o,t,f,l,c,0),o}function lp(r,e,t,n,i){var a,o;if(i===Es(r,e,t,n)>0)for(a=e;a<t;a+=n)o=fv(a,r[a],r[a+1],o);else for(a=t-n;a>=e;a-=n)o=fv(a,r[a],r[a+1],o);return o&&lo(o,o.next)&&(Wa(o),o=o.next),o}function On(r,e){if(!r)return r;e||(e=r);var t=r,n;do if(n=!1,!t.steiner&&(lo(t,t.next)||Or(t.prev,t,t.next)===0)){if(Wa(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function qa(r,e,t,n,i,a,o){if(r){!o&&a&&g1(r,n,i,a);for(var f=r,l,s;r.prev!==r.next;){if(l=r.prev,s=r.next,a?u1(r,n,i,a):s1(r)){e.push(l.i/t|0),e.push(r.i/t|0),e.push(s.i/t|0),Wa(r),r=s.next,f=s.next;continue}if(r=s,r===f){o?o===1?(r=c1(On(r),e,t),qa(r,e,t,n,i,a,2)):o===2&&v1(r,e,t,n,i,a):qa(On(r),e,t,n,i,a,1);break}}}}function s1(r){var e=r.prev,t=r,n=r.next;if(Or(e,t,n)>=0)return!1;for(var i=e.x,a=t.x,o=n.x,f=e.y,l=t.y,s=n.y,u=i<a?i<o?i:o:a<o?a:o,v=f<l?f<s?f:s:l<s?l:s,d=i>a?i>o?i:o:a>o?a:o,c=f>l?f>s?f:s:l>s?l:s,p=n.next;p!==e;){if(p.x>=u&&p.x<=d&&p.y>=v&&p.y<=c&&ha(i,f,a,l,o,s,p.x,p.y)&&Or(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function u1(r,e,t,n){var i=r.prev,a=r,o=r.next;if(Or(i,a,o)>=0)return!1;for(var f=i.x,l=a.x,s=o.x,u=i.y,v=a.y,d=o.y,c=f<l?f<s?f:s:l<s?l:s,p=u<v?u<d?u:d:v<d?v:d,O=f>l?f>s?f:s:l>s?l:s,g=u>v?u>d?u:d:v>d?v:d,y=ws(c,p,e,t,n),R=ws(O,g,e,t,n),T=r.prevZ,M=r.nextZ;T&&T.z>=y&&M&&M.z<=R;){if(T.x>=c&&T.x<=O&&T.y>=p&&T.y<=g&&T!==i&&T!==o&&ha(f,u,l,v,s,d,T.x,T.y)&&Or(T.prev,T,T.next)>=0||(T=T.prevZ,M.x>=c&&M.x<=O&&M.y>=p&&M.y<=g&&M!==i&&M!==o&&ha(f,u,l,v,s,d,M.x,M.y)&&Or(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;T&&T.z>=y;){if(T.x>=c&&T.x<=O&&T.y>=p&&T.y<=g&&T!==i&&T!==o&&ha(f,u,l,v,s,d,T.x,T.y)&&Or(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;M&&M.z<=R;){if(M.x>=c&&M.x<=O&&M.y>=p&&M.y<=g&&M!==i&&M!==o&&ha(f,u,l,v,s,d,M.x,M.y)&&Or(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function c1(r,e,t){var n=r;do{var i=n.prev,a=n.next.next;!lo(i,a)&&fp(i,n,n.next,a)&&Ha(i,a)&&Ha(a,i)&&(e.push(i.i/t|0),e.push(n.i/t|0),e.push(a.i/t|0),Wa(n),Wa(n.next),n=r=a),n=n.next}while(n!==r);return On(n)}function v1(r,e,t,n,i,a){var o=r;do{for(var f=o.next.next;f!==o.prev;){if(o.i!==f.i&&_1(o,f)){var l=sp(o,f);o=On(o,o.next),l=On(l,l.next),qa(o,e,t,n,i,a,0),qa(l,e,t,n,i,a,0);return}f=f.next}o=o.next}while(o!==r)}function h1(r,e,t,n){var i=[],a,o,f,l,s;for(a=0,o=e.length;a<o;a++)f=e[a]*n,l=a<o-1?e[a+1]*n:r.length,s=lp(r,f,l,n,!1),s===s.next&&(s.steiner=!0),i.push(b1(s));for(i.sort(d1),a=0;a<i.length;a++)t=p1(i[a],t);return t}function d1(r,e){return r.x-e.x}function p1(r,e){var t=y1(r,e);if(!t)return e;var n=sp(t,r);return On(n,n.next),On(t,t.next)}function y1(r,e){var t=e,n=r.x,i=r.y,a=-1/0,o;do{if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){var f=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(f<=n&&f>a&&(a=f,o=t.x<t.next.x?t:t.next,f===n))return o}t=t.next}while(t!==e);if(!o)return null;var l=o,s=o.x,u=o.y,v=1/0,d;t=o;do n>=t.x&&t.x>=s&&n!==t.x&&ha(i<u?n:a,i,s,u,i<u?a:n,i,t.x,t.y)&&(d=Math.abs(i-t.y)/(n-t.x),Ha(t,r)&&(d<v||d===v&&(t.x>o.x||t.x===o.x&&m1(o,t)))&&(o=t,v=d)),t=t.next;while(t!==l);return o}function m1(r,e){return Or(r.prev,r,e.prev)<0&&Or(e.next,r,r.next)<0}function g1(r,e,t,n){var i=r;do i.z===0&&(i.z=ws(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=null,i.prevZ=null,x1(i)}function x1(r){var e,t,n,i,a,o,f,l,s=1;do{for(t=r,r=null,a=null,o=0;t;){for(o++,n=t,f=0,e=0;e<s&&(f++,n=n.nextZ,!!n);e++);for(l=s;f>0||l>0&&n;)f!==0&&(l===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,f--):(i=n,n=n.nextZ,l--),a?a.nextZ=i:r=i,i.prevZ=a,a=i;t=n}a.nextZ=null,s*=2}while(o>1);return r}function ws(r,e,t,n,i){return r=(r-t)*i|0,e=(e-n)*i|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function b1(r){var e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function ha(r,e,t,n,i,a,o,f){return(i-o)*(e-f)>=(r-o)*(a-f)&&(r-o)*(n-f)>=(t-o)*(e-f)&&(t-o)*(a-f)>=(i-o)*(n-f)}function _1(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!A1(r,e)&&(Ha(r,e)&&Ha(e,r)&&w1(r,e)&&(Or(r.prev,r,e.prev)||Or(r,e.prev,e))||lo(r,e)&&Or(r.prev,r,r.next)>0&&Or(e.prev,e,e.next)>0)}function Or(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function lo(r,e){return r.x===e.x&&r.y===e.y}function fp(r,e,t,n){var i=Di(Or(r,e,t)),a=Di(Or(r,e,n)),o=Di(Or(t,n,r)),f=Di(Or(t,n,e));return!!(i!==a&&o!==f||i===0&&Bi(r,t,e)||a===0&&Bi(r,n,e)||o===0&&Bi(t,r,n)||f===0&&Bi(t,e,n))}function Bi(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function Di(r){return r>0?1:r<0?-1:0}function A1(r,e){var t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&fp(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function Ha(r,e){return Or(r.prev,r,r.next)<0?Or(r,e,r.next)>=0&&Or(r,r.prev,e)>=0:Or(r,e,r.prev)<0||Or(r,r.next,e)<0}function w1(r,e){var t=r,n=!1,i=(r.x+e.x)/2,a=(r.y+e.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&i<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==r);return n}function sp(r,e){var t=new Ts(r.i,r.x,r.y),n=new Ts(e.i,e.x,e.y),i=r.next,a=e.prev;return r.next=e,e.prev=r,t.next=i,i.prev=t,n.next=t,t.prev=n,a.next=n,n.prev=a,n}function fv(r,e,t,n){var i=new Ts(r,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Wa(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Ts(r,e,t){this.i=r,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}oo.deviation=function(r,e,t,n){var i=e&&e.length,a=i?e[0]*t:r.length,o=Math.abs(Es(r,0,a,t));if(i)for(var f=0,l=e.length;f<l;f++){var s=e[f]*t,u=f<l-1?e[f+1]*t:r.length;o-=Math.abs(Es(r,s,u,t))}var v=0;for(f=0;f<n.length;f+=3){var d=n[f]*t,c=n[f+1]*t,p=n[f+2]*t;v+=Math.abs((r[d]-r[p])*(r[c+1]-r[d+1])-(r[d]-r[c])*(r[p+1]-r[d+1]))}return o===0&&v===0?0:Math.abs((v-o)/o)};function Es(r,e,t,n){for(var i=0,a=e,o=t-n;a<t;a+=n)i+=(r[o]-r[a])*(r[a+1]+r[o+1]),o=a;return i}oo.flatten=function(r){for(var e=r[0][0].length,t={vertices:[],holes:[],dimensions:e},n=0,i=0;i<r.length;i++){for(var a=0;a<r[i].length;a++)for(var o=0;o<e;o++)t.vertices.push(r[i][a][o]);i>0&&(n+=r[i-1].length,t.holes.push(n))}return t};var T1=Gs.exports,E1=Qa,S1=C1;function C1(r,e,t){if(!r||r.length==null)throw Error("Argument should be an array");e==null&&(e=1),t==null&&(t=E1(r,e));for(var n=0;n<e;n++){var i=t[e+n],a=t[n],o=n,f=r.length;if(i===1/0&&a===-1/0)for(o=n;o<f;o+=e)r[o]=r[o]===i?1:r[o]===a?0:.5;else if(i===1/0)for(o=n;o<f;o+=e)r[o]=r[o]===i?1:0;else if(a===-1/0)for(o=n;o<f;o+=e)r[o]=r[o]===a?0:1;else{var l=i-a;for(o=n;o<f;o+=e)isNaN(r[o])||(r[o]=l===0?.5:(r[o]-a)/l)}}return r}var F1=function(){var r,e;if(typeof WeakMap!="function")return!1;try{r=new WeakMap([[e={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return!(String(r)!=="[object WeakMap]"||typeof r.set!="function"||r.set({},1)!==r||typeof r.delete!="function"||typeof r.has!="function"||r.get(e)!=="one")},Dl,sv;function O1(){return sv||(sv=1,Dl=function(){}),Dl}var kl,uv;function Mn(){if(uv)return kl;uv=1;var r=O1()();return kl=function(e){return e!==r&&e!==null},kl}var zl,cv;function up(){if(cv)return zl;cv=1;var r=Object.create,e=Object.getPrototypeOf,t={};return zl=function(){var n=Object.setPrototypeOf,i=arguments[0]||r;return typeof n!="function"?!1:e(n(i(null),t))===t},zl}var Pl,vv;function cp(){if(vv)return Pl;vv=1;var r=Mn(),e={function:!0,object:!0};return Pl=function(t){return r(t)&&e[typeof t]||!1},Pl}var Gl,hv;function pn(){if(hv)return Gl;hv=1;var r=Mn();return Gl=function(e){if(!r(e))throw new TypeError("Cannot use null or undefined");return e},Gl}var Ul,dv;function L1(){if(dv)return Ul;dv=1;var r=Object.create,e;return up()()||(e=vp()),Ul=function(){var t,n,i;return!e||e.level!==1?r:(t={},n={},i={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(a){if(a==="__proto__"){n[a]={configurable:!0,enumerable:!1,writable:!0,value:void 0};return}n[a]=i}),Object.defineProperties(t,n),Object.defineProperty(e,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:t}),function(a,o){return r(a===null?t:a,o)})}(),Ul}var $l,pv;function vp(){if(pv)return $l;pv=1;var r=cp(),e=pn(),t=Object.prototype.isPrototypeOf,n=Object.defineProperty,i={configurable:!0,enumerable:!1,writable:!0,value:void 0},a;return a=function(o,f){if(e(o),f===null||r(f))return o;throw new TypeError("Prototype must be null or an object")},$l=function(o){var f,l;return o?(o.level===2?o.set?(l=o.set,f=function(s,u){return l.call(a(s,u),u),s}):f=function(s,u){return a(s,u).__proto__=u,s}:f=function s(u,v){var d;return a(u,v),d=t.call(s.nullPolyfill,u),d&&delete s.nullPolyfill.__proto__,v===null&&(v=s.nullPolyfill),u.__proto__=v,d&&n(s.nullPolyfill,"__proto__",i),u},Object.defineProperty(f,"level",{configurable:!1,enumerable:!1,writable:!1,value:o.level})):null}(function(){var o=Object.create(null),f={},l,s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(s){try{l=s.set,l.call(o,f)}catch{}if(Object.getPrototypeOf(o)===f)return{set:l,level:2}}return o.__proto__=f,Object.getPrototypeOf(o)===f?{level:2}:(o={},o.__proto__=f,Object.getPrototypeOf(o)===f?{level:1}:!1)}()),L1(),$l}var jl,yv;function Us(){return yv||(yv=1,jl=up()()?Object.setPrototypeOf:vp()),jl}var Vl,mv;function R1(){if(mv)return Vl;mv=1;var r=cp();return Vl=function(e){if(!r(e))throw new TypeError(e+" is not an Object");return e},Vl}var ql,gv;function M1(){if(gv)return ql;gv=1;var r=Object.create(null),e=Math.random;return ql=function(){var t;do t=e().toString(36).slice(2);while(r[t]);return t},ql}var Hl={exports:{}},Wl,xv;function xa(){if(xv)return Wl;xv=1;var r=void 0;return Wl=function(e){return e!==r&&e!==null},Wl}var Xl,bv;function hp(){if(bv)return Xl;bv=1;var r=xa(),e={object:!0,function:!0,undefined:!0};return Xl=function(t){return r(t)?hasOwnProperty.call(e,typeof t):!1},Xl}var Yl,_v;function I1(){if(_v)return Yl;_v=1;var r=hp();return Yl=function(e){if(!r(e))return!1;try{return e.constructor?e.constructor.prototype===e:!1}catch{return!1}},Yl}var Zl,Av;function N1(){if(Av)return Zl;Av=1;var r=I1();return Zl=function(e){if(typeof e!="function"||!hasOwnProperty.call(e,"length"))return!1;try{if(typeof e.length!="number"||typeof e.call!="function"||typeof e.apply!="function")return!1}catch{return!1}return!r(e)},Zl}var Jl,wv;function dp(){if(wv)return Jl;wv=1;var r=N1(),e=/^\s*class[\s{/}]/,t=Function.prototype.toString;return Jl=function(n){return!(!r(n)||e.test(t.call(n)))},Jl}var Ql,Tv;function B1(){return Tv||(Tv=1,Ql=function(){var r=Object.assign,e;return typeof r!="function"?!1:(e={foo:"raz"},r(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}),Ql}var Kl,Ev;function D1(){return Ev||(Ev=1,Kl=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),Kl}var ef,Sv;function k1(){if(Sv)return ef;Sv=1;var r=Mn(),e=Object.keys;return ef=function(t){return e(r(t)?Object(t):t)},ef}var rf,Cv;function z1(){return Cv||(Cv=1,rf=D1()()?Object.keys:k1()),rf}var tf,Fv;function P1(){if(Fv)return tf;Fv=1;var r=z1(),e=pn(),t=Math.max;return tf=function(n,i){var a,o,f=t(arguments.length,2),l;for(n=Object(e(n)),l=function(s){try{n[s]=i[s]}catch(u){a||(a=u)}},o=1;o<f;++o)i=arguments[o],r(i).forEach(l);if(a!==void 0)throw a;return n},tf}var nf,Ov;function $s(){return Ov||(Ov=1,nf=B1()()?Object.assign:P1()),nf}var af,Lv;function pp(){if(Lv)return af;Lv=1;var r=Mn(),e=Array.prototype.forEach,t=Object.create,n=function(i,a){var o;for(o in i)a[o]=i[o]};return af=function(i){var a=t(null);return e.call(arguments,function(o){r(o)&&n(Object(o),a)}),a},af}var of,Rv;function G1(){if(Rv)return of;Rv=1;var r="razdwatrzy";return of=function(){return typeof r.contains!="function"?!1:r.contains("dwa")===!0&&r.contains("foo")===!1},of}var lf,Mv;function U1(){if(Mv)return lf;Mv=1;var r=String.prototype.indexOf;return lf=function(e){return r.call(this,e,arguments[1])>-1},lf}var ff,Iv;function yp(){return Iv||(Iv=1,ff=G1()()?String.prototype.contains:U1()),ff}var Nv;function yn(){if(Nv)return Hl.exports;Nv=1;var r=xa(),e=dp(),t=$s(),n=pp(),i=yp(),a=Hl.exports=function(o,f){var l,s,u,v,d;return arguments.length<2||typeof o!="string"?(v=f,f=o,o=null):v=arguments[2],r(o)?(l=i.call(o,"c"),s=i.call(o,"e"),u=i.call(o,"w")):(l=u=!0,s=!1),d={value:f,configurable:l,enumerable:s,writable:u},v?t(n(v),d):d};return a.gs=function(o,f,l){var s,u,v,d;return typeof o!="string"?(v=l,l=f,f=o,o=null):v=arguments[3],r(f)?e(f)?r(l)?e(l)||(v=l,l=void 0):l=void 0:(v=f,f=l=void 0):f=void 0,r(o)?(s=i.call(o,"c"),u=i.call(o,"e")):(s=!0,u=!1),d={get:f,set:l,configurable:s,enumerable:u},v?t(n(v),d):d},Hl.exports}var sf,Bv;function fo(){if(Bv)return sf;Bv=1;var r=Object.prototype.toString,e=r.call(function(){return arguments}());return sf=function(t){return r.call(t)===e},sf}var uf,Dv;function so(){if(Dv)return uf;Dv=1;var r=Object.prototype.toString,e=r.call("");return uf=function(t){return typeof t=="string"||t&&typeof t=="object"&&(t instanceof String||r.call(t)===e)||!1},uf}var cf={exports:{}},vf,kv;function $1(){return kv||(kv=1,vf=function(){return typeof globalThis!="object"||!globalThis?!1:globalThis.Array===Array}),vf}var hf,zv;function j1(){if(zv)return hf;zv=1;var r=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return hf=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}(),hf}var df,Pv;function uo(){return Pv||(Pv=1,df=$1()()?globalThis:j1()),df}var pf,Gv;function V1(){if(Gv)return pf;Gv=1;var r=uo(),e={object:!0,symbol:!0};return pf=function(){var t=r.Symbol,n;if(typeof t!="function")return!1;n=t("test symbol");try{String(n)}catch{return!1}return!(!e[typeof t.iterator]||!e[typeof t.toPrimitive]||!e[typeof t.toStringTag])},pf}var yf,Uv;function q1(){return Uv||(Uv=1,yf=function(r){return r?typeof r=="symbol"?!0:!r.constructor||r.constructor.name!=="Symbol"?!1:r[r.constructor.toStringTag]==="Symbol":!1}),yf}var mf,$v;function mp(){if($v)return mf;$v=1;var r=q1();return mf=function(e){if(!r(e))throw new TypeError(e+" is not a symbol");return e},mf}var gf,jv;function H1(){if(jv)return gf;jv=1;var r=yn(),e=Object.create,t=Object.defineProperty,n=Object.prototype,i=e(null);return gf=function(a){for(var o=0,f,l;i[a+(o||"")];)++o;return a+=o||"",i[a]=!0,f="@@"+a,t(n,f,r.gs(null,function(s){l||(l=!0,t(this,f,r(s)),l=!1)})),f},gf}var xf,Vv;function W1(){if(Vv)return xf;Vv=1;var r=yn(),e=uo().Symbol;return xf=function(t){return Object.defineProperties(t,{hasInstance:r("",e&&e.hasInstance||t("hasInstance")),isConcatSpreadable:r("",e&&e.isConcatSpreadable||t("isConcatSpreadable")),iterator:r("",e&&e.iterator||t("iterator")),match:r("",e&&e.match||t("match")),replace:r("",e&&e.replace||t("replace")),search:r("",e&&e.search||t("search")),species:r("",e&&e.species||t("species")),split:r("",e&&e.split||t("split")),toPrimitive:r("",e&&e.toPrimitive||t("toPrimitive")),toStringTag:r("",e&&e.toStringTag||t("toStringTag")),unscopables:r("",e&&e.unscopables||t("unscopables"))})},xf}var bf,qv;function X1(){if(qv)return bf;qv=1;var r=yn(),e=mp(),t=Object.create(null);return bf=function(n){return Object.defineProperties(n,{for:r(function(i){return t[i]?t[i]:t[i]=n(String(i))}),keyFor:r(function(i){var a;e(i);for(a in t)if(t[a]===i)return a})})},bf}var _f,Hv;function Y1(){if(Hv)return _f;Hv=1;var r=yn(),e=mp(),t=uo().Symbol,n=H1(),i=W1(),a=X1(),o=Object.create,f=Object.defineProperties,l=Object.defineProperty,s,u,v;if(typeof t=="function")try{String(t()),v=!0}catch{}else t=null;return u=function(c){if(this instanceof u)throw new TypeError("Symbol is not a constructor");return s(c)},_f=s=function d(c){var p;if(this instanceof d)throw new TypeError("Symbol is not a constructor");return v?t(c):(p=o(u.prototype),c=c===void 0?"":String(c),f(p,{__description__:r("",c),__name__:r("",n(c))}))},i(s),a(s),f(u.prototype,{constructor:r(s),toString:r("",function(){return this.__name__})}),f(s.prototype,{toString:r(function(){return"Symbol ("+e(this).__description__+")"}),valueOf:r(function(){return e(this)})}),l(s.prototype,s.toPrimitive,r("",function(){var d=e(this);return typeof d=="symbol"?d:d.toString()})),l(s.prototype,s.toStringTag,r("c","Symbol")),l(u.prototype,s.toStringTag,r("c",s.prototype[s.toStringTag])),l(u.prototype,s.toPrimitive,r("c",s.prototype[s.toPrimitive])),_f}var Af,Wv;function In(){return Wv||(Wv=1,Af=V1()()?uo().Symbol:Y1()),Af}var wf,Xv;function Z1(){if(Xv)return wf;Xv=1;var r=pn();return wf=function(){return r(this).length=0,this},wf}var Tf,Yv;function ti(){return Yv||(Yv=1,Tf=function(r){if(typeof r!="function")throw new TypeError(r+" is not a function");return r}),Tf}var Ef,Zv;function J1(){if(Zv)return Ef;Zv=1;var r=xa(),e=hp(),t=Object.prototype.toString;return Ef=function(n){if(!r(n))return null;if(e(n)){var i=n.toString;if(typeof i!="function"||i===t)return null}try{return""+n}catch{return null}},Ef}var Sf,Jv;function Q1(){return Jv||(Jv=1,Sf=function(r){try{return r.toString()}catch{try{return String(r)}catch{return null}}}),Sf}var Cf,Qv;function K1(){if(Qv)return Cf;Qv=1;var r=Q1(),e=/[\n\r\u2028\u2029]/g;return Cf=function(t){var n=r(t);return n===null?"<Non-coercible to string value>":(n.length>100&&(n=n.slice(0,99)+""),n=n.replace(e,function(i){switch(i){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}),n)},Cf}var Ff,Kv;function eb(){if(Kv)return Ff;Kv=1;var r=J1(),e=K1();return Ff=function(t,n,i){i&&i.errorMessage&&(t=r(i.errorMessage));var a=t.indexOf("%v"),o=a>-1?e(n):null;if(i&&i.name){var f=t.indexOf("%n");if(f>-1){if(a>-1){var l,s,u,v;return f>a?(l=o,u=a,s=i.name,v=f):(l=i.name,u=f,s=o,v=a),t.slice(0,u)+l+t.slice(u+2,v)+s+t.slice(v+2)}return t.slice(0,f)+i.name+t.slice(f+2)}}return a>-1?t.slice(0,a)+o+t.slice(a+2):t},Ff}var Of,eh;function gp(){if(eh)return Of;eh=1;var r=xa(),e=eb();return Of=function(t,n,i){if(i&&!r(t)){if("default"in i)return i.default;if(i.isOptional)return null}var a=i&&i.Error||TypeError,o=new a(e(n,t,i));throw i&&i.errorCode&&(o.code=i.errorCode),o},Of}var Lf,rh;function rb(){if(rh)return Lf;rh=1;var r=gp(),e=xa();return Lf=function(t){if(e(t))return t;var n=arguments[1],i=n&&n.name?"Expected a value for %n, received %v":"Cannot use %v";return r(t,i,n)},Lf}var Rf,th;function tb(){if(th)return Rf;th=1;var r=gp(),e=dp();return Rf=function(t){if(e(t))return t;var n=arguments[1],i=n&&n.name?"Expected a plain function for %n, received %v":"%v is not a plain function";return r(t,i,n)},Rf}var Mf,nh;function nb(){return nh||(nh=1,Mf=function(){var r=Array.from,e,t;return typeof r!="function"?!1:(e=["raz","dwa"],t=r(e),!!(t&&t!==e&&t[1]==="dwa"))}),Mf}var If,ah;function ab(){if(ah)return If;ah=1;var r=Object.prototype.toString,e=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);return If=function(t){return typeof t=="function"&&e(r.call(t))},If}var Nf,ih;function ib(){return ih||(ih=1,Nf=function(){var r=Math.sign;return typeof r!="function"?!1:r(10)===1&&r(-20)===-1}),Nf}var Bf,oh;function ob(){return oh||(oh=1,Bf=function(r){return r=Number(r),isNaN(r)||r===0?r:r>0?1:-1}),Bf}var Df,lh;function lb(){return lh||(lh=1,Df=ib()()?Math.sign:ob()),Df}var kf,fh;function fb(){if(fh)return kf;fh=1;var r=lb(),e=Math.abs,t=Math.floor;return kf=function(n){return isNaN(n)?0:(n=Number(n),n===0||!isFinite(n)?n:r(n)*t(e(n)))},kf}var zf,sh;function sb(){if(sh)return zf;sh=1;var r=fb(),e=Math.max;return zf=function(t){return e(0,r(t))},zf}var Pf,uh;function ub(){if(uh)return Pf;uh=1;var r=In().iterator,e=fo(),t=ab(),n=sb(),i=ti(),a=pn(),o=Mn(),f=so(),l=Array.isArray,s=Function.prototype.call,u={configurable:!0,enumerable:!0,writable:!0,value:null},v=Object.defineProperty;return Pf=function(d){var c=arguments[1],p=arguments[2],O,g,y,R,T,M,B,V,I,F;if(d=Object(a(d)),o(c)&&i(c),!this||this===Array||!t(this)){if(!c){if(e(d))return T=d.length,T!==1?Array.apply(null,d):(R=new Array(1),R[0]=d[0],R);if(l(d)){for(R=new Array(T=d.length),g=0;g<T;++g)R[g]=d[g];return R}}R=[]}else O=this;if(!l(d)){if((I=d[r])!==void 0){for(B=i(I).call(d),O&&(R=new O),V=B.next(),g=0;!V.done;)F=c?s.call(c,p,V.value,g):V.value,O?(u.value=F,v(R,g,u)):R[g]=F,V=B.next(),++g;T=g}else if(f(d)){for(T=d.length,O&&(R=new O),g=0,y=0;g<T;++g)F=d[g],g+1<T&&(M=F.charCodeAt(0),M>=55296&&M<=56319&&(F+=d[++g])),F=c?s.call(c,p,F,y):F,O?(u.value=F,v(R,y,u)):R[y]=F,++y;T=y}}if(T===void 0)for(T=n(d.length),O&&(R=new O(T)),g=0;g<T;++g)F=c?s.call(c,p,d[g],g):d[g],O?(u.value=F,v(R,g,u)):R[g]=F;return O&&(u.value=null,R.length=T),R},Pf}var Gf,ch;function cb(){return ch||(ch=1,Gf=nb()()?Array.from:ub()),Gf}var Uf,vh;function vb(){if(vh)return Uf;vh=1;var r=cb(),e=$s(),t=pn();return Uf=function(n){var i=Object(t(n)),a=arguments[1],o=Object(arguments[2]);if(i!==n&&!a)return i;var f={};return a?r(a,function(l){(o.ensure||l in n)&&(f[l]=n[l])}):e(f,n),f},Uf}var $f,hh;function hb(){if(hh)return $f;hh=1;var r=ti(),e=pn(),t=Function.prototype.bind,n=Function.prototype.call,i=Object.keys,a=Object.prototype.propertyIsEnumerable;return $f=function(o,f){return function(l,s){var u,v=arguments[2],d=arguments[3];return l=Object(e(l)),r(s),u=i(l),d&&u.sort(typeof d=="function"?t.call(d,l):void 0),typeof o!="function"&&(o=u[o]),n.call(o,u,function(c,p){return a.call(l,c)?n.call(s,v,l[c],c,l,p):f})}},$f}var jf,dh;function db(){return dh||(dh=1,jf=hb()("forEach")),jf}var Vf,ph;function pb(){if(ph)return Vf;ph=1;var r=ti(),e=db(),t=Function.prototype.call;return Vf=function(n,i){var a={},o=arguments[2];return r(i),e(n,function(f,l,s,u){a[l]=t.call(i,o,f,l,s,u)}),a},Vf}var qf,yh;function yb(){if(yh)return qf;yh=1;var r=xa(),e=rb(),t=tb(),n=vb(),i=pp(),a=pb(),o=Function.prototype.bind,f=Object.defineProperty,l=Object.prototype.hasOwnProperty,s;return s=function(u,v,d){var c=e(v)&&t(v.value),p;return p=n(v),delete p.writable,delete p.value,p.get=function(){return!d.overwriteDefinition&&l.call(this,u)?c:(v.value=o.call(c,d.resolveContext?d.resolveContext(this):this),f(this,u,v),this[u])},p},qf=function(u){var v=i(arguments[1]);return r(v.resolveContext)&&t(v.resolveContext),a(u,function(d,c){return s(c,d,v)})},qf}var Hf,mh;function xp(){if(mh)return Hf;mh=1;var r=Z1(),e=$s(),t=ti(),n=pn(),i=yn(),a=yb(),o=In(),f=Object.defineProperty,l=Object.defineProperties,s;return Hf=s=function(u,v){if(!(this instanceof s))throw new TypeError("Constructor requires 'new'");l(this,{__list__:i("w",n(u)),__context__:i("w",v),__nextIndex__:i("w",0)}),v&&(t(v.on),v.on("_add",this._onAdd),v.on("_delete",this._onDelete),v.on("_clear",this._onClear))},delete s.prototype.constructor,l(s.prototype,e({_next:i(function(){var u;if(this.__list__){if(this.__redo__&&(u=this.__redo__.shift(),u!==void 0))return u;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:i(function(){return this._createResult(this._next())}),_createResult:i(function(u){return u===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(u)}}),_resolve:i(function(u){return this.__list__[u]}),_unBind:i(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:i(function(){return"[object "+(this[o.toStringTag]||"Object")+"]"})},a({_onAdd:i(function(u){if(!(u>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__){f(this,"__redo__",i("c",[u]));return}this.__redo__.forEach(function(v,d){v>=u&&(this.__redo__[d]=++v)},this),this.__redo__.push(u)}}),_onDelete:i(function(u){var v;u>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(v=this.__redo__.indexOf(u),v!==-1&&this.__redo__.splice(v,1),this.__redo__.forEach(function(d,c){d>u&&(this.__redo__[c]=--d)},this)))}),_onClear:i(function(){this.__redo__&&r.call(this.__redo__),this.__nextIndex__=0})}))),f(s.prototype,o.iterator,i(function(){return this})),Hf}var gh;function mb(){if(gh)return cf.exports;gh=1;var r=Us(),e=yp(),t=yn(),n=In(),i=xp(),a=Object.defineProperty,o;return o=cf.exports=function(f,l){if(!(this instanceof o))throw new TypeError("Constructor requires 'new'");i.call(this,f),l?e.call(l,"key+value")?l="key+value":e.call(l,"key")?l="key":l="value":l="value",a(this,"__kind__",t("",l))},r&&r(o,i),delete o.prototype.constructor,o.prototype=Object.create(i.prototype,{_resolve:t(function(f){return this.__kind__==="value"?this.__list__[f]:this.__kind__==="key+value"?[f,this.__list__[f]]:f})}),a(o.prototype,n.toStringTag,t("c","Array Iterator")),cf.exports}var Wf={exports:{}},xh;function gb(){if(xh)return Wf.exports;xh=1;var r=Us(),e=yn(),t=In(),n=xp(),i=Object.defineProperty,a;return a=Wf.exports=function(o){if(!(this instanceof a))throw new TypeError("Constructor requires 'new'");o=String(o),n.call(this,o),i(this,"__length__",e("",o.length))},r&&r(a,n),delete a.prototype.constructor,a.prototype=Object.create(n.prototype,{_next:e(function(){if(this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind()}}),_resolve:e(function(o){var f=this.__list__[o],l;return this.__nextIndex__===this.__length__?f:(l=f.charCodeAt(0),l>=55296&&l<=56319?f+this.__list__[this.__nextIndex__++]:f)})}),i(a.prototype,t.toStringTag,e("c","String Iterator")),Wf.exports}var Xf,bh;function xb(){if(bh)return Xf;bh=1;var r=fo(),e=Mn(),t=so(),n=In().iterator,i=Array.isArray;return Xf=function(a){return e(a)?i(a)||t(a)||r(a)?!0:typeof a[n]=="function":!1},Xf}var Yf,_h;function bb(){if(_h)return Yf;_h=1;var r=xb();return Yf=function(e){if(!r(e))throw new TypeError(e+" is not iterable");return e},Yf}var Zf,Ah;function bp(){if(Ah)return Zf;Ah=1;var r=fo(),e=so(),t=mb(),n=gb(),i=bb(),a=In().iterator;return Zf=function(o){return typeof i(o)[a]=="function"?o[a]():r(o)?new t(o):e(o)?new n(o):new t(o)},Zf}var Jf,wh;function _b(){if(wh)return Jf;wh=1;var r=fo(),e=ti(),t=so(),n=bp(),i=Array.isArray,a=Function.prototype.call,o=Array.prototype.some;return Jf=function(f,l){var s,u=arguments[2],v,d,c,p,O,g,y;if(i(f)||r(f)?s="array":t(f)?s="string":f=n(f),e(l),d=function(){c=!0},s==="array"){o.call(f,function(R){return a.call(l,u,R,d),c});return}if(s==="string"){for(O=f.length,p=0;p<O&&(g=f[p],p+1<O&&(y=g.charCodeAt(0),y>=55296&&y<=56319&&(g+=f[++p])),a.call(l,u,g,d),!c);++p);return}for(v=f.next();!v.done;){if(a.call(l,u,v.value,d),c)return;v=f.next()}},Jf}var Qf,Th;function Ab(){return Th||(Th=1,Qf=function(){return typeof WeakMap!="function"?!1:Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"}()),Qf}var Kf,Eh;function wb(){if(Eh)return Kf;Eh=1;var r=Mn(),e=Us(),t=R1(),n=pn(),i=M1(),a=yn(),o=bp(),f=_b(),l=In().toStringTag,s=Ab(),u=Array.isArray,v=Object.defineProperty,d=Object.prototype.hasOwnProperty,c=Object.getPrototypeOf,p;return Kf=p=function(){var O=arguments[0],g;if(!(this instanceof p))throw new TypeError("Constructor requires 'new'");return g=s&&e&&WeakMap!==p?e(new WeakMap,c(this)):this,r(O)&&(u(O)||(O=o(O))),v(g,"__weakMapData__",a("c","$weakMap$"+i())),O&&f(O,function(y){n(y),g.set(y[0],y[1])}),g},s&&(e&&e(p,WeakMap),p.prototype=Object.create(WeakMap.prototype,{constructor:a(p)})),Object.defineProperties(p.prototype,{delete:a(function(O){return d.call(t(O),this.__weakMapData__)?(delete O[this.__weakMapData__],!0):!1}),get:a(function(O){if(d.call(t(O),this.__weakMapData__))return O[this.__weakMapData__]}),has:a(function(O){return d.call(t(O),this.__weakMapData__)}),set:a(function(O,g){return v(t(O),this.__weakMapData__,a("c",g)),this}),toString:a(function(){return"[object WeakMap]"})}),v(p.prototype,l,a("c","WeakMap")),Kf}var _p=F1()?WeakMap:wb(),Tb=function(r,e,t){if(typeof Array.prototype.findIndex=="function")return r.findIndex(e,t);if(typeof e!="function")throw new TypeError("predicate must be a function");var n=Object(r),i=n.length;if(i===0)return-1;for(var a=0;a<i;a++)if(e.call(t,n[a],a,n))return a;return-1};const ki=Ya,Eb=Qa,Ss=ri,Sb=dn,Cb=Ka,Sh=T1,Fb=S1,{float32:Ob,fract32:es}=Ps,Lb=_p,Ch=ao,Rb=Tb,Mb=`
precision highp float;

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`,Ib=`
precision highp float;

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`,Nb=`
precision highp float;

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`,Bb=`
precision highp float;
varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`,Db=`
precision highp float;

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);


	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`,kb=`
precision highp float;

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`;var zb=mr;function mr(r,e){if(!(this instanceof mr))return new mr(r,e);if(typeof r=="function"?(e||(e={}),e.regl=r):e=r,e.length&&(e.positions=e),r=e.regl,!r.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=r._gl,this.regl=r,this.passes=[],this.shaders=mr.shaders.has(r)?mr.shaders.get(r):mr.shaders.set(r,mr.createShaders(r)).get(r),this.update(e)}mr.dashMult=2;mr.maxPatternLength=256;mr.precisionThreshold=3e6;mr.maxPoints=1e4;mr.maxLines=2048;mr.shaders=new Lb;mr.createShaders=function(r){let e=r.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),t={primitive:"triangle strip",instances:r.prop("count"),count:4,offset:0,uniforms:{miterMode:(o,f)=>f.join==="round"?2:1,miterLimit:r.prop("miterLimit"),scale:r.prop("scale"),scaleFract:r.prop("scaleFract"),translateFract:r.prop("translateFract"),translate:r.prop("translate"),thickness:r.prop("thickness"),dashTexture:r.prop("dashTexture"),opacity:r.prop("opacity"),pixelRatio:r.context("pixelRatio"),id:r.prop("id"),dashLength:r.prop("dashLength"),viewport:(o,f)=>[f.viewport.x,f.viewport.y,o.viewportWidth,o.viewportHeight],depth:r.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:(o,f)=>!f.overlay},stencil:{enable:!1},scissor:{enable:!0,box:r.prop("viewport")},viewport:r.prop("viewport")},n=r(Ss({vert:Mb,frag:Ib,attributes:{lineEnd:{buffer:e,divisor:0,stride:8,offset:0},lineTop:{buffer:e,divisor:0,stride:8,offset:4},aCoord:{buffer:r.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:r.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:r.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:r.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:r.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},t)),i;try{i=r(Ss({cull:{enable:!0,face:"back"},vert:Db,frag:kb,attributes:{lineEnd:{buffer:e,divisor:0,stride:8,offset:0},lineTop:{buffer:e,divisor:0,stride:8,offset:4},aColor:{buffer:r.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:r.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:r.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:r.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:r.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:r.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},t))}catch{i=n}return{fill:r({primitive:"triangle",elements:(o,f)=>f.triangles,offset:0,vert:Nb,frag:Bb,uniforms:{scale:r.prop("scale"),color:r.prop("fill"),scaleFract:r.prop("scaleFract"),translateFract:r.prop("translateFract"),translate:r.prop("translate"),opacity:r.prop("opacity"),pixelRatio:r.context("pixelRatio"),id:r.prop("id"),viewport:(o,f)=>[f.viewport.x,f.viewport.y,o.viewportWidth,o.viewportHeight]},attributes:{position:{buffer:r.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:r.prop("positionFractBuffer"),stride:8,offset:8}},blend:t.blend,depth:{enable:!1},scissor:t.scissor,stencil:t.stencil,viewport:t.viewport}),rect:n,miter:i}};mr.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null};mr.prototype.render=function(...r){r.length&&this.update(...r),this.draw()};mr.prototype.draw=function(...r){return(r.length?r:this.passes).forEach((e,t)=>{if(e&&Array.isArray(e))return this.draw(...e);typeof e=="number"&&(e=this.passes[e]),e&&e.count>1&&e.opacity&&(this.regl._refresh(),e.fill&&e.triangles&&e.triangles.length>2&&this.shaders.fill(e),e.thickness&&(e.scale[0]*e.viewport.width>mr.precisionThreshold||e.scale[1]*e.viewport.height>mr.precisionThreshold?this.shaders.rect(e):e.join==="rect"||!e.join&&(e.thickness<=2||e.count>=mr.maxPoints)?this.shaders.rect(e):this.shaders.miter(e)))}),this};mr.prototype.update=function(r){if(!r)return;r.length!=null?typeof r[0]=="number"&&(r=[{positions:r}]):Array.isArray(r)||(r=[r]);let{regl:e,gl:t}=this;if(r.forEach((i,a)=>{let o=this.passes[a];if(i!==void 0){if(i===null){this.passes[a]=null;return}if(typeof i[0]=="number"&&(i={positions:i}),i=Sb(i,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),o||(this.passes[a]=o={id:a,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:e.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:e.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:e.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:e.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},i=Ss({},mr.defaults,i)),i.thickness!=null&&(o.thickness=parseFloat(i.thickness)),i.opacity!=null&&(o.opacity=parseFloat(i.opacity)),i.miterLimit!=null&&(o.miterLimit=parseFloat(i.miterLimit)),i.overlay!=null&&(o.overlay=!!i.overlay,a<mr.maxLines&&(o.depth=2*(mr.maxLines-1-a%mr.maxLines)/mr.maxLines-1)),i.join!=null&&(o.join=i.join),i.hole!=null&&(o.hole=i.hole),i.fill!=null&&(o.fill=i.fill?ki(i.fill,"uint8"):null),i.viewport!=null&&(o.viewport=Ch(i.viewport)),o.viewport||(o.viewport=Ch([t.drawingBufferWidth,t.drawingBufferHeight])),i.close!=null&&(o.close=i.close),i.positions===null&&(i.positions=[]),i.positions){let s,u;if(i.positions.x&&i.positions.y){let p=i.positions.x,O=i.positions.y;u=o.count=Math.max(p.length,O.length),s=new Float64Array(u*2);for(let g=0;g<u;g++)s[g*2]=p[g],s[g*2+1]=O[g]}else s=Cb(i.positions,"float64"),u=o.count=Math.floor(s.length/2);let v=o.bounds=Eb(s,2);if(o.fill){let p=[],O={},g=0;for(let y=0,R=0,T=o.count;y<T;y++){let M=s[y*2],B=s[y*2+1];isNaN(M)||isNaN(B)||M==null||B==null?(M=s[g*2],B=s[g*2+1],O[y]=g):g=y,p[R++]=M,p[R++]=B}if(i.splitNull){o.count-1 in O||(O[o.count]=o.count-1);let y=Object.keys(O).map(Number).sort((B,V)=>B-V),R=[],T=0,M=o.hole!=null?o.hole[0]:null;if(M!=null){let B=Rb(y,V=>V>=M);y=y.slice(0,B),y.push(M)}for(let B=0;B<y.length;B++){let V=p.slice(T*2,y[B]*2).concat(M?p.slice(M*2):[]),I=(o.hole||[]).map(j=>j-M+(y[B]-T)),F=Sh(V,I);F=F.map(j=>j+T+(j+T<y[B]?0:M-y[B])),R.push(...F),T=y[B]+1}for(let B=0,V=R.length;B<V;B++)O[R[B]]!=null&&(R[B]=O[R[B]]);o.triangles=R}else{let y=Sh(p,o.hole||[]);for(let R=0,T=y.length;R<T;R++)O[y[R]]!=null&&(y[R]=O[y[R]]);o.triangles=y}}let d=new Float64Array(s);Fb(d,2,v);let c=new Float64Array(u*2+6);o.close?s[0]===s[u*2-2]&&s[1]===s[u*2-1]?(c[0]=d[u*2-4],c[1]=d[u*2-3]):(c[0]=d[u*2-2],c[1]=d[u*2-1]):(c[0]=d[0],c[1]=d[1]),c.set(d,2),o.close?s[0]===s[u*2-2]&&s[1]===s[u*2-1]?(c[u*2+2]=d[2],c[u*2+3]=d[3],o.count-=1):(c[u*2+2]=d[0],c[u*2+3]=d[1],c[u*2+4]=d[2],c[u*2+5]=d[3]):(c[u*2+2]=d[u*2-2],c[u*2+3]=d[u*2-1],c[u*2+4]=d[u*2-2],c[u*2+5]=d[u*2-1]);var f=Ob(c);o.positionBuffer(f);var l=es(c,f);o.positionFractBuffer(l)}if(i.range?o.range=i.range:o.range||(o.range=o.bounds),(i.range||i.positions)&&o.count){let s=o.bounds,u=s[2]-s[0],v=s[3]-s[1],d=o.range[2]-o.range[0],c=o.range[3]-o.range[1];o.scale=[u/d,v/c],o.translate=[-o.range[0]/d+s[0]/d||0,-o.range[1]/c+s[1]/c||0],o.scaleFract=es(o.scale),o.translateFract=es(o.translate)}if(i.dashes){let s=0,u;if(!i.dashes||i.dashes.length<2)s=1,u=new Uint8Array([255,255,255,255,255,255,255,255]);else{s=0;for(let c=0;c<i.dashes.length;++c)s+=i.dashes[c];u=new Uint8Array(s*mr.dashMult);let v=0,d=255;for(let c=0;c<2;c++)for(let p=0;p<i.dashes.length;++p){for(let O=0,g=i.dashes[p]*mr.dashMult*.5;O<g;++O)u[v++]=d;d^=255}}o.dashLength=s,o.dashTexture({channels:1,data:u,width:u.length,height:1,mag:"linear",min:"linear"},0,0)}if(i.color){let s=o.count,u=i.color;u||(u="transparent");let v=new Uint8Array(s*4+4);if(!Array.isArray(u)||typeof u[0]=="number"){let d=ki(u,"uint8");for(let c=0;c<s+1;c++)v.set(d,c*4)}else{for(let d=0;d<s;d++){let c=ki(u[d],"uint8");v.set(c,d*4)}v.set(ki(u[0],"uint8"),s*4)}o.colorBuffer({usage:"dynamic",type:"uint8",data:v})}}}),r.length<this.passes.length){for(let i=r.length;i<this.passes.length;i++){let a=this.passes[i];a&&(a.colorBuffer.destroy(),a.positionBuffer.destroy(),a.dashTexture.destroy())}this.passes.length=r.length}let n=[];for(let i=0;i<this.passes.length;i++)this.passes[i]!==null&&n.push(this.passes[i]);return this.passes=n,this};mr.prototype.destroy=function(){return this.passes.forEach(r=>{r.colorBuffer.destroy(),r.positionBuffer.destroy(),r.dashTexture.destroy()}),this.passes.length=0,this};const Pb=Qa,Gb=Ya,Ub=ip,$b=dn,Fh=ri,Oh=Ka,{float32:jb,fract32:rs}=Ps;var Vb=qb;const Lh=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];function qb(r,e){if(typeof r=="function"?(e||(e={}),e.regl=r):e=r,e.length&&(e.positions=e),r=e.regl,!r.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");let t=r._gl,n,i,a,o,f,l,s={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},u=[];return o=r.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),i=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),a=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),f=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),l=r.buffer({usage:"static",type:"float",data:Lh}),p(e),n=r({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:r.prop("range"),lineWidth:r.prop("lineWidth"),capSize:r.prop("capSize"),opacity:r.prop("opacity"),scale:r.prop("scale"),translate:r.prop("translate"),scaleFract:r.prop("scaleFract"),translateFract:r.prop("translateFract"),viewport:(g,y)=>[y.viewport.x,y.viewport.y,g.viewportWidth,g.viewportHeight]},attributes:{color:{buffer:o,offset:(g,y)=>y.offset*4,divisor:1},position:{buffer:i,offset:(g,y)=>y.offset*8,divisor:1},positionFract:{buffer:a,offset:(g,y)=>y.offset*8,divisor:1},error:{buffer:f,offset:(g,y)=>y.offset*16,divisor:1},direction:{buffer:l,stride:24,offset:0},lineOffset:{buffer:l,stride:24,offset:8},capOffset:{buffer:l,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:r.prop("viewport")},viewport:r.prop("viewport"),stencil:!1,instances:r.prop("count"),count:Lh.length}),Fh(v,{update:p,draw:d,destroy:O,regl:r,gl:t,canvas:t.canvas,groups:u}),v;function v(g){g?p(g):g===null&&O(),d()}function d(g){if(typeof g=="number")return c(g);g&&!Array.isArray(g)&&(g=[g]),r._refresh(),u.forEach((y,R)=>{if(y){if(g&&(g[R]?y.draw=!0:y.draw=!1),!y.draw){y.draw=!0;return}c(R)}})}function c(g){typeof g=="number"&&(g=u[g]),g!=null&&g&&g.count&&g.color&&g.opacity&&g.positions&&g.positions.length>1&&(g.scaleRatio=[g.scale[0]*g.viewport.width,g.scale[1]*g.viewport.height],n(g),g.after&&g.after(g))}function p(g){if(!g)return;g.length!=null?typeof g[0]=="number"&&(g=[{positions:g}]):Array.isArray(g)||(g=[g]);let y=0,R=0;if(v.groups=u=g.map((B,V)=>{let I=u[V];if(B)typeof B=="function"?B={after:B}:typeof B[0]=="number"&&(B={positions:B});else return I;return B=$b(B,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),I||(u[V]=I={id:V,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},B=Fh({},s,B)),Ub(I,B,[{lineWidth:F=>+F*.5,capSize:F=>+F*.5,opacity:parseFloat,errors:F=>(F=Oh(F),R+=F.length,F),positions:(F,j)=>(F=Oh(F,"float64"),j.count=Math.floor(F.length/2),j.bounds=Pb(F,2),j.offset=y,y+=j.count,F)},{color:(F,j)=>{let z=j.count;if(F||(F="transparent"),!Array.isArray(F)||typeof F[0]=="number"){let C=F;F=Array(z);for(let G=0;G<z;G++)F[G]=C}if(F.length<z)throw Error("Not enough colors");let q=new Uint8Array(z*4);for(let C=0;C<z;C++){let G=Gb(F[C],"uint8");q.set(G,C*4)}return q},range:(F,j,z)=>{let q=j.bounds;return F||(F=q),j.scale=[1/(F[2]-F[0]),1/(F[3]-F[1])],j.translate=[-F[0],-F[1]],j.scaleFract=rs(j.scale),j.translateFract=rs(j.translate),F},viewport:F=>{let j;return Array.isArray(F)?j={x:F[0],y:F[1],width:F[2]-F[0],height:F[3]-F[1]}:F?(j={x:F.x||F.left||0,y:F.y||F.top||0},F.right?j.width=F.right-j.x:j.width=F.w||F.width||0,F.bottom?j.height=F.bottom-j.y:j.height=F.h||F.height||0):j={x:0,y:0,width:t.drawingBufferWidth,height:t.drawingBufferHeight},j}}]),I}),y||R){let B=u.reduce((j,z,q)=>j+(z?z.count:0),0),V=new Float64Array(B*2),I=new Uint8Array(B*4),F=new Float32Array(B*4);u.forEach((j,z)=>{if(!j)return;let{positions:q,count:C,offset:G,color:Q,errors:fe}=j;C&&(I.set(Q,G*4),F.set(fe,G*4),V.set(q,G*2))});var T=jb(V);i(T);var M=rs(V,T);a(M),o(I),f(F)}}function O(){i.destroy(),a.destroy(),o.destroy(),f.destroy(),l.destroy()}}var Rh=/[\'\"]/,Hb=function(e){return e?(Rh.test(e.charAt(0))&&(e=e.substr(1)),Rh.test(e.charAt(e.length-1))&&(e=e.substr(0,e.length-1)),e):""};const Ap=["inherit","initial","unset"],wp=["caption","icon","menu","message-box","small-caption","status-bar"],Tp=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"],Ep=["normal","italic","oblique"],Sp=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"];function Cp(r,e){if(typeof r!="string")return[r];var t=[r];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var n=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],i=e.escape||"___",a=!!e.flat;n.forEach(function(l){var s=new RegExp(["\\",l[0],"[^\\",l[0],"\\",l[1],"]*\\",l[1]].join("")),u=[];function v(d,c,p){var O=t.push(d.slice(l[0].length,-l[1].length))-1;return u.push(O),i+O+i}t.forEach(function(d,c){for(var p,O=0;d!=p;)if(p=d,d=d.replace(s,v),O++>1e4)throw Error("References have circular dependency. Please, check them.");t[c]=d}),u=u.reverse(),t=t.map(function(d){return u.forEach(function(c){d=d.replace(new RegExp("(\\"+i+c+"\\"+i+")","g"),l[0]+"$1"+l[1])}),d})});var o=new RegExp("\\"+i+"([0-9]+)\\"+i);function f(l,s,u){for(var v=[],d,c=0;d=o.exec(l);){if(c++>1e4)throw Error("Circular references in parenthesis");v.push(l.slice(0,d.index)),v.push(f(s[d[1]],s)),l=l.slice(d.index+d[0].length)}return v.push(l),v}return a?t:f(t[0],t)}function Fp(r,e){if(e&&e.flat){var t=e&&e.escape||"___",n=r[0],i;if(!n)return"";for(var a=new RegExp("\\"+t+"([0-9]+)\\"+t),o=0;n!=i;){if(o++>1e4)throw Error("Circular references in "+r);i=n,n=n.replace(a,f)}return n}return r.reduce(function l(s,u){return Array.isArray(u)&&(u=u.reduce(l,"")),s+u},"");function f(l,s){if(r[s]==null)throw Error("Reference "+s+"is undefined");return r[s]}}function js(r,e){return Array.isArray(r)?Fp(r,e):Cp(r,e)}js.parse=Cp;js.stringify=Fp;var Wb=js,Mh=Wb,Xb=function(e,t,n){if(e==null)throw Error("First argument should be a string");if(t==null)throw Error("Separator should be a string or a RegExp");n?(typeof n=="string"||Array.isArray(n))&&(n={ignore:n}):n={},n.escape==null&&(n.escape=!0),n.ignore==null?n.ignore=["[]","()","{}","<>",'""',"''","``","",""]:(typeof n.ignore=="string"&&(n.ignore=[n.ignore]),n.ignore=n.ignore.map(function(v){return v.length===1&&(v=v+v),v}));var i=Mh.parse(e,{flat:!0,brackets:n.ignore}),a=i[0],o=a.split(t);if(n.escape){for(var f=[],l=0;l<o.length;l++){var s=o[l],u=o[l+1];s[s.length-1]==="\\"&&s[s.length-2]!=="\\"?(f.push(s+t+u),l++):f.push(s)}o=f}for(var l=0;l<o.length;l++)i[0]=o[l],o[l]=Mh.stringify(i,{flat:!0});return o};const Yb=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"];var Zb=Yb,Op={isSize:function(e){return/^[\d\.]/.test(e)||e.indexOf("/")!==-1||Zb.indexOf(e)!==-1}},Jb=Hb,Qb=Ap,Kb=wp,e_=Tp,r_=Ep,t_=Sp,ts=Xb,n_=Op.isSize,a_=Lp,Da=Lp.cache={};function Lp(r){if(typeof r!="string")throw new Error("Font argument must be a string.");if(Da[r])return Da[r];if(r==="")throw new Error("Cannot parse an empty string.");if(Kb.indexOf(r)!==-1)return Da[r]={system:r};for(var e={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},t=ts(r,/\s+/),n;n=t.shift();){if(Qb.indexOf(n)!==-1)return["style","variant","weight","stretch"].forEach(function(a){e[a]=n}),Da[r]=e;if(r_.indexOf(n)!==-1){e.style=n;continue}if(n==="normal"||n==="small-caps"){e.variant=n;continue}if(t_.indexOf(n)!==-1){e.stretch=n;continue}if(e_.indexOf(n)!==-1){e.weight=n;continue}if(n_(n)){var i=ts(n,"/");if(e.size=i[0],i[1]!=null?e.lineHeight=Ih(i[1]):t[0]==="/"&&(t.shift(),e.lineHeight=Ih(t.shift())),!t.length)throw new Error("Missing required font-family.");return e.family=ts(t.join(" "),/\s*,\s*/).map(Jb),Da[r]=e}throw new Error("Unknown or unsupported font token: "+n)}throw new Error("Missing required font-size.")}function Ih(r){var e=parseFloat(r);return e.toString()===r?e:r}var i_=dn,o_=Op.isSize,l_=ni(Ap),f_=ni(wp),s_=ni(Tp),u_=ni(Ep),c_=ni(Sp),v_={normal:1,"small-caps":1},h_={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},ns={size:"1rem",family:"serif"},Rp=function(e){if(e=i_(e,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"}),e.system)return e.system&&ka(e.system,f_),e.system;if(ka(e.style,u_),ka(e.variant,v_),ka(e.weight,s_),ka(e.stretch,c_),e.size==null&&(e.size=ns.size),typeof e.size=="number"&&(e.size+="px"),!o_)throw Error("Bad size value `"+e.size+"`");e.family||(e.family=ns.family),Array.isArray(e.family)&&(e.family.length||(e.family=[ns.family]),e.family=e.family.map(function(n){return h_[n]?n:'"'+n+'"'}).join(", "));var t=[];return t.push(e.style),e.variant!==e.style&&t.push(e.variant),e.weight!==e.variant&&e.weight!==e.style&&t.push(e.weight),e.stretch!==e.weight&&e.stretch!==e.variant&&e.stretch!==e.style&&t.push(e.stretch),t.push(e.size+(e.lineHeight==null||e.lineHeight==="normal"||e.lineHeight+""=="1"?"":"/"+e.lineHeight)),t.push(e.family),t.filter(Boolean).join(" ")};function ka(r,e){if(r&&!e[r]&&!l_[r])throw Error("Unknown keyword `"+r+"`");return r}function ni(r){for(var e={},t=0;t<r.length;t++)e[r[t]]=1;return e}var d_={parse:a_,stringify:Rp},Mp={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(un,function(){var t=function(h,_){for(var E=Object.keys(_),Y=0;Y<E.length;++Y)h[E[Y]]=_[E[Y]];return h},n=0,i=0,a=5,o=6;function f(h,_){this.id=n++,this.type=h,this.data=_}function l(h){return h.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function s(h){if(h.length===0)return[];var _=h.charAt(0),E=h.charAt(h.length-1);if(h.length>1&&_===E&&(_==='"'||_==="'"))return['"'+l(h.substr(1,h.length-2))+'"'];var Y=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(h);if(Y)return s(h.substr(0,Y.index)).concat(s(Y[1])).concat(s(h.substr(Y.index+Y[0].length)));var le=h.split(".");if(le.length===1)return['"'+l(h)+'"'];for(var te=[],ee=0;ee<le.length;++ee)te=te.concat(s(le[ee]));return te}function u(h){return"["+s(h).join("][")+"]"}function v(h,_){return new f(h,u(_+""))}function d(h){return typeof h=="function"&&!h._reglType||h instanceof f}function c(h,_){if(typeof h=="function")return new f(i,h);if(typeof h=="number"||typeof h=="boolean")return new f(a,h);if(Array.isArray(h))return new f(o,h.map(function(E,Y){return c(E)}));if(h instanceof f)return h}var p={DynamicVariable:f,define:v,isDynamic:d,unbox:c,accessor:u},O={next:typeof requestAnimationFrame=="function"?function(h){return requestAnimationFrame(h)}:function(h){return setTimeout(h,16)},cancel:typeof cancelAnimationFrame=="function"?function(h){return cancelAnimationFrame(h)}:clearTimeout},g=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function y(){var h={"":0},_=[""];return{id:function(E){var Y=h[E];return Y||(Y=h[E]=_.length,_.push(E),Y)},str:function(E){return _[E]}}}function R(h,_,E){var Y=document.createElement("canvas");t(Y.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),h.appendChild(Y),h===document.body&&(Y.style.position="absolute",t(h.style,{margin:0,padding:0}));function le(){var ge=window.innerWidth,be=window.innerHeight;if(h!==document.body){var me=Y.getBoundingClientRect();ge=me.right-me.left,be=me.bottom-me.top}Y.width=E*ge,Y.height=E*be}var te;h!==document.body&&typeof ResizeObserver=="function"?(te=new ResizeObserver(function(){setTimeout(le)}),te.observe(h)):window.addEventListener("resize",le,!1);function ee(){te?te.disconnect():window.removeEventListener("resize",le),h.removeChild(Y)}return le(),{canvas:Y,onDestroy:ee}}function T(h,_){function E(Y){try{return h.getContext(Y,_)}catch{return null}}return E("webgl")||E("experimental-webgl")||E("webgl-experimental")}function M(h){return typeof h.nodeName=="string"&&typeof h.appendChild=="function"&&typeof h.getBoundingClientRect=="function"}function B(h){return typeof h.drawArrays=="function"||typeof h.drawElements=="function"}function V(h){return typeof h=="string"?h.split():h}function I(h){return typeof h=="string"?document.querySelector(h):h}function F(h){var _=h||{},E,Y,le,te,ee={},ge=[],be=[],me=typeof window>"u"?1:window.devicePixelRatio,Le=!1,Ze={},Pe=function(k){},_e=function(){};if(typeof _=="string"?E=document.querySelector(_):typeof _=="object"&&(M(_)?E=_:B(_)?(te=_,le=te.canvas):("gl"in _?te=_.gl:"canvas"in _?le=I(_.canvas):"container"in _&&(Y=I(_.container)),"attributes"in _&&(ee=_.attributes),"extensions"in _&&(ge=V(_.extensions)),"optionalExtensions"in _&&(be=V(_.optionalExtensions)),"onDone"in _&&(Pe=_.onDone),"profile"in _&&(Le=!!_.profile),"pixelRatio"in _&&(me=+_.pixelRatio),"cachedCode"in _&&(Ze=_.cachedCode))),E&&(E.nodeName.toLowerCase()==="canvas"?le=E:Y=E),!te){if(!le){var ce=R(Y||document.body,Pe,me);if(!ce)return null;le=ce.canvas,_e=ce.onDestroy}ee.premultipliedAlpha===void 0&&(ee.premultipliedAlpha=!0),te=T(le,ee)}return te?{gl:te,canvas:le,container:Y,extensions:ge,optionalExtensions:be,pixelRatio:me,profile:Le,cachedCode:Ze,onDone:Pe,onDestroy:_e}:(_e(),Pe("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function j(h,_){var E={};function Y(ee){var ge=ee.toLowerCase(),be;try{be=E[ge]=h.getExtension(ge)}catch{}return!!be}for(var le=0;le<_.extensions.length;++le){var te=_.extensions[le];if(!Y(te))return _.onDestroy(),_.onDone('"'+te+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return _.optionalExtensions.forEach(Y),{extensions:E,restore:function(){Object.keys(E).forEach(function(ee){if(E[ee]&&!Y(ee))throw new Error("(regl): error restoring extension "+ee)})}}}function z(h,_){for(var E=Array(h),Y=0;Y<h;++Y)E[Y]=_(Y);return E}var q=5120,C=5121,G=5122,Q=5123,fe=5124,ue=5125,K=5126;function se(h){for(var _=16;_<=1<<28;_*=16)if(h<=_)return _;return 0}function Te(h){var _,E;return _=(h>65535)<<4,h>>>=_,E=(h>255)<<3,h>>>=E,_|=E,E=(h>15)<<2,h>>>=E,_|=E,E=(h>3)<<1,h>>>=E,_|=E,_|h>>1}function ye(){var h=z(8,function(){return[]});function _(te){var ee=se(te),ge=h[Te(ee)>>2];return ge.length>0?ge.pop():new ArrayBuffer(ee)}function E(te){h[Te(te.byteLength)>>2].push(te)}function Y(te,ee){var ge=null;switch(te){case q:ge=new Int8Array(_(ee),0,ee);break;case C:ge=new Uint8Array(_(ee),0,ee);break;case G:ge=new Int16Array(_(2*ee),0,ee);break;case Q:ge=new Uint16Array(_(2*ee),0,ee);break;case fe:ge=new Int32Array(_(4*ee),0,ee);break;case ue:ge=new Uint32Array(_(4*ee),0,ee);break;case K:ge=new Float32Array(_(4*ee),0,ee);break;default:return null}return ge.length!==ee?ge.subarray(0,ee):ge}function le(te){E(te.buffer)}return{alloc:_,free:E,allocType:Y,freeType:le}}var Fe=ye();Fe.zero=ye();var Qe=3408,qe=3410,pe=3411,Se=3412,xe=3413,je=3414,tr=3415,He=33901,Je=33902,or=3379,ir=3386,Rr=34921,Sr=36347,Nr=36348,pr=35661,st=35660,cr=34930,Hr=36349,Wr=34076,It=34024,ut=7936,ct=7937,$r=7938,yt=35724,mt=34047,Et=36063,Jt=34852,St=3553,Nt=34067,$t=34069,rt=33984,Qt=6408,Nn=5126,Bn=5121,Dn=36160,yo=36053,mo=36064,go=16384,xo=function(h,_){var E=1;_.ext_texture_filter_anisotropic&&(E=h.getParameter(mt));var Y=1,le=1;_.webgl_draw_buffers&&(Y=h.getParameter(Jt),le=h.getParameter(Et));var te=!!_.oes_texture_float;if(te){var ee=h.createTexture();h.bindTexture(St,ee),h.texImage2D(St,0,Qt,1,1,0,Qt,Nn,null);var ge=h.createFramebuffer();if(h.bindFramebuffer(Dn,ge),h.framebufferTexture2D(Dn,mo,St,ee,0),h.bindTexture(St,null),h.checkFramebufferStatus(Dn)!==yo)te=!1;else{h.viewport(0,0,1,1),h.clearColor(1,0,0,1),h.clear(go);var be=Fe.allocType(Nn,4);h.readPixels(0,0,1,1,Qt,Nn,be),h.getError()?te=!1:(h.deleteFramebuffer(ge),h.deleteTexture(ee),te=be[0]===1),Fe.freeType(be)}}var me=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),Le=!0;if(!me){var Ze=h.createTexture(),Pe=Fe.allocType(Bn,36);h.activeTexture(rt),h.bindTexture(Nt,Ze),h.texImage2D($t,0,Qt,3,3,0,Qt,Bn,Pe),Fe.freeType(Pe),h.bindTexture(Nt,null),h.deleteTexture(Ze),Le=!h.getError()}return{colorBits:[h.getParameter(qe),h.getParameter(pe),h.getParameter(Se),h.getParameter(xe)],depthBits:h.getParameter(je),stencilBits:h.getParameter(tr),subpixelBits:h.getParameter(Qe),extensions:Object.keys(_).filter(function(_e){return!!_[_e]}),maxAnisotropic:E,maxDrawbuffers:Y,maxColorAttachments:le,pointSizeDims:h.getParameter(He),lineWidthDims:h.getParameter(Je),maxViewportDims:h.getParameter(ir),maxCombinedTextureUnits:h.getParameter(pr),maxCubeMapSize:h.getParameter(Wr),maxRenderbufferSize:h.getParameter(It),maxTextureUnits:h.getParameter(cr),maxTextureSize:h.getParameter(or),maxAttributes:h.getParameter(Rr),maxVertexUniforms:h.getParameter(Sr),maxVertexTextureUnits:h.getParameter(st),maxVaryingVectors:h.getParameter(Nr),maxFragmentUniforms:h.getParameter(Hr),glsl:h.getParameter(yt),renderer:h.getParameter(ct),vendor:h.getParameter(ut),version:h.getParameter($r),readFloat:te,npotTextureCube:Le}},Dr=function(h){return h instanceof Uint8Array||h instanceof Uint16Array||h instanceof Uint32Array||h instanceof Int8Array||h instanceof Int16Array||h instanceof Int32Array||h instanceof Float32Array||h instanceof Float64Array||h instanceof Uint8ClampedArray};function gt(h){return!!h&&typeof h=="object"&&Array.isArray(h.shape)&&Array.isArray(h.stride)&&typeof h.offset=="number"&&h.shape.length===h.stride.length&&(Array.isArray(h.data)||Dr(h.data))}var Zr=function(h){return Object.keys(h).map(function(_){return h[_]})},kn={shape:_o,flatten:bo};function ai(h,_,E){for(var Y=0;Y<_;++Y)E[Y]=h[Y]}function Kt(h,_,E,Y){for(var le=0,te=0;te<_;++te)for(var ee=h[te],ge=0;ge<E;++ge)Y[le++]=ee[ge]}function ii(h,_,E,Y,le,te){for(var ee=te,ge=0;ge<_;++ge)for(var be=h[ge],me=0;me<E;++me)for(var Le=be[me],Ze=0;Ze<Y;++Ze)le[ee++]=Le[Ze]}function oi(h,_,E,Y,le){for(var te=1,ee=E+1;ee<_.length;++ee)te*=_[ee];var ge=_[E];if(_.length-E===4){var be=_[E+1],me=_[E+2],Le=_[E+3];for(ee=0;ee<ge;++ee)ii(h[ee],be,me,Le,Y,le),le+=te}else for(ee=0;ee<ge;++ee)oi(h[ee],_,E+1,Y,le),le+=te}function bo(h,_,E,Y){var le=1;if(_.length)for(var te=0;te<_.length;++te)le*=_[te];else le=0;var ee=Y||Fe.allocType(E,le);switch(_.length){case 0:break;case 1:ai(h,_[0],ee);break;case 2:Kt(h,_[0],_[1],ee);break;case 3:ii(h,_[0],_[1],_[2],ee,0);break;default:oi(h,_,0,ee,0)}return ee}function _o(h){for(var _=[],E=h;E.length;E=E[0])_.push(E.length);return _}var Bt={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},jt=5120,_a=5122,Vt=5124,Aa=5121,Ct=5123,zn=5125,Pn=5126,wa=5126,mn={int8:jt,int16:_a,int32:Vt,uint8:Aa,uint16:Ct,uint32:zn,float:Pn,float32:wa},li=35048,Ta=35040,xt={dynamic:li,stream:Ta,static:35044},bt=kn.flatten,Ea=kn.shape,Dt=35044,qt=35040,gn=5121,xn=5126,vt=[];vt[5120]=1,vt[5122]=2,vt[5124]=4,vt[5121]=1,vt[5123]=2,vt[5125]=4,vt[5126]=4;function bn(h){return Bt[Object.prototype.toString.call(h)]|0}function Sa(h,_){for(var E=0;E<_.length;++E)h[E]=_[E]}function Ca(h,_,E,Y,le,te,ee){for(var ge=0,be=0;be<E;++be)for(var me=0;me<Y;++me)h[ge++]=_[le*be+te*me+ee]}function Ao(h,_,E,Y){var le=0,te={};function ee(k){this.id=le++,this.buffer=h.createBuffer(),this.type=k,this.usage=Dt,this.byteLength=0,this.dimension=1,this.dtype=gn,this.persistentData=null,E.profile&&(this.stats={size:0})}ee.prototype.bind=function(){h.bindBuffer(this.type,this.buffer)},ee.prototype.destroy=function(){Pe(this)};var ge=[];function be(k,J){var ve=ge.pop();return ve||(ve=new ee(k)),ve.bind(),Ze(ve,J,qt,0,1,!1),ve}function me(k){ge.push(k)}function Le(k,J,ve){k.byteLength=J.byteLength,h.bufferData(k.type,J,ve)}function Ze(k,J,ve,he,ae,Ce){var Ae;if(k.usage=ve,Array.isArray(J)){if(k.dtype=he||xn,J.length>0){var Ue;if(Array.isArray(J[0])){Ae=Ea(J);for(var ie=1,ne=1;ne<Ae.length;++ne)ie*=Ae[ne];k.dimension=ie,Ue=bt(J,Ae,k.dtype),Le(k,Ue,ve),Ce?k.persistentData=Ue:Fe.freeType(Ue)}else if(typeof J[0]=="number"){k.dimension=ae;var Oe=Fe.allocType(k.dtype,J.length);Sa(Oe,J),Le(k,Oe,ve),Ce?k.persistentData=Oe:Fe.freeType(Oe)}else Dr(J[0])&&(k.dimension=J[0].length,k.dtype=he||bn(J[0])||xn,Ue=bt(J,[J.length,J[0].length],k.dtype),Le(k,Ue,ve),Ce?k.persistentData=Ue:Fe.freeType(Ue))}}else if(Dr(J))k.dtype=he||bn(J),k.dimension=ae,Le(k,J,ve),Ce&&(k.persistentData=new Uint8Array(new Uint8Array(J.buffer)));else if(gt(J)){Ae=J.shape;var Z=J.stride,Ee=J.offset,de=0,$e=0,nr=0,Me=0;Ae.length===1?(de=Ae[0],$e=1,nr=Z[0],Me=0):Ae.length===2&&(de=Ae[0],$e=Ae[1],nr=Z[0],Me=Z[1]),k.dtype=he||bn(J.data)||xn,k.dimension=$e;var Ye=Fe.allocType(k.dtype,de*$e);Ca(Ye,J.data,de,$e,nr,Me,Ee),Le(k,Ye,ve),Ce?k.persistentData=Ye:Fe.freeType(Ye)}else J instanceof ArrayBuffer&&(k.dtype=gn,k.dimension=ae,Le(k,J,ve),Ce&&(k.persistentData=new Uint8Array(new Uint8Array(J))))}function Pe(k){_.bufferCount--,Y(k);var J=k.buffer;h.deleteBuffer(J),k.buffer=null,delete te[k.id]}function _e(k,J,ve,he){_.bufferCount++;var ae=new ee(J);te[ae.id]=ae;function Ce(ie){var ne=Dt,Oe=null,Z=0,Ee=0,de=1;return Array.isArray(ie)||Dr(ie)||gt(ie)||ie instanceof ArrayBuffer?Oe=ie:typeof ie=="number"?Z=ie|0:ie&&("data"in ie&&(Oe=ie.data),"usage"in ie&&(ne=xt[ie.usage]),"type"in ie&&(Ee=mn[ie.type]),"dimension"in ie&&(de=ie.dimension|0),"length"in ie&&(Z=ie.length|0)),ae.bind(),Oe?Ze(ae,Oe,ne,Ee,de,he):(Z&&h.bufferData(ae.type,Z,ne),ae.dtype=Ee||gn,ae.usage=ne,ae.dimension=de,ae.byteLength=Z),E.profile&&(ae.stats.size=ae.byteLength*vt[ae.dtype]),Ce}function Ae(ie,ne){h.bufferSubData(ae.type,ne,ie)}function Ue(ie,ne){var Oe=(ne||0)|0,Z;if(ae.bind(),Dr(ie)||ie instanceof ArrayBuffer)Ae(ie,Oe);else if(Array.isArray(ie)){if(ie.length>0){if(typeof ie[0]=="number"){var Ee=Fe.allocType(ae.dtype,ie.length);Sa(Ee,ie),Ae(Ee,Oe),Fe.freeType(Ee)}else if(Array.isArray(ie[0])||Dr(ie[0])){Z=Ea(ie);var de=bt(ie,Z,ae.dtype);Ae(de,Oe),Fe.freeType(de)}}}else if(gt(ie)){Z=ie.shape;var $e=ie.stride,nr=0,Me=0,Ye=0,we=0;Z.length===1?(nr=Z[0],Me=1,Ye=$e[0],we=0):Z.length===2&&(nr=Z[0],Me=Z[1],Ye=$e[0],we=$e[1]);var ar=Array.isArray(ie.data)?ae.dtype:bn(ie.data),fr=Fe.allocType(ar,nr*Me);Ca(fr,ie.data,nr,Me,Ye,we,ie.offset),Ae(fr,Oe),Fe.freeType(fr)}return Ce}return ve||Ce(k),Ce._reglType="buffer",Ce._buffer=ae,Ce.subdata=Ue,E.profile&&(Ce.stats=ae.stats),Ce.destroy=function(){Pe(ae)},Ce}function ce(){Zr(te).forEach(function(k){k.buffer=h.createBuffer(),h.bindBuffer(k.type,k.buffer),h.bufferData(k.type,k.persistentData||k.byteLength,k.usage)})}return E.profile&&(_.getTotalBufferSize=function(){var k=0;return Object.keys(te).forEach(function(J){k+=te[J].stats.size}),k}),{create:_e,createStream:be,destroyStream:me,clear:function(){Zr(te).forEach(Pe),ge.forEach(Pe)},getBuffer:function(k){return k&&k._buffer instanceof ee?k._buffer:null},restore:ce,_initBuffer:Ze}}var wo=0,To=0,gr=1,Ft=1,Er=4,Eo=4,tt={points:wo,point:To,lines:gr,line:Ft,triangles:Er,triangle:Eo,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},_n=0,Ht=1,_t=4,So=5120,en=5121,Ot=5122,Gn=5123,Ys=5124,Un=5125,Co=34963,h0=35040,d0=35044;function p0(h,_,E,Y){var le={},te=0,ee={uint8:en,uint16:Gn};_.oes_element_index_uint&&(ee.uint32=Un);function ge(ce){this.id=te++,le[this.id]=this,this.buffer=ce,this.primType=_t,this.vertCount=0,this.type=0}ge.prototype.bind=function(){this.buffer.bind()};var be=[];function me(ce){var k=be.pop();return k||(k=new ge(E.create(null,Co,!0,!1)._buffer)),Ze(k,ce,h0,-1,-1,0,0),k}function Le(ce){be.push(ce)}function Ze(ce,k,J,ve,he,ae,Ce){ce.buffer.bind();var Ae;if(k){var Ue=Ce;!Ce&&(!Dr(k)||gt(k)&&!Dr(k.data))&&(Ue=_.oes_element_index_uint?Un:Gn),E._initBuffer(ce.buffer,k,J,Ue,3)}else h.bufferData(Co,ae,J),ce.buffer.dtype=Ae||en,ce.buffer.usage=J,ce.buffer.dimension=3,ce.buffer.byteLength=ae;if(Ae=Ce,!Ce){switch(ce.buffer.dtype){case en:case So:Ae=en;break;case Gn:case Ot:Ae=Gn;break;case Un:case Ys:Ae=Un;break}ce.buffer.dtype=Ae}ce.type=Ae;var ie=he;ie<0&&(ie=ce.buffer.byteLength,Ae===Gn?ie>>=1:Ae===Un&&(ie>>=2)),ce.vertCount=ie;var ne=ve;if(ve<0){ne=_t;var Oe=ce.buffer.dimension;Oe===1&&(ne=_n),Oe===2&&(ne=Ht),Oe===3&&(ne=_t)}ce.primType=ne}function Pe(ce){Y.elementsCount--,delete le[ce.id],ce.buffer.destroy(),ce.buffer=null}function _e(ce,k){var J=E.create(null,Co,!0),ve=new ge(J._buffer);Y.elementsCount++;function he(ae){if(!ae)J(),ve.primType=_t,ve.vertCount=0,ve.type=en;else if(typeof ae=="number")J(ae),ve.primType=_t,ve.vertCount=ae|0,ve.type=en;else{var Ce=null,Ae=d0,Ue=-1,ie=-1,ne=0,Oe=0;Array.isArray(ae)||Dr(ae)||gt(ae)?Ce=ae:("data"in ae&&(Ce=ae.data),"usage"in ae&&(Ae=xt[ae.usage]),"primitive"in ae&&(Ue=tt[ae.primitive]),"count"in ae&&(ie=ae.count|0),"type"in ae&&(Oe=ee[ae.type]),"length"in ae?ne=ae.length|0:(ne=ie,Oe===Gn||Oe===Ot?ne*=2:(Oe===Un||Oe===Ys)&&(ne*=4))),Ze(ve,Ce,Ae,Ue,ie,ne,Oe)}return he}return he(ce),he._reglType="elements",he._elements=ve,he.subdata=function(ae,Ce){return J.subdata(ae,Ce),he},he.destroy=function(){Pe(ve)},he}return{create:_e,createStream:me,destroyStream:Le,getElements:function(ce){return typeof ce=="function"&&ce._elements instanceof ge?ce._elements:null},clear:function(){Zr(le).forEach(Pe)}}}var Zs=new Float32Array(1),y0=new Uint32Array(Zs.buffer),m0=5123;function Js(h){for(var _=Fe.allocType(m0,h.length),E=0;E<h.length;++E)if(isNaN(h[E]))_[E]=65535;else if(h[E]===1/0)_[E]=31744;else if(h[E]===-1/0)_[E]=64512;else{Zs[0]=h[E];var Y=y0[0],le=Y>>>31<<15,te=(Y<<1>>>24)-127,ee=Y>>13&1023;if(te<-24)_[E]=le;else if(te<-14){var ge=-14-te;_[E]=le+(ee+1024>>ge)}else te>15?_[E]=le+31744:_[E]=le+(te+15<<10)+ee}return _}function rn(h){return Array.isArray(h)||Dr(h)}var g0=34467,kt=3553,Fo=34067,fi=34069,An=6408,Oo=6406,si=6407,Fa=6409,ui=6410,Qs=32854,Lo=32855,Ks=36194,x0=32819,b0=32820,_0=33635,A0=34042,Ro=6402,ci=34041,Mo=35904,Io=35906,$n=36193,No=33776,Bo=33777,Do=33778,ko=33779,eu=35986,ru=35987,tu=34798,nu=35840,au=35841,iu=35842,ou=35843,lu=36196,jn=5121,zo=5123,Po=5125,Oa=5126,w0=10242,T0=10243,E0=10497,Go=33071,S0=33648,C0=10240,F0=10241,Uo=9728,O0=9729,$o=9984,fu=9985,su=9986,jo=9987,L0=33170,vi=4352,R0=4353,M0=4354,I0=34046,N0=3317,B0=37440,D0=37441,k0=37443,uu=37444,La=33984,z0=[$o,su,fu,jo],hi=[0,Fa,ui,si,An],Lt={};Lt[Fa]=Lt[Oo]=Lt[Ro]=1,Lt[ci]=Lt[ui]=2,Lt[si]=Lt[Mo]=3,Lt[An]=Lt[Io]=4;function Vn(h){return"[object "+h+"]"}var cu=Vn("HTMLCanvasElement"),vu=Vn("OffscreenCanvas"),hu=Vn("CanvasRenderingContext2D"),du=Vn("ImageBitmap"),pu=Vn("HTMLImageElement"),yu=Vn("HTMLVideoElement"),P0=Object.keys(Bt).concat([cu,vu,hu,du,pu,yu]),qn=[];qn[jn]=1,qn[Oa]=4,qn[$n]=2,qn[zo]=2,qn[Po]=4;var jr=[];jr[Qs]=2,jr[Lo]=2,jr[Ks]=2,jr[ci]=4,jr[No]=.5,jr[Bo]=.5,jr[Do]=1,jr[ko]=1,jr[eu]=.5,jr[ru]=1,jr[tu]=1,jr[nu]=.5,jr[au]=.25,jr[iu]=.5,jr[ou]=.25,jr[lu]=.5;function mu(h){return Array.isArray(h)&&(h.length===0||typeof h[0]=="number")}function gu(h){if(!Array.isArray(h))return!1;var _=h.length;return!(_===0||!rn(h[0]))}function wn(h){return Object.prototype.toString.call(h)}function xu(h){return wn(h)===cu}function bu(h){return wn(h)===vu}function G0(h){return wn(h)===hu}function U0(h){return wn(h)===du}function $0(h){return wn(h)===pu}function j0(h){return wn(h)===yu}function Vo(h){if(!h)return!1;var _=wn(h);return P0.indexOf(_)>=0?!0:mu(h)||gu(h)||gt(h)}function _u(h){return Bt[Object.prototype.toString.call(h)]|0}function V0(h,_){var E=_.length;switch(h.type){case jn:case zo:case Po:case Oa:var Y=Fe.allocType(h.type,E);Y.set(_),h.data=Y;break;case $n:h.data=Js(_);break}}function Au(h,_){return Fe.allocType(h.type===$n?Oa:h.type,_)}function wu(h,_){h.type===$n?(h.data=Js(_),Fe.freeType(_)):h.data=_}function q0(h,_,E,Y,le,te){for(var ee=h.width,ge=h.height,be=h.channels,me=ee*ge*be,Le=Au(h,me),Ze=0,Pe=0;Pe<ge;++Pe)for(var _e=0;_e<ee;++_e)for(var ce=0;ce<be;++ce)Le[Ze++]=_[E*_e+Y*Pe+le*ce+te];wu(h,Le)}function di(h,_,E,Y,le,te){var ee;if(typeof jr[h]<"u"?ee=jr[h]:ee=Lt[h]*qn[_],te&&(ee*=6),le){for(var ge=0,be=E;be>=1;)ge+=ee*be*be,be/=2;return ge}else return ee*E*Y}function H0(h,_,E,Y,le,te,ee){var ge={"don't care":vi,"dont care":vi,nice:M0,fast:R0},be={repeat:E0,clamp:Go,mirror:S0},me={nearest:Uo,linear:O0},Le=t({mipmap:jo,"nearest mipmap nearest":$o,"linear mipmap nearest":fu,"nearest mipmap linear":su,"linear mipmap linear":jo},me),Ze={none:0,browser:uu},Pe={uint8:jn,rgba4:x0,rgb565:_0,"rgb5 a1":b0},_e={alpha:Oo,luminance:Fa,"luminance alpha":ui,rgb:si,rgba:An,rgba4:Qs,"rgb5 a1":Lo,rgb565:Ks},ce={};_.ext_srgb&&(_e.srgb=Mo,_e.srgba=Io),_.oes_texture_float&&(Pe.float32=Pe.float=Oa),_.oes_texture_half_float&&(Pe.float16=Pe["half float"]=$n),_.webgl_depth_texture&&(t(_e,{depth:Ro,"depth stencil":ci}),t(Pe,{uint16:zo,uint32:Po,"depth stencil":A0})),_.webgl_compressed_texture_s3tc&&t(ce,{"rgb s3tc dxt1":No,"rgba s3tc dxt1":Bo,"rgba s3tc dxt3":Do,"rgba s3tc dxt5":ko}),_.webgl_compressed_texture_atc&&t(ce,{"rgb atc":eu,"rgba atc explicit alpha":ru,"rgba atc interpolated alpha":tu}),_.webgl_compressed_texture_pvrtc&&t(ce,{"rgb pvrtc 4bppv1":nu,"rgb pvrtc 2bppv1":au,"rgba pvrtc 4bppv1":iu,"rgba pvrtc 2bppv1":ou}),_.webgl_compressed_texture_etc1&&(ce["rgb etc1"]=lu);var k=Array.prototype.slice.call(h.getParameter(g0));Object.keys(ce).forEach(function(b){var W=ce[b];k.indexOf(W)>=0&&(_e[b]=W)});var J=Object.keys(_e);E.textureFormats=J;var ve=[];Object.keys(_e).forEach(function(b){var W=_e[b];ve[W]=b});var he=[];Object.keys(Pe).forEach(function(b){var W=Pe[b];he[W]=b});var ae=[];Object.keys(me).forEach(function(b){var W=me[b];ae[W]=b});var Ce=[];Object.keys(Le).forEach(function(b){var W=Le[b];Ce[W]=b});var Ae=[];Object.keys(be).forEach(function(b){var W=be[b];Ae[W]=b});var Ue=J.reduce(function(b,W){var H=_e[W];return H===Fa||H===Oo||H===Fa||H===ui||H===Ro||H===ci||_.ext_srgb&&(H===Mo||H===Io)?b[H]=H:H===Lo||W.indexOf("rgba")>=0?b[H]=An:b[H]=si,b},{});function ie(){this.internalformat=An,this.format=An,this.type=jn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=uu,this.width=0,this.height=0,this.channels=0}function ne(b,W){b.internalformat=W.internalformat,b.format=W.format,b.type=W.type,b.compressed=W.compressed,b.premultiplyAlpha=W.premultiplyAlpha,b.flipY=W.flipY,b.unpackAlignment=W.unpackAlignment,b.colorSpace=W.colorSpace,b.width=W.width,b.height=W.height,b.channels=W.channels}function Oe(b,W){if(!(typeof W!="object"||!W)){if("premultiplyAlpha"in W&&(b.premultiplyAlpha=W.premultiplyAlpha),"flipY"in W&&(b.flipY=W.flipY),"alignment"in W&&(b.unpackAlignment=W.alignment),"colorSpace"in W&&(b.colorSpace=Ze[W.colorSpace]),"type"in W){var H=W.type;b.type=Pe[H]}var Be=b.width,lr=b.height,_r=b.channels,De=!1;"shape"in W?(Be=W.shape[0],lr=W.shape[1],W.shape.length===3&&(_r=W.shape[2],De=!0)):("radius"in W&&(Be=lr=W.radius),"width"in W&&(Be=W.width),"height"in W&&(lr=W.height),"channels"in W&&(_r=W.channels,De=!0)),b.width=Be|0,b.height=lr|0,b.channels=_r|0;var m=!1;if("format"in W){var x=W.format,S=b.internalformat=_e[x];b.format=Ue[S],x in Pe&&("type"in W||(b.type=Pe[x])),x in ce&&(b.compressed=!0),m=!0}!De&&m?b.channels=Lt[b.format]:De&&!m&&b.channels!==hi[b.format]&&(b.format=b.internalformat=hi[b.channels])}}function Z(b){h.pixelStorei(B0,b.flipY),h.pixelStorei(D0,b.premultiplyAlpha),h.pixelStorei(k0,b.colorSpace),h.pixelStorei(N0,b.unpackAlignment)}function Ee(){ie.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function de(b,W){var H=null;if(Vo(W)?H=W:W&&(Oe(b,W),"x"in W&&(b.xOffset=W.x|0),"y"in W&&(b.yOffset=W.y|0),Vo(W.data)&&(H=W.data)),W.copy){var Be=le.viewportWidth,lr=le.viewportHeight;b.width=b.width||Be-b.xOffset,b.height=b.height||lr-b.yOffset,b.needsCopy=!0}else if(!H)b.width=b.width||1,b.height=b.height||1,b.channels=b.channels||4;else if(Dr(H))b.channels=b.channels||4,b.data=H,!("type"in W)&&b.type===jn&&(b.type=_u(H));else if(mu(H))b.channels=b.channels||4,V0(b,H),b.alignment=1,b.needsFree=!0;else if(gt(H)){var _r=H.data;!Array.isArray(_r)&&b.type===jn&&(b.type=_u(_r));var De=H.shape,m=H.stride,x,S,X,U,P,D;De.length===3?(X=De[2],D=m[2]):(X=1,D=1),x=De[0],S=De[1],U=m[0],P=m[1],b.alignment=1,b.width=x,b.height=S,b.channels=X,b.format=b.internalformat=hi[X],b.needsFree=!0,q0(b,_r,U,P,D,H.offset)}else if(xu(H)||bu(H)||G0(H))xu(H)||bu(H)?b.element=H:b.element=H.canvas,b.width=b.element.width,b.height=b.element.height,b.channels=4;else if(U0(H))b.element=H,b.width=H.width,b.height=H.height,b.channels=4;else if($0(H))b.element=H,b.width=H.naturalWidth,b.height=H.naturalHeight,b.channels=4;else if(j0(H))b.element=H,b.width=H.videoWidth,b.height=H.videoHeight,b.channels=4;else if(gu(H)){var N=b.width||H[0].length,w=b.height||H.length,L=b.channels;rn(H[0][0])?L=L||H[0][0].length:L=L||1;for(var A=kn.shape(H),$=1,re=0;re<A.length;++re)$*=A[re];var oe=Au(b,$);kn.flatten(H,A,"",oe),wu(b,oe),b.alignment=1,b.width=N,b.height=w,b.channels=L,b.format=b.internalformat=hi[L],b.needsFree=!0}b.type===Oa||b.type}function $e(b,W,H){var Be=b.element,lr=b.data,_r=b.internalformat,De=b.format,m=b.type,x=b.width,S=b.height;Z(b),Be?h.texImage2D(W,H,De,De,m,Be):b.compressed?h.compressedTexImage2D(W,H,_r,x,S,0,lr):b.needsCopy?(Y(),h.copyTexImage2D(W,H,De,b.xOffset,b.yOffset,x,S,0)):h.texImage2D(W,H,De,x,S,0,De,m,lr||null)}function nr(b,W,H,Be,lr){var _r=b.element,De=b.data,m=b.internalformat,x=b.format,S=b.type,X=b.width,U=b.height;Z(b),_r?h.texSubImage2D(W,lr,H,Be,x,S,_r):b.compressed?h.compressedTexSubImage2D(W,lr,H,Be,m,X,U,De):b.needsCopy?(Y(),h.copyTexSubImage2D(W,lr,H,Be,b.xOffset,b.yOffset,X,U)):h.texSubImage2D(W,lr,H,Be,X,U,x,S,De)}var Me=[];function Ye(){return Me.pop()||new Ee}function we(b){b.needsFree&&Fe.freeType(b.data),Ee.call(b),Me.push(b)}function ar(){ie.call(this),this.genMipmaps=!1,this.mipmapHint=vi,this.mipmask=0,this.images=Array(16)}function fr(b,W,H){var Be=b.images[0]=Ye();b.mipmask=1,Be.width=b.width=W,Be.height=b.height=H,Be.channels=b.channels=4}function vr(b,W){var H=null;if(Vo(W))H=b.images[0]=Ye(),ne(H,b),de(H,W),b.mipmask=1;else if(Oe(b,W),Array.isArray(W.mipmap))for(var Be=W.mipmap,lr=0;lr<Be.length;++lr)H=b.images[lr]=Ye(),ne(H,b),H.width>>=lr,H.height>>=lr,de(H,Be[lr]),b.mipmask|=1<<lr;else H=b.images[0]=Ye(),ne(H,b),de(H,W),b.mipmask=1;ne(b,b.images[0]),b.compressed&&(b.internalformat===No||b.internalformat===Bo||b.internalformat===Do||b.internalformat)}function kr(b,W){for(var H=b.images,Be=0;Be<H.length;++Be){if(!H[Be])return;$e(H[Be],W,Be)}}var sr=[];function at(){var b=sr.pop()||new ar;ie.call(b),b.mipmask=0;for(var W=0;W<16;++W)b.images[W]=null;return b}function xr(b){for(var W=b.images,H=0;H<W.length;++H)W[H]&&we(W[H]),W[H]=null;sr.push(b)}function Xr(){this.minFilter=Uo,this.magFilter=Uo,this.wrapS=Go,this.wrapT=Go,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=vi}function it(b,W){if("min"in W){var H=W.min;b.minFilter=Le[H],z0.indexOf(b.minFilter)>=0&&!("faces"in W)&&(b.genMipmaps=!0)}if("mag"in W){var Be=W.mag;b.magFilter=me[Be]}var lr=b.wrapS,_r=b.wrapT;if("wrap"in W){var De=W.wrap;typeof De=="string"?lr=_r=be[De]:Array.isArray(De)&&(lr=be[De[0]],_r=be[De[1]])}else{if("wrapS"in W){var m=W.wrapS;lr=be[m]}if("wrapT"in W){var x=W.wrapT;_r=be[x]}}if(b.wrapS=lr,b.wrapT=_r,"anisotropic"in W&&(W.anisotropic,b.anisotropic=W.anisotropic),"mipmap"in W){var S=!1;switch(typeof W.mipmap){case"string":b.mipmapHint=ge[W.mipmap],b.genMipmaps=!0,S=!0;break;case"boolean":S=b.genMipmaps=W.mipmap;break;case"object":b.genMipmaps=!1,S=!0;break}S&&!("min"in W)&&(b.minFilter=$o)}}function Jr(b,W){h.texParameteri(W,F0,b.minFilter),h.texParameteri(W,C0,b.magFilter),h.texParameteri(W,w0,b.wrapS),h.texParameteri(W,T0,b.wrapT),_.ext_texture_filter_anisotropic&&h.texParameteri(W,I0,b.anisotropic),b.genMipmaps&&(h.hint(L0,b.mipmapHint),h.generateMipmap(W))}var Mt=0,zr={},Pr=E.maxTextureUnits,er=Array(Pr).map(function(){return null});function ht(b){ie.call(this),this.mipmask=0,this.internalformat=An,this.id=Mt++,this.refCount=1,this.target=b,this.texture=h.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Xr,ee.profile&&(this.stats={size:0})}function yr(b){h.activeTexture(La),h.bindTexture(b.target,b.texture)}function Gr(){var b=er[0];b?h.bindTexture(b.target,b.texture):h.bindTexture(kt,null)}function Qr(b){var W=b.texture,H=b.unit,Be=b.target;H>=0&&(h.activeTexture(La+H),h.bindTexture(Be,null),er[H]=null),h.deleteTexture(W),b.texture=null,b.params=null,b.pixels=null,b.refCount=0,delete zr[b.id],te.textureCount--}t(ht.prototype,{bind:function(){var b=this;b.bindCount+=1;var W=b.unit;if(W<0){for(var H=0;H<Pr;++H){var Be=er[H];if(Be){if(Be.bindCount>0)continue;Be.unit=-1}er[H]=b,W=H;break}ee.profile&&te.maxTextureUnits<W+1&&(te.maxTextureUnits=W+1),b.unit=W,h.activeTexture(La+W),h.bindTexture(b.target,b.texture)}return W},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Qr(this)}});function Kr(b,W){var H=new ht(kt);zr[H.id]=H,te.textureCount++;function Be(De,m){var x=H.texInfo;Xr.call(x);var S=at();return typeof De=="number"?typeof m=="number"?fr(S,De|0,m|0):fr(S,De|0,De|0):De?(it(x,De),vr(S,De)):fr(S,1,1),x.genMipmaps&&(S.mipmask=(S.width<<1)-1),H.mipmask=S.mipmask,ne(H,S),H.internalformat=S.internalformat,Be.width=S.width,Be.height=S.height,yr(H),kr(S,kt),Jr(x,kt),Gr(),xr(S),ee.profile&&(H.stats.size=di(H.internalformat,H.type,S.width,S.height,x.genMipmaps,!1)),Be.format=ve[H.internalformat],Be.type=he[H.type],Be.mag=ae[x.magFilter],Be.min=Ce[x.minFilter],Be.wrapS=Ae[x.wrapS],Be.wrapT=Ae[x.wrapT],Be}function lr(De,m,x,S){var X=m|0,U=x|0,P=S|0,D=Ye();return ne(D,H),D.width=0,D.height=0,de(D,De),D.width=D.width||(H.width>>P)-X,D.height=D.height||(H.height>>P)-U,yr(H),nr(D,kt,X,U,P),Gr(),we(D),Be}function _r(De,m){var x=De|0,S=m|0||x;if(x===H.width&&S===H.height)return Be;Be.width=H.width=x,Be.height=H.height=S,yr(H);for(var X=0;H.mipmask>>X;++X){var U=x>>X,P=S>>X;if(!U||!P)break;h.texImage2D(kt,X,H.format,U,P,0,H.format,H.type,null)}return Gr(),ee.profile&&(H.stats.size=di(H.internalformat,H.type,x,S,!1,!1)),Be}return Be(b,W),Be.subimage=lr,Be.resize=_r,Be._reglType="texture2d",Be._texture=H,ee.profile&&(Be.stats=H.stats),Be.destroy=function(){H.decRef()},Be}function rr(b,W,H,Be,lr,_r){var De=new ht(Fo);zr[De.id]=De,te.cubeCount++;var m=new Array(6);function x(U,P,D,N,w,L){var A,$=De.texInfo;for(Xr.call($),A=0;A<6;++A)m[A]=at();if(typeof U=="number"||!U){var re=U|0||1;for(A=0;A<6;++A)fr(m[A],re,re)}else if(typeof U=="object")if(P)vr(m[0],U),vr(m[1],P),vr(m[2],D),vr(m[3],N),vr(m[4],w),vr(m[5],L);else if(it($,U),Oe(De,U),"faces"in U){var oe=U.faces;for(A=0;A<6;++A)ne(m[A],De),vr(m[A],oe[A])}else for(A=0;A<6;++A)vr(m[A],U);for(ne(De,m[0]),$.genMipmaps?De.mipmask=(m[0].width<<1)-1:De.mipmask=m[0].mipmask,De.internalformat=m[0].internalformat,x.width=m[0].width,x.height=m[0].height,yr(De),A=0;A<6;++A)kr(m[A],fi+A);for(Jr($,Fo),Gr(),ee.profile&&(De.stats.size=di(De.internalformat,De.type,x.width,x.height,$.genMipmaps,!0)),x.format=ve[De.internalformat],x.type=he[De.type],x.mag=ae[$.magFilter],x.min=Ce[$.minFilter],x.wrapS=Ae[$.wrapS],x.wrapT=Ae[$.wrapT],A=0;A<6;++A)xr(m[A]);return x}function S(U,P,D,N,w){var L=D|0,A=N|0,$=w|0,re=Ye();return ne(re,De),re.width=0,re.height=0,de(re,P),re.width=re.width||(De.width>>$)-L,re.height=re.height||(De.height>>$)-A,yr(De),nr(re,fi+U,L,A,$),Gr(),we(re),x}function X(U){var P=U|0;if(P!==De.width){x.width=De.width=P,x.height=De.height=P,yr(De);for(var D=0;D<6;++D)for(var N=0;De.mipmask>>N;++N)h.texImage2D(fi+D,N,De.format,P>>N,P>>N,0,De.format,De.type,null);return Gr(),ee.profile&&(De.stats.size=di(De.internalformat,De.type,x.width,x.height,!1,!0)),x}}return x(b,W,H,Be,lr,_r),x.subimage=S,x.resize=X,x._reglType="textureCube",x._texture=De,ee.profile&&(x.stats=De.stats),x.destroy=function(){De.decRef()},x}function ur(){for(var b=0;b<Pr;++b)h.activeTexture(La+b),h.bindTexture(kt,null),er[b]=null;Zr(zr).forEach(Qr),te.cubeCount=0,te.textureCount=0}ee.profile&&(te.getTotalTextureSize=function(){var b=0;return Object.keys(zr).forEach(function(W){b+=zr[W].stats.size}),b});function br(){for(var b=0;b<Pr;++b){var W=er[b];W&&(W.bindCount=0,W.unit=-1,er[b]=null)}Zr(zr).forEach(function(H){H.texture=h.createTexture(),h.bindTexture(H.target,H.texture);for(var Be=0;Be<32;++Be)if(H.mipmask&1<<Be)if(H.target===kt)h.texImage2D(kt,Be,H.internalformat,H.width>>Be,H.height>>Be,0,H.internalformat,H.type,null);else for(var lr=0;lr<6;++lr)h.texImage2D(fi+lr,Be,H.internalformat,H.width>>Be,H.height>>Be,0,H.internalformat,H.type,null);Jr(H.texInfo,H.target)})}function Ur(){for(var b=0;b<Pr;++b){var W=er[b];W&&(W.bindCount=0,W.unit=-1,er[b]=null),h.activeTexture(La+b),h.bindTexture(kt,null),h.bindTexture(Fo,null)}}return{create2D:Kr,createCube:rr,clear:ur,getTexture:function(b){return null},restore:br,refresh:Ur}}var tn=36161,pi=32854,Tu=32855,Eu=36194,Su=33189,Cu=36168,Fu=34041,Ou=35907,Lu=34836,Ru=34842,Mu=34843,Rt=[];Rt[pi]=2,Rt[Tu]=2,Rt[Eu]=2,Rt[Su]=2,Rt[Cu]=1,Rt[Fu]=4,Rt[Ou]=4,Rt[Lu]=16,Rt[Ru]=8,Rt[Mu]=6;function Iu(h,_,E){return Rt[h]*_*E}var W0=function(h,_,E,Y,le){var te={rgba4:pi,rgb565:Eu,"rgb5 a1":Tu,depth:Su,stencil:Cu,"depth stencil":Fu};_.ext_srgb&&(te.srgba=Ou),_.ext_color_buffer_half_float&&(te.rgba16f=Ru,te.rgb16f=Mu),_.webgl_color_buffer_float&&(te.rgba32f=Lu);var ee=[];Object.keys(te).forEach(function(_e){var ce=te[_e];ee[ce]=_e});var ge=0,be={};function me(_e){this.id=ge++,this.refCount=1,this.renderbuffer=_e,this.format=pi,this.width=0,this.height=0,le.profile&&(this.stats={size:0})}me.prototype.decRef=function(){--this.refCount<=0&&Le(this)};function Le(_e){var ce=_e.renderbuffer;h.bindRenderbuffer(tn,null),h.deleteRenderbuffer(ce),_e.renderbuffer=null,_e.refCount=0,delete be[_e.id],Y.renderbufferCount--}function Ze(_e,ce){var k=new me(h.createRenderbuffer());be[k.id]=k,Y.renderbufferCount++;function J(he,ae){var Ce=0,Ae=0,Ue=pi;if(typeof he=="object"&&he){var ie=he;if("shape"in ie){var ne=ie.shape;Ce=ne[0]|0,Ae=ne[1]|0}else"radius"in ie&&(Ce=Ae=ie.radius|0),"width"in ie&&(Ce=ie.width|0),"height"in ie&&(Ae=ie.height|0);"format"in ie&&(Ue=te[ie.format])}else typeof he=="number"?(Ce=he|0,typeof ae=="number"?Ae=ae|0:Ae=Ce):he||(Ce=Ae=1);if(!(Ce===k.width&&Ae===k.height&&Ue===k.format))return J.width=k.width=Ce,J.height=k.height=Ae,k.format=Ue,h.bindRenderbuffer(tn,k.renderbuffer),h.renderbufferStorage(tn,Ue,Ce,Ae),le.profile&&(k.stats.size=Iu(k.format,k.width,k.height)),J.format=ee[k.format],J}function ve(he,ae){var Ce=he|0,Ae=ae|0||Ce;return Ce===k.width&&Ae===k.height||(J.width=k.width=Ce,J.height=k.height=Ae,h.bindRenderbuffer(tn,k.renderbuffer),h.renderbufferStorage(tn,k.format,Ce,Ae),le.profile&&(k.stats.size=Iu(k.format,k.width,k.height))),J}return J(_e,ce),J.resize=ve,J._reglType="renderbuffer",J._renderbuffer=k,le.profile&&(J.stats=k.stats),J.destroy=function(){k.decRef()},J}le.profile&&(Y.getTotalRenderbufferSize=function(){var _e=0;return Object.keys(be).forEach(function(ce){_e+=be[ce].stats.size}),_e});function Pe(){Zr(be).forEach(function(_e){_e.renderbuffer=h.createRenderbuffer(),h.bindRenderbuffer(tn,_e.renderbuffer),h.renderbufferStorage(tn,_e.format,_e.width,_e.height)}),h.bindRenderbuffer(tn,null)}return{create:Ze,clear:function(){Zr(be).forEach(Le)},restore:Pe}},Wt=36160,qo=36161,Hn=3553,Nu=34069,Bu=36064,Du=36096,ku=36128,zu=33306,X0=36053,Y0=36193,Z0=5121,J0=5126,Q0=6407,K0=6408,Ho=[];Ho[K0]=4,Ho[Q0]=3;var yi=[];yi[Z0]=1,yi[J0]=4,yi[Y0]=2;function ey(h,_,E,Y,le,te){var ee={cur:null,next:null,dirty:!1,setFBO:null},ge=["rgba"],be=["rgba4","rgb565","rgb5 a1"];_.ext_srgb&&be.push("srgba"),_.ext_color_buffer_half_float&&be.push("rgba16f","rgb16f"),_.webgl_color_buffer_float&&be.push("rgba32f"),_.oes_texture_half_float,_.oes_texture_float;function me(Z,Ee,de){this.target=Z,this.texture=Ee,this.renderbuffer=de;var $e=0,nr=0;Ee?($e=Ee.width,nr=Ee.height):de&&($e=de.width,nr=de.height),this.width=$e,this.height=nr}function Le(Z){Z&&(Z.texture&&Z.texture._texture.decRef(),Z.renderbuffer&&Z.renderbuffer._renderbuffer.decRef())}function Ze(Z,Ee,de){if(Z)if(Z.texture){var $e=Z.texture._texture;Math.max(1,$e.width),Math.max(1,$e.height),$e.refCount+=1}else{var nr=Z.renderbuffer._renderbuffer;nr.refCount+=1}}function Pe(Z,Ee){Ee&&(Ee.texture?h.framebufferTexture2D(Wt,Z,Ee.target,Ee.texture._texture.texture,0):h.framebufferRenderbuffer(Wt,Z,qo,Ee.renderbuffer._renderbuffer.renderbuffer))}function _e(Z){var Ee=Hn,de=null,$e=null,nr=Z;typeof Z=="object"&&(nr=Z.data,"target"in Z&&(Ee=Z.target|0));var Me=nr._reglType;return Me==="texture2d"||Me==="textureCube"?de=nr:Me==="renderbuffer"&&($e=nr,Ee=qo),new me(Ee,de,$e)}function ce(Z,Ee,de,$e,nr){if(de){var Me=Y.create2D({width:Z,height:Ee,format:$e,type:nr});return Me._texture.refCount=0,new me(Hn,Me,null)}else{var Ye=le.create({width:Z,height:Ee,format:$e});return Ye._renderbuffer.refCount=0,new me(qo,null,Ye)}}function k(Z){return Z&&(Z.texture||Z.renderbuffer)}function J(Z,Ee,de){Z&&(Z.texture?Z.texture.resize(Ee,de):Z.renderbuffer&&Z.renderbuffer.resize(Ee,de),Z.width=Ee,Z.height=de)}var ve=0,he={};function ae(){this.id=ve++,he[this.id]=this,this.framebuffer=h.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Ce(Z){Z.colorAttachments.forEach(Le),Le(Z.depthAttachment),Le(Z.stencilAttachment),Le(Z.depthStencilAttachment)}function Ae(Z){var Ee=Z.framebuffer;h.deleteFramebuffer(Ee),Z.framebuffer=null,te.framebufferCount--,delete he[Z.id]}function Ue(Z){var Ee;h.bindFramebuffer(Wt,Z.framebuffer);var de=Z.colorAttachments;for(Ee=0;Ee<de.length;++Ee)Pe(Bu+Ee,de[Ee]);for(Ee=de.length;Ee<E.maxColorAttachments;++Ee)h.framebufferTexture2D(Wt,Bu+Ee,Hn,null,0);h.framebufferTexture2D(Wt,zu,Hn,null,0),h.framebufferTexture2D(Wt,Du,Hn,null,0),h.framebufferTexture2D(Wt,ku,Hn,null,0),Pe(Du,Z.depthAttachment),Pe(ku,Z.stencilAttachment),Pe(zu,Z.depthStencilAttachment);var $e=h.checkFramebufferStatus(Wt);h.isContextLost(),h.bindFramebuffer(Wt,ee.next?ee.next.framebuffer:null),ee.cur=ee.next,h.getError()}function ie(Z,Ee){var de=new ae;te.framebufferCount++;function $e(Me,Ye){var we,ar=0,fr=0,vr=!0,kr=!0,sr=null,at=!0,xr="rgba",Xr="uint8",it=1,Jr=null,Mt=null,zr=null,Pr=!1;if(typeof Me=="number")ar=Me|0,fr=Ye|0||ar;else if(!Me)ar=fr=1;else{var er=Me;if("shape"in er){var ht=er.shape;ar=ht[0],fr=ht[1]}else"radius"in er&&(ar=fr=er.radius),"width"in er&&(ar=er.width),"height"in er&&(fr=er.height);("color"in er||"colors"in er)&&(sr=er.color||er.colors),sr||("colorCount"in er&&(it=er.colorCount|0),"colorTexture"in er&&(at=!!er.colorTexture,xr="rgba4"),"colorType"in er&&(Xr=er.colorType,at||(Xr==="half float"||Xr==="float16"?xr="rgba16f":(Xr==="float"||Xr==="float32")&&(xr="rgba32f"))),"colorFormat"in er&&(xr=er.colorFormat,ge.indexOf(xr)>=0?at=!0:be.indexOf(xr)>=0&&(at=!1))),("depthTexture"in er||"depthStencilTexture"in er)&&(Pr=!!(er.depthTexture||er.depthStencilTexture)),"depth"in er&&(typeof er.depth=="boolean"?vr=er.depth:(Jr=er.depth,kr=!1)),"stencil"in er&&(typeof er.stencil=="boolean"?kr=er.stencil:(Mt=er.stencil,vr=!1)),"depthStencil"in er&&(typeof er.depthStencil=="boolean"?vr=kr=er.depthStencil:(zr=er.depthStencil,vr=!1,kr=!1))}var yr=null,Gr=null,Qr=null,Kr=null;if(Array.isArray(sr))yr=sr.map(_e);else if(sr)yr=[_e(sr)];else for(yr=new Array(it),we=0;we<it;++we)yr[we]=ce(ar,fr,at,xr,Xr);for(ar=ar||yr[0].width,fr=fr||yr[0].height,Jr?Gr=_e(Jr):vr&&!kr&&(Gr=ce(ar,fr,Pr,"depth","uint32")),Mt?Qr=_e(Mt):kr&&!vr&&(Qr=ce(ar,fr,!1,"stencil","uint8")),zr?Kr=_e(zr):!Jr&&!Mt&&kr&&vr&&(Kr=ce(ar,fr,Pr,"depth stencil","depth stencil")),we=0;we<yr.length;++we)Ze(yr[we]),yr[we]&&yr[we].texture&&Ho[yr[we].texture._texture.format]*yi[yr[we].texture._texture.type];return Ze(Gr),Ze(Qr),Ze(Kr),Ce(de),de.width=ar,de.height=fr,de.colorAttachments=yr,de.depthAttachment=Gr,de.stencilAttachment=Qr,de.depthStencilAttachment=Kr,$e.color=yr.map(k),$e.depth=k(Gr),$e.stencil=k(Qr),$e.depthStencil=k(Kr),$e.width=de.width,$e.height=de.height,Ue(de),$e}function nr(Me,Ye){var we=Math.max(Me|0,1),ar=Math.max(Ye|0||we,1);if(we===de.width&&ar===de.height)return $e;for(var fr=de.colorAttachments,vr=0;vr<fr.length;++vr)J(fr[vr],we,ar);return J(de.depthAttachment,we,ar),J(de.stencilAttachment,we,ar),J(de.depthStencilAttachment,we,ar),de.width=$e.width=we,de.height=$e.height=ar,Ue(de),$e}return $e(Z,Ee),t($e,{resize:nr,_reglType:"framebuffer",_framebuffer:de,destroy:function(){Ae(de),Ce(de)},use:function(Me){ee.setFBO({framebuffer:$e},Me)}})}function ne(Z){var Ee=Array(6);function de(nr){var Me,Ye={color:null},we=0,ar=null,fr="rgba",vr="uint8",kr=1;if(typeof nr=="number")we=nr|0;else if(!nr)we=1;else{var sr=nr;if("shape"in sr){var at=sr.shape;we=at[0]}else"radius"in sr&&(we=sr.radius|0),"width"in sr?we=sr.width|0:"height"in sr&&(we=sr.height|0);("color"in sr||"colors"in sr)&&(ar=sr.color||sr.colors),ar||("colorCount"in sr&&(kr=sr.colorCount|0),"colorType"in sr&&(vr=sr.colorType),"colorFormat"in sr&&(fr=sr.colorFormat)),"depth"in sr&&(Ye.depth=sr.depth),"stencil"in sr&&(Ye.stencil=sr.stencil),"depthStencil"in sr&&(Ye.depthStencil=sr.depthStencil)}var xr;if(ar)if(Array.isArray(ar))for(xr=[],Me=0;Me<ar.length;++Me)xr[Me]=ar[Me];else xr=[ar];else{xr=Array(kr);var Xr={radius:we,format:fr,type:vr};for(Me=0;Me<kr;++Me)xr[Me]=Y.createCube(Xr)}for(Ye.color=Array(xr.length),Me=0;Me<xr.length;++Me){var it=xr[Me];we=we||it.width,Ye.color[Me]={target:Nu,data:xr[Me]}}for(Me=0;Me<6;++Me){for(var Jr=0;Jr<xr.length;++Jr)Ye.color[Jr].target=Nu+Me;Me>0&&(Ye.depth=Ee[0].depth,Ye.stencil=Ee[0].stencil,Ye.depthStencil=Ee[0].depthStencil),Ee[Me]?Ee[Me](Ye):Ee[Me]=ie(Ye)}return t(de,{width:we,height:we,color:xr})}function $e(nr){var Me,Ye=nr|0;if(Ye===de.width)return de;var we=de.color;for(Me=0;Me<we.length;++Me)we[Me].resize(Ye);for(Me=0;Me<6;++Me)Ee[Me].resize(Ye);return de.width=de.height=Ye,de}return de(Z),t(de,{faces:Ee,resize:$e,_reglType:"framebufferCube",destroy:function(){Ee.forEach(function(nr){nr.destroy()})}})}function Oe(){ee.cur=null,ee.next=null,ee.dirty=!0,Zr(he).forEach(function(Z){Z.framebuffer=h.createFramebuffer(),Ue(Z)})}return t(ee,{getFramebuffer:function(Z){if(typeof Z=="function"&&Z._reglType==="framebuffer"){var Ee=Z._framebuffer;if(Ee instanceof ae)return Ee}return null},create:ie,createCube:ne,clear:function(){Zr(he).forEach(Ae)},restore:Oe})}var ry=5126,Pu=34962,mi=34963;function Wo(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ry,this.offset=0,this.stride=0,this.divisor=0}function ty(h,_,E,Y,le,te,ee){for(var ge=E.maxAttributes,be=new Array(ge),me=0;me<ge;++me)be[me]=new Wo;var Le=0,Ze={},Pe={Record:Wo,scope:{},state:be,currentVAO:null,targetVAO:null,restore:ce()?Ae:function(){},createVAO:Ue,getVAO:J,destroyBuffer:_e,setVAO:ce()?ve:he,clear:ce()?ae:function(){}};function _e(ie){for(var ne=0;ne<be.length;++ne){var Oe=be[ne];Oe.buffer===ie&&(h.disableVertexAttribArray(ne),Oe.buffer=null)}}function ce(){return _.oes_vertex_array_object}function k(){return _.angle_instanced_arrays}function J(ie){return typeof ie=="function"&&ie._vao?ie._vao:null}function ve(ie){if(ie!==Pe.currentVAO){var ne=ce();ie?ne.bindVertexArrayOES(ie.vao):ne.bindVertexArrayOES(null),Pe.currentVAO=ie}}function he(ie){if(ie!==Pe.currentVAO){if(ie)ie.bindAttrs();else{for(var ne=k(),Oe=0;Oe<be.length;++Oe){var Z=be[Oe];Z.buffer?(h.enableVertexAttribArray(Oe),Z.buffer.bind(),h.vertexAttribPointer(Oe,Z.size,Z.type,Z.normalized,Z.stride,Z.offfset),ne&&Z.divisor&&ne.vertexAttribDivisorANGLE(Oe,Z.divisor)):(h.disableVertexAttribArray(Oe),h.vertexAttrib4f(Oe,Z.x,Z.y,Z.z,Z.w))}ee.elements?h.bindBuffer(mi,ee.elements.buffer.buffer):h.bindBuffer(mi,null)}Pe.currentVAO=ie}}function ae(){Zr(Ze).forEach(function(ie){ie.destroy()})}function Ce(){this.id=++Le,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var ie=ce();ie?this.vao=ie.createVertexArrayOES():this.vao=null,Ze[this.id]=this,this.buffers=[]}Ce.prototype.bindAttrs=function(){for(var ie=k(),ne=this.attributes,Oe=0;Oe<ne.length;++Oe){var Z=ne[Oe];Z.buffer?(h.enableVertexAttribArray(Oe),h.bindBuffer(Pu,Z.buffer.buffer),h.vertexAttribPointer(Oe,Z.size,Z.type,Z.normalized,Z.stride,Z.offset),ie&&Z.divisor&&ie.vertexAttribDivisorANGLE(Oe,Z.divisor)):(h.disableVertexAttribArray(Oe),h.vertexAttrib4f(Oe,Z.x,Z.y,Z.z,Z.w))}for(var Ee=ne.length;Ee<ge;++Ee)h.disableVertexAttribArray(Ee);var de=te.getElements(this.elements);de?h.bindBuffer(mi,de.buffer.buffer):h.bindBuffer(mi,null)},Ce.prototype.refresh=function(){var ie=ce();ie&&(ie.bindVertexArrayOES(this.vao),this.bindAttrs(),Pe.currentVAO=null,ie.bindVertexArrayOES(null))},Ce.prototype.destroy=function(){if(this.vao){var ie=ce();this===Pe.currentVAO&&(Pe.currentVAO=null,ie.bindVertexArrayOES(null)),ie.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),Ze[this.id]&&(delete Ze[this.id],Y.vaoCount-=1)};function Ae(){var ie=ce();ie&&Zr(Ze).forEach(function(ne){ne.refresh()})}function Ue(ie){var ne=new Ce;Y.vaoCount+=1;function Oe(Z){var Ee;if(Array.isArray(Z))Ee=Z,ne.elements&&ne.ownsElements&&ne.elements.destroy(),ne.elements=null,ne.ownsElements=!1,ne.offset=0,ne.count=0,ne.instances=-1,ne.primitive=4;else{if(Z.elements){var de=Z.elements;ne.ownsElements?typeof de=="function"&&de._reglType==="elements"?(ne.elements.destroy(),ne.ownsElements=!1):(ne.elements(de),ne.ownsElements=!1):te.getElements(Z.elements)?(ne.elements=Z.elements,ne.ownsElements=!1):(ne.elements=te.create(Z.elements),ne.ownsElements=!0)}else ne.elements=null,ne.ownsElements=!1;Ee=Z.attributes,ne.offset=0,ne.count=-1,ne.instances=-1,ne.primitive=4,ne.elements&&(ne.count=ne.elements._elements.vertCount,ne.primitive=ne.elements._elements.primType),"offset"in Z&&(ne.offset=Z.offset|0),"count"in Z&&(ne.count=Z.count|0),"instances"in Z&&(ne.instances=Z.instances|0),"primitive"in Z&&(ne.primitive=tt[Z.primitive])}var $e={},nr=ne.attributes;nr.length=Ee.length;for(var Me=0;Me<Ee.length;++Me){var Ye=Ee[Me],we=nr[Me]=new Wo,ar=Ye.data||Ye;if(Array.isArray(ar)||Dr(ar)||gt(ar)){var fr;ne.buffers[Me]&&(fr=ne.buffers[Me],Dr(ar)&&fr._buffer.byteLength>=ar.byteLength?fr.subdata(ar):(fr.destroy(),ne.buffers[Me]=null)),ne.buffers[Me]||(fr=ne.buffers[Me]=le.create(Ye,Pu,!1,!0)),we.buffer=le.getBuffer(fr),we.size=we.buffer.dimension|0,we.normalized=!1,we.type=we.buffer.dtype,we.offset=0,we.stride=0,we.divisor=0,we.state=1,$e[Me]=1}else le.getBuffer(Ye)?(we.buffer=le.getBuffer(Ye),we.size=we.buffer.dimension|0,we.normalized=!1,we.type=we.buffer.dtype,we.offset=0,we.stride=0,we.divisor=0,we.state=1):le.getBuffer(Ye.buffer)?(we.buffer=le.getBuffer(Ye.buffer),we.size=(+Ye.size||we.buffer.dimension)|0,we.normalized=!!Ye.normalized||!1,"type"in Ye?we.type=mn[Ye.type]:we.type=we.buffer.dtype,we.offset=(Ye.offset||0)|0,we.stride=(Ye.stride||0)|0,we.divisor=(Ye.divisor||0)|0,we.state=1):"x"in Ye&&(we.x=+Ye.x||0,we.y=+Ye.y||0,we.z=+Ye.z||0,we.w=+Ye.w||0,we.state=2)}for(var vr=0;vr<ne.buffers.length;++vr)!$e[vr]&&ne.buffers[vr]&&(ne.buffers[vr].destroy(),ne.buffers[vr]=null);return ne.refresh(),Oe}return Oe.destroy=function(){for(var Z=0;Z<ne.buffers.length;++Z)ne.buffers[Z]&&ne.buffers[Z].destroy();ne.buffers.length=0,ne.ownsElements&&(ne.elements.destroy(),ne.elements=null,ne.ownsElements=!1),ne.destroy()},Oe._vao=ne,Oe._reglType="vao",Oe(ie)}return Pe}var Gu=35632,ny=35633,ay=35718,iy=35721;function oy(h,_,E,Y){var le={},te={};function ee(k,J,ve,he){this.name=k,this.id=J,this.location=ve,this.info=he}function ge(k,J){for(var ve=0;ve<k.length;++ve)if(k[ve].id===J.id){k[ve].location=J.location;return}k.push(J)}function be(k,J,ve){var he=k===Gu?le:te,ae=he[J];if(!ae){var Ce=_.str(J);ae=h.createShader(k),h.shaderSource(ae,Ce),h.compileShader(ae),he[J]=ae}return ae}var me={},Le=[],Ze=0;function Pe(k,J){this.id=Ze++,this.fragId=k,this.vertId=J,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Y.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function _e(k,J,ve){var he,ae,Ce=be(Gu,k.fragId),Ae=be(ny,k.vertId),Ue=k.program=h.createProgram();if(h.attachShader(Ue,Ce),h.attachShader(Ue,Ae),ve)for(he=0;he<ve.length;++he){var ie=ve[he];h.bindAttribLocation(Ue,ie[0],ie[1])}h.linkProgram(Ue);var ne=h.getProgramParameter(Ue,ay);Y.profile&&(k.stats.uniformsCount=ne);var Oe=k.uniforms;for(he=0;he<ne;++he)if(ae=h.getActiveUniform(Ue,he),ae)if(ae.size>1)for(var Z=0;Z<ae.size;++Z){var Ee=ae.name.replace("[0]","["+Z+"]");ge(Oe,new ee(Ee,_.id(Ee),h.getUniformLocation(Ue,Ee),ae))}else ge(Oe,new ee(ae.name,_.id(ae.name),h.getUniformLocation(Ue,ae.name),ae));var de=h.getProgramParameter(Ue,iy);Y.profile&&(k.stats.attributesCount=de);var $e=k.attributes;for(he=0;he<de;++he)ae=h.getActiveAttrib(Ue,he),ae&&ge($e,new ee(ae.name,_.id(ae.name),h.getAttribLocation(Ue,ae.name),ae))}Y.profile&&(E.getMaxUniformsCount=function(){var k=0;return Le.forEach(function(J){J.stats.uniformsCount>k&&(k=J.stats.uniformsCount)}),k},E.getMaxAttributesCount=function(){var k=0;return Le.forEach(function(J){J.stats.attributesCount>k&&(k=J.stats.attributesCount)}),k});function ce(){le={},te={};for(var k=0;k<Le.length;++k)_e(Le[k],null,Le[k].attributes.map(function(J){return[J.location,J.name]}))}return{clear:function(){var k=h.deleteShader.bind(h);Zr(le).forEach(k),le={},Zr(te).forEach(k),te={},Le.forEach(function(J){h.deleteProgram(J.program)}),Le.length=0,me={},E.shaderCount=0},program:function(k,J,ve,he){var ae=me[J];ae||(ae=me[J]={});var Ce=ae[k];if(Ce&&(Ce.refCount++,!he))return Ce;var Ae=new Pe(J,k);return E.shaderCount++,_e(Ae,ve,he),Ce||(ae[k]=Ae),Le.push(Ae),t(Ae,{destroy:function(){if(Ae.refCount--,Ae.refCount<=0){h.deleteProgram(Ae.program);var Ue=Le.indexOf(Ae);Le.splice(Ue,1),E.shaderCount--}ae[Ae.vertId].refCount<=0&&(h.deleteShader(te[Ae.vertId]),delete te[Ae.vertId],delete me[Ae.fragId][Ae.vertId]),Object.keys(me[Ae.fragId]).length||(h.deleteShader(le[Ae.fragId]),delete le[Ae.fragId],delete me[Ae.fragId])}})},restore:ce,shader:be,frag:-1,vert:-1}}var ly=6408,Uu=5121,fy=3333,sy=5126;function uy(h,_,E,Y,le,te,ee){function ge(Le){var Ze;_.next===null?Ze=Uu:Ze=_.next.colorAttachments[0].texture._texture.type;var Pe=0,_e=0,ce=Y.framebufferWidth,k=Y.framebufferHeight,J=null;Dr(Le)?J=Le:Le&&(Pe=Le.x|0,_e=Le.y|0,ce=(Le.width||Y.framebufferWidth-Pe)|0,k=(Le.height||Y.framebufferHeight-_e)|0,J=Le.data||null),E();var ve=ce*k*4;return J||(Ze===Uu?J=new Uint8Array(ve):Ze===sy&&(J=J||new Float32Array(ve))),h.pixelStorei(fy,4),h.readPixels(Pe,_e,ce,k,ly,Ze,J),J}function be(Le){var Ze;return _.setFBO({framebuffer:Le.framebuffer},function(){Ze=ge(Le)}),Ze}function me(Le){return!Le||!("framebuffer"in Le)?ge(Le):be(Le)}return me}function cy(h){return hy(vy(dy(h)))}function vy(h){return yy(Ty(py(h),h.length*8))}function hy(h){for(var _="0123456789abcdef",E="",Y,le=0;le<h.length;le++)Y=h.charCodeAt(le),E+=_.charAt(Y>>>4&15)+_.charAt(Y&15);return E}function dy(h){for(var _="",E=-1,Y,le;++E<h.length;)Y=h.charCodeAt(E),le=E+1<h.length?h.charCodeAt(E+1):0,55296<=Y&&Y<=56319&&56320<=le&&le<=57343&&(Y=65536+((Y&1023)<<10)+(le&1023),E++),Y<=127?_+=String.fromCharCode(Y):Y<=2047?_+=String.fromCharCode(192|Y>>>6&31,128|Y&63):Y<=65535?_+=String.fromCharCode(224|Y>>>12&15,128|Y>>>6&63,128|Y&63):Y<=2097151&&(_+=String.fromCharCode(240|Y>>>18&7,128|Y>>>12&63,128|Y>>>6&63,128|Y&63));return _}function py(h){for(var _=Array(h.length>>2),E=0;E<_.length;E++)_[E]=0;for(var E=0;E<h.length*8;E+=8)_[E>>5]|=(h.charCodeAt(E/8)&255)<<24-E%32;return _}function yy(h){for(var _="",E=0;E<h.length*32;E+=8)_+=String.fromCharCode(h[E>>5]>>>24-E%32&255);return _}function zt(h,_){return h>>>_|h<<32-_}function $u(h,_){return h>>>_}function my(h,_,E){return h&_^~h&E}function gy(h,_,E){return h&_^h&E^_&E}function xy(h){return zt(h,2)^zt(h,13)^zt(h,22)}function by(h){return zt(h,6)^zt(h,11)^zt(h,25)}function _y(h){return zt(h,7)^zt(h,18)^$u(h,3)}function Ay(h){return zt(h,17)^zt(h,19)^$u(h,10)}var wy=new Array(1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998);function Ty(h,_){var E=new Array(1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225),Y=new Array(64),le,te,ee,ge,be,me,Le,Ze,Pe,_e,ce,k;for(h[_>>5]|=128<<24-_%32,h[(_+64>>9<<4)+15]=_,Pe=0;Pe<h.length;Pe+=16){for(le=E[0],te=E[1],ee=E[2],ge=E[3],be=E[4],me=E[5],Le=E[6],Ze=E[7],_e=0;_e<64;_e++)_e<16?Y[_e]=h[_e+Pe]:Y[_e]=Vr(Vr(Vr(Ay(Y[_e-2]),Y[_e-7]),_y(Y[_e-15])),Y[_e-16]),ce=Vr(Vr(Vr(Vr(Ze,by(be)),my(be,me,Le)),wy[_e]),Y[_e]),k=Vr(xy(le),gy(le,te,ee)),Ze=Le,Le=me,me=be,be=Vr(ge,ce),ge=ee,ee=te,te=le,le=Vr(ce,k);E[0]=Vr(le,E[0]),E[1]=Vr(te,E[1]),E[2]=Vr(ee,E[2]),E[3]=Vr(ge,E[3]),E[4]=Vr(be,E[4]),E[5]=Vr(me,E[5]),E[6]=Vr(Le,E[6]),E[7]=Vr(Ze,E[7])}return E}function Vr(h,_){var E=(h&65535)+(_&65535),Y=(h>>16)+(_>>16)+(E>>16);return Y<<16|E&65535}function Wn(h){return Array.prototype.slice.call(h)}function Xn(h){return Wn(h).join("")}function Ey(h){var _=h&&h.cache,E=0,Y=[],le=[],te=[];function ee(ce,k){var J=k&&k.stable;if(!J){for(var ve=0;ve<le.length;++ve)if(le[ve]===ce&&!te[ve])return Y[ve]}var he="g"+E++;return Y.push(he),le.push(ce),te.push(J),he}function ge(){var ce=[];function k(){ce.push.apply(ce,Wn(arguments))}var J=[];function ve(){var he="v"+E++;return J.push(he),arguments.length>0&&(ce.push(he,"="),ce.push.apply(ce,Wn(arguments)),ce.push(";")),he}return t(k,{def:ve,toString:function(){return Xn([J.length>0?"var "+J.join(",")+";":"",Xn(ce)])}})}function be(){var ce=ge(),k=ge(),J=ce.toString,ve=k.toString;function he(ae,Ce){k(ae,Ce,"=",ce.def(ae,Ce),";")}return t(function(){ce.apply(ce,Wn(arguments))},{def:ce.def,entry:ce,exit:k,save:he,set:function(ae,Ce,Ae){he(ae,Ce),ce(ae,Ce,"=",Ae,";")},toString:function(){return J()+ve()}})}function me(){var ce=Xn(arguments),k=be(),J=be(),ve=k.toString,he=J.toString;return t(k,{then:function(){return k.apply(k,Wn(arguments)),this},else:function(){return J.apply(J,Wn(arguments)),this},toString:function(){var ae=he();return ae&&(ae="else{"+ae+"}"),Xn(["if(",ce,"){",ve(),"}",ae])}})}var Le=ge(),Ze={};function Pe(ce,k){var J=[];function ve(){var Ue="a"+J.length;return J.push(Ue),Ue}k=k||0;for(var he=0;he<k;++he)ve();var ae=be(),Ce=ae.toString,Ae=Ze[ce]=t(ae,{arg:ve,toString:function(){return Xn(["function(",J.join(),"){",Ce(),"}"])}});return Ae}function _e(){var ce=['"use strict";',Le,"return {"];Object.keys(Ze).forEach(function(he){ce.push('"',he,'":',Ze[he].toString(),",")}),ce.push("}");var k=Xn(ce).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),J;if(_&&(J=cy(k),_[J]))return _[J].apply(null,le);var ve=Function.apply(null,Y.concat(k));return _&&(_[J]=ve),ve.apply(null,le)}return{global:Le,link:ee,block:ge,proc:Pe,scope:be,cond:me,compile:_e}}var Yn="xyzw".split(""),ju=5121,Zn=1,Xo=2,Yo=0,Zo=1,Jo=2,Qo=3,gi=4,Vu=5,qu=6,Hu="dither",Wu="blend.enable",Xu="blend.color",Ko="blend.equation",el="blend.func",Yu="depth.enable",Zu="depth.func",Ju="depth.range",Qu="depth.mask",rl="colorMask",Ku="cull.enable",ec="cull.face",tl="frontFace",nl="lineWidth",rc="polygonOffset.enable",al="polygonOffset.offset",tc="sample.alpha",nc="sample.enable",il="sample.coverage",ac="stencil.enable",ic="stencil.mask",ol="stencil.func",ll="stencil.opFront",Ra="stencil.opBack",oc="scissor.enable",xi="scissor.box",Xt="viewport",bi="profile",Jn="framebuffer",_i="vert",Ai="frag",Qn="elements",Kn="primitive",ea="count",fl="offset",sl="instances",wi="vao",ul="Width",cl="Height",ra=Jn+ul,ta=Jn+cl,Sy=Xt+ul,Cy=Xt+cl,lc="drawingBuffer",fc=lc+ul,sc=lc+cl,Fy=[el,Ko,ol,ll,Ra,il,Xt,xi,al],na=34962,vl=34963,Oy=2884,Ly=3042,Ry=3024,My=2960,Iy=2929,Ny=3089,By=32823,Dy=32926,ky=32928,uc=5126,hl=35664,dl=35665,pl=35666,cc=5124,yl=35667,ml=35668,gl=35669,vc=35670,xl=35671,bl=35672,_l=35673,Al=35674,wl=35675,Tl=35676,El=35678,Sl=35680,Cl=4,Ma=1028,Tn=1029,hc=2304,Fl=2305,zy=32775,Py=32776,Gy=519,nn=7680,dc=0,pc=1,yc=32774,Uy=513,mc=36160,$y=36064,Ia={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ol={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ti={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},gc={cw:hc,ccw:Fl};function Ei(h){return Array.isArray(h)||Dr(h)||gt(h)}function xc(h){return h.sort(function(_,E){return _===Xt?-1:E===Xt?1:_<E?-1:1})}function Br(h,_,E,Y){this.thisDep=h,this.contextDep=_,this.propDep=E,this.append=Y}function Pt(h){return h&&!(h.thisDep||h.contextDep||h.propDep)}function Mr(h){return new Br(!1,!1,!1,h)}function nt(h,_){var E=h.type;if(E===Yo){var Y=h.data.length;return new Br(!0,Y>=1,Y>=2,_)}else if(E===gi){var le=h.data;return new Br(le.thisDep,le.contextDep,le.propDep,_)}else{if(E===Vu)return new Br(!1,!1,!1,_);if(E===qu){for(var te=!1,ee=!1,ge=!1,be=0;be<h.data.length;++be){var me=h.data[be];if(me.type===Zo)ge=!0;else if(me.type===Jo)ee=!0;else if(me.type===Qo)te=!0;else if(me.type===Yo){te=!0;var Le=me.data;Le>=1&&(ee=!0),Le>=2&&(ge=!0)}else me.type===gi&&(te=te||me.data.thisDep,ee=ee||me.data.contextDep,ge=ge||me.data.propDep)}return new Br(te,ee,ge,_)}else return new Br(E===Qo,E===Jo,E===Zo,_)}}var bc=new Br(!1,!1,!1,function(){});function jy(h,_,E,Y,le,te,ee,ge,be,me,Le,Ze,Pe,_e,ce,k){var J=me.Record,ve={add:32774,subtract:32778,"reverse subtract":32779};E.ext_blend_minmax&&(ve.min=zy,ve.max=Py);var he=E.angle_instanced_arrays,ae=E.webgl_draw_buffers,Ce=E.oes_vertex_array_object,Ae={dirty:!0,profile:k.profile},Ue={},ie=[],ne={},Oe={};function Z(m){return m.replace(".","_")}function Ee(m,x,S){var X=Z(m);ie.push(m),Ue[X]=Ae[X]=!!S,ne[X]=x}function de(m,x,S){var X=Z(m);ie.push(m),Array.isArray(S)?(Ae[X]=S.slice(),Ue[X]=S.slice()):Ae[X]=Ue[X]=S,Oe[X]=x}function $e(m){return!!isNaN(m)}Ee(Hu,Ry),Ee(Wu,Ly),de(Xu,"blendColor",[0,0,0,0]),de(Ko,"blendEquationSeparate",[yc,yc]),de(el,"blendFuncSeparate",[pc,dc,pc,dc]),Ee(Yu,Iy,!0),de(Zu,"depthFunc",Uy),de(Ju,"depthRange",[0,1]),de(Qu,"depthMask",!0),de(rl,rl,[!0,!0,!0,!0]),Ee(Ku,Oy),de(ec,"cullFace",Tn),de(tl,tl,Fl),de(nl,nl,1),Ee(rc,By),de(al,"polygonOffset",[0,0]),Ee(tc,Dy),Ee(nc,ky),de(il,"sampleCoverage",[1,!1]),Ee(ac,My),de(ic,"stencilMask",-1),de(ol,"stencilFunc",[Gy,0,-1]),de(ll,"stencilOpSeparate",[Ma,nn,nn,nn]),de(Ra,"stencilOpSeparate",[Tn,nn,nn,nn]),Ee(oc,Ny),de(xi,"scissor",[0,0,h.drawingBufferWidth,h.drawingBufferHeight]),de(Xt,Xt,[0,0,h.drawingBufferWidth,h.drawingBufferHeight]);var nr={gl:h,context:Pe,strings:_,next:Ue,current:Ae,draw:Ze,elements:te,buffer:le,shader:Le,attributes:me.state,vao:me,uniforms:be,framebuffer:ge,extensions:E,timer:_e,isBufferArgs:Ei},Me={primTypes:tt,compareFuncs:Ol,blendFuncs:Ia,blendEquations:ve,stencilOps:Ti,glTypes:mn,orientationType:gc};ae&&(Me.backBuffer=[Tn],Me.drawBuffer=z(Y.maxDrawbuffers,function(m){return m===0?[0]:z(m,function(x){return $y+x})}));var Ye=0;function we(){var m=Ey({cache:ce}),x=m.link,S=m.global;m.id=Ye++,m.batchId="0";var X=x(nr),U=m.shared={props:"a0"};Object.keys(nr).forEach(function(L){U[L]=S.def(X,".",L)});var P=m.next={},D=m.current={};Object.keys(Oe).forEach(function(L){Array.isArray(Ae[L])&&(P[L]=S.def(U.next,".",L),D[L]=S.def(U.current,".",L))});var N=m.constants={};Object.keys(Me).forEach(function(L){N[L]=S.def(JSON.stringify(Me[L]))}),m.invoke=function(L,A){switch(A.type){case Yo:var $=["this",U.context,U.props,m.batchId];return L.def(x(A.data),".call(",$.slice(0,Math.max(A.data.length+1,4)),")");case Zo:return L.def(U.props,A.data);case Jo:return L.def(U.context,A.data);case Qo:return L.def("this",A.data);case gi:return A.data.append(m,L),A.data.ref;case Vu:return A.data.toString();case qu:return A.data.map(function(re){return m.invoke(L,re)})}},m.attribCache={};var w={};return m.scopeAttrib=function(L){var A=_.id(L);if(A in w)return w[A];var $=me.scope[A];$||($=me.scope[A]=new J);var re=w[A]=x($);return re},m}function ar(m){var x=m.static,S=m.dynamic,X;if(bi in x){var U=!!x[bi];X=Mr(function(D,N){return U}),X.enable=U}else if(bi in S){var P=S[bi];X=nt(P,function(D,N){return D.invoke(N,P)})}return X}function fr(m,x){var S=m.static,X=m.dynamic;if(Jn in S){var U=S[Jn];return U?(U=ge.getFramebuffer(U),Mr(function(D,N){var w=D.link(U),L=D.shared;N.set(L.framebuffer,".next",w);var A=L.context;return N.set(A,"."+ra,w+".width"),N.set(A,"."+ta,w+".height"),w})):Mr(function(D,N){var w=D.shared;N.set(w.framebuffer,".next","null");var L=w.context;return N.set(L,"."+ra,L+"."+fc),N.set(L,"."+ta,L+"."+sc),"null"})}else if(Jn in X){var P=X[Jn];return nt(P,function(D,N){var w=D.invoke(N,P),L=D.shared,A=L.framebuffer,$=N.def(A,".getFramebuffer(",w,")");N.set(A,".next",$);var re=L.context;return N.set(re,"."+ra,$+"?"+$+".width:"+re+"."+fc),N.set(re,"."+ta,$+"?"+$+".height:"+re+"."+sc),$})}else return null}function vr(m,x,S){var X=m.static,U=m.dynamic;function P(w){if(w in X){var L=X[w],A=!0,$=L.x|0,re=L.y|0,oe,We;return"width"in L?oe=L.width|0:A=!1,"height"in L?We=L.height|0:A=!1,new Br(!A&&x&&x.thisDep,!A&&x&&x.contextDep,!A&&x&&x.propDep,function(Ve,Ne){var Xe=Ve.shared.context,Ie=oe;"width"in L||(Ie=Ne.def(Xe,".",ra,"-",$));var ke=We;return"height"in L||(ke=Ne.def(Xe,".",ta,"-",re)),[$,re,Ie,ke]})}else if(w in U){var Ge=U[w],Re=nt(Ge,function(Ve,Ne){var Xe=Ve.invoke(Ne,Ge),Ie=Ve.shared.context,ke=Ne.def(Xe,".x|0"),ze=Ne.def(Xe,".y|0"),Ke=Ne.def('"width" in ',Xe,"?",Xe,".width|0:","(",Ie,".",ra,"-",ke,")"),Ar=Ne.def('"height" in ',Xe,"?",Xe,".height|0:","(",Ie,".",ta,"-",ze,")");return[ke,ze,Ke,Ar]});return x&&(Re.thisDep=Re.thisDep||x.thisDep,Re.contextDep=Re.contextDep||x.contextDep,Re.propDep=Re.propDep||x.propDep),Re}else return x?new Br(x.thisDep,x.contextDep,x.propDep,function(Ve,Ne){var Xe=Ve.shared.context;return[0,0,Ne.def(Xe,".",ra),Ne.def(Xe,".",ta)]}):null}var D=P(Xt);if(D){var N=D;D=new Br(D.thisDep,D.contextDep,D.propDep,function(w,L){var A=N.append(w,L),$=w.shared.context;return L.set($,"."+Sy,A[2]),L.set($,"."+Cy,A[3]),A})}return{viewport:D,scissor_box:P(xi)}}function kr(m,x){var S=m.static,X=typeof S[Ai]=="string"&&typeof S[_i]=="string";if(X){if(Object.keys(x.dynamic).length>0)return null;var U=x.static,P=Object.keys(U);if(P.length>0&&typeof U[P[0]]=="number"){for(var D=[],N=0;N<P.length;++N)D.push([U[P[N]]|0,P[N]]);return D}}return null}function sr(m,x,S){var X=m.static,U=m.dynamic;function P(A){if(A in X){var $=_.id(X[A]),re=Mr(function(){return $});return re.id=$,re}else if(A in U){var oe=U[A];return nt(oe,function(We,Ge){var Re=We.invoke(Ge,oe),Ve=Ge.def(We.shared.strings,".id(",Re,")");return Ve})}return null}var D=P(Ai),N=P(_i),w=null,L;return Pt(D)&&Pt(N)?(w=Le.program(N.id,D.id,null,S),L=Mr(function(A,$){return A.link(w)})):L=new Br(D&&D.thisDep||N&&N.thisDep,D&&D.contextDep||N&&N.contextDep,D&&D.propDep||N&&N.propDep,function(A,$){var re=A.shared.shader,oe;D?oe=D.append(A,$):oe=$.def(re,".",Ai);var We;N?We=N.append(A,$):We=$.def(re,".",_i);var Ge=re+".program("+We+","+oe;return $.def(Ge+")")}),{frag:D,vert:N,progVar:L,program:w}}function at(m,x){var S=m.static,X=m.dynamic,U={},P=!1;function D(){if(wi in S){var Ne=S[wi];return Ne!==null&&me.getVAO(Ne)===null&&(Ne=me.createVAO(Ne)),P=!0,U.vao=Ne,Mr(function(Ie){var ke=me.getVAO(Ne);return ke?Ie.link(ke):"null"})}else if(wi in X){P=!0;var Xe=X[wi];return nt(Xe,function(Ie,ke){var ze=Ie.invoke(ke,Xe);return ke.def(Ie.shared.vao+".getVAO("+ze+")")})}return null}var N=D(),w=!1;function L(){if(Qn in S){var Ne=S[Qn];if(U.elements=Ne,Ei(Ne)){var Xe=U.elements=te.create(Ne,!0);Ne=te.getElements(Xe),w=!0}else Ne&&(Ne=te.getElements(Ne),w=!0);var Ie=Mr(function(ze,Ke){if(Ne){var Ar=ze.link(Ne);return ze.ELEMENTS=Ar,Ar}return ze.ELEMENTS=null,null});return Ie.value=Ne,Ie}else if(Qn in X){w=!0;var ke=X[Qn];return nt(ke,function(ze,Ke){var Ar=ze.shared,ot=Ar.isBufferArgs,Yt=Ar.elements,an=ze.invoke(Ke,ke),on=Ke.def("null"),At=Ke.def(ot,"(",an,")"),Na=ze.cond(At).then(on,"=",Yt,".createStream(",an,");").else(on,"=",Yt,".getElements(",an,");");return Ke.entry(Na),Ke.exit(ze.cond(At).then(Yt,".destroyStream(",on,");")),ze.ELEMENTS=on,on})}else if(P)return new Br(N.thisDep,N.contextDep,N.propDep,function(ze,Ke){return Ke.def(ze.shared.vao+".currentVAO?"+ze.shared.elements+".getElements("+ze.shared.vao+".currentVAO.elements):null")});return null}var A=L();function $(){if(Kn in S){var Ne=S[Kn];return U.primitive=Ne,Mr(function(Ie,ke){return tt[Ne]})}else if(Kn in X){var Xe=X[Kn];return nt(Xe,function(Ie,ke){var ze=Ie.constants.primTypes,Ke=Ie.invoke(ke,Xe);return ke.def(ze,"[",Ke,"]")})}else{if(w)return Pt(A)?A.value?Mr(function(Ie,ke){return ke.def(Ie.ELEMENTS,".primType")}):Mr(function(){return Cl}):new Br(A.thisDep,A.contextDep,A.propDep,function(Ie,ke){var ze=Ie.ELEMENTS;return ke.def(ze,"?",ze,".primType:",Cl)});if(P)return new Br(N.thisDep,N.contextDep,N.propDep,function(Ie,ke){return ke.def(Ie.shared.vao+".currentVAO?"+Ie.shared.vao+".currentVAO.primitive:"+Cl)})}return null}function re(Ne,Xe){if(Ne in S){var Ie=S[Ne]|0;return Xe?U.offset=Ie:U.instances=Ie,Mr(function(ze,Ke){return Xe&&(ze.OFFSET=Ie),Ie})}else if(Ne in X){var ke=X[Ne];return nt(ke,function(ze,Ke){var Ar=ze.invoke(Ke,ke);return Xe&&(ze.OFFSET=Ar),Ar})}else if(Xe){if(w)return Mr(function(ze,Ke){return ze.OFFSET=0,0});if(P)return new Br(N.thisDep,N.contextDep,N.propDep,function(ze,Ke){return Ke.def(ze.shared.vao+".currentVAO?"+ze.shared.vao+".currentVAO.offset:0")})}else if(P)return new Br(N.thisDep,N.contextDep,N.propDep,function(ze,Ke){return Ke.def(ze.shared.vao+".currentVAO?"+ze.shared.vao+".currentVAO.instances:-1")});return null}var oe=re(fl,!0);function We(){if(ea in S){var Ne=S[ea]|0;return U.count=Ne,Mr(function(){return Ne})}else if(ea in X){var Xe=X[ea];return nt(Xe,function(Ke,Ar){var ot=Ke.invoke(Ar,Xe);return ot})}else if(w)if(Pt(A)){if(A)return oe?new Br(oe.thisDep,oe.contextDep,oe.propDep,function(Ke,Ar){var ot=Ar.def(Ke.ELEMENTS,".vertCount-",Ke.OFFSET);return ot}):Mr(function(Ke,Ar){return Ar.def(Ke.ELEMENTS,".vertCount")});var Ie=Mr(function(){return-1});return Ie}else{var ke=new Br(A.thisDep||oe.thisDep,A.contextDep||oe.contextDep,A.propDep||oe.propDep,function(Ke,Ar){var ot=Ke.ELEMENTS;return Ke.OFFSET?Ar.def(ot,"?",ot,".vertCount-",Ke.OFFSET,":-1"):Ar.def(ot,"?",ot,".vertCount:-1")});return ke}else if(P){var ze=new Br(N.thisDep,N.contextDep,N.propDep,function(Ke,Ar){return Ar.def(Ke.shared.vao,".currentVAO?",Ke.shared.vao,".currentVAO.count:-1")});return ze}return null}var Ge=$(),Re=We(),Ve=re(sl,!1);return{elements:A,primitive:Ge,count:Re,instances:Ve,offset:oe,vao:N,vaoActive:P,elementsActive:w,static:U}}function xr(m,x){var S=m.static,X=m.dynamic,U={};return ie.forEach(function(P){var D=Z(P);function N(w,L){if(P in S){var A=w(S[P]);U[D]=Mr(function(){return A})}else if(P in X){var $=X[P];U[D]=nt($,function(re,oe){return L(re,oe,re.invoke(oe,$))})}}switch(P){case Ku:case Wu:case Hu:case ac:case Yu:case oc:case rc:case tc:case nc:case Qu:return N(function(w){return w},function(w,L,A){return A});case Zu:return N(function(w){return Ol[w]},function(w,L,A){var $=w.constants.compareFuncs;return L.def($,"[",A,"]")});case Ju:return N(function(w){return w},function(w,L,A){var $=L.def("+",A,"[0]"),re=L.def("+",A,"[1]");return[$,re]});case el:return N(function(w){var L="srcRGB"in w?w.srcRGB:w.src,A="srcAlpha"in w?w.srcAlpha:w.src,$="dstRGB"in w?w.dstRGB:w.dst,re="dstAlpha"in w?w.dstAlpha:w.dst;return[Ia[L],Ia[$],Ia[A],Ia[re]]},function(w,L,A){var $=w.constants.blendFuncs;function re(Xe,Ie){var ke=L.def('"',Xe,Ie,'" in ',A,"?",A,".",Xe,Ie,":",A,".",Xe);return ke}var oe=re("src","RGB"),We=re("dst","RGB"),Ge=L.def($,"[",oe,"]"),Re=L.def($,"[",re("src","Alpha"),"]"),Ve=L.def($,"[",We,"]"),Ne=L.def($,"[",re("dst","Alpha"),"]");return[Ge,Ve,Re,Ne]});case Ko:return N(function(w){if(typeof w=="string")return[ve[w],ve[w]];if(typeof w=="object")return[ve[w.rgb],ve[w.alpha]]},function(w,L,A){var $=w.constants.blendEquations,re=L.def(),oe=L.def(),We=w.cond("typeof ",A,'==="string"');return We.then(re,"=",oe,"=",$,"[",A,"];"),We.else(re,"=",$,"[",A,".rgb];",oe,"=",$,"[",A,".alpha];"),L(We),[re,oe]});case Xu:return N(function(w){return z(4,function(L){return+w[L]})},function(w,L,A){return z(4,function($){return L.def("+",A,"[",$,"]")})});case ic:return N(function(w){return w|0},function(w,L,A){return L.def(A,"|0")});case ol:return N(function(w){var L=w.cmp||"keep",A=w.ref||0,$="mask"in w?w.mask:-1;return[Ol[L],A,$]},function(w,L,A){var $=w.constants.compareFuncs,re=L.def('"cmp" in ',A,"?",$,"[",A,".cmp]",":",nn),oe=L.def(A,".ref|0"),We=L.def('"mask" in ',A,"?",A,".mask|0:-1");return[re,oe,We]});case ll:case Ra:return N(function(w){var L=w.fail||"keep",A=w.zfail||"keep",$=w.zpass||"keep";return[P===Ra?Tn:Ma,Ti[L],Ti[A],Ti[$]]},function(w,L,A){var $=w.constants.stencilOps;function re(oe){return L.def('"',oe,'" in ',A,"?",$,"[",A,".",oe,"]:",nn)}return[P===Ra?Tn:Ma,re("fail"),re("zfail"),re("zpass")]});case al:return N(function(w){var L=w.factor|0,A=w.units|0;return[L,A]},function(w,L,A){var $=L.def(A,".factor|0"),re=L.def(A,".units|0");return[$,re]});case ec:return N(function(w){var L=0;return w==="front"?L=Ma:w==="back"&&(L=Tn),L},function(w,L,A){return L.def(A,'==="front"?',Ma,":",Tn)});case nl:return N(function(w){return w},function(w,L,A){return A});case tl:return N(function(w){return gc[w]},function(w,L,A){return L.def(A+'==="cw"?'+hc+":"+Fl)});case rl:return N(function(w){return w.map(function(L){return!!L})},function(w,L,A){return z(4,function($){return"!!"+A+"["+$+"]"})});case il:return N(function(w){var L="value"in w?w.value:1,A=!!w.invert;return[L,A]},function(w,L,A){var $=L.def('"value" in ',A,"?+",A,".value:1"),re=L.def("!!",A,".invert");return[$,re]})}}),U}function Xr(m,x){var S=m.static,X=m.dynamic,U={};return Object.keys(S).forEach(function(P){var D=S[P],N;if(typeof D=="number"||typeof D=="boolean")N=Mr(function(){return D});else if(typeof D=="function"){var w=D._reglType;w==="texture2d"||w==="textureCube"?N=Mr(function(L){return L.link(D)}):(w==="framebuffer"||w==="framebufferCube")&&(N=Mr(function(L){return L.link(D.color[0])}))}else rn(D)&&(N=Mr(function(L){var A=L.global.def("[",z(D.length,function($){return D[$]}),"]");return A}));N.value=D,U[P]=N}),Object.keys(X).forEach(function(P){var D=X[P];U[P]=nt(D,function(N,w){return N.invoke(w,D)})}),U}function it(m,x){var S=m.static,X=m.dynamic,U={};return Object.keys(S).forEach(function(P){var D=S[P],N=_.id(P),w=new J;if(Ei(D))w.state=Zn,w.buffer=le.getBuffer(le.create(D,na,!1,!0)),w.type=0;else{var L=le.getBuffer(D);if(L)w.state=Zn,w.buffer=L,w.type=0;else if("constant"in D){var A=D.constant;w.buffer="null",w.state=Xo,typeof A=="number"?w.x=A:Yn.forEach(function(Ve,Ne){Ne<A.length&&(w[Ve]=A[Ne])})}else{Ei(D.buffer)?L=le.getBuffer(le.create(D.buffer,na,!1,!0)):L=le.getBuffer(D.buffer);var $=D.offset|0,re=D.stride|0,oe=D.size|0,We=!!D.normalized,Ge=0;"type"in D&&(Ge=mn[D.type]);var Re=D.divisor|0;w.buffer=L,w.state=Zn,w.size=oe,w.normalized=We,w.type=Ge||L.dtype,w.offset=$,w.stride=re,w.divisor=Re}}U[P]=Mr(function(Ve,Ne){var Xe=Ve.attribCache;if(N in Xe)return Xe[N];var Ie={isStream:!1};return Object.keys(w).forEach(function(ke){Ie[ke]=w[ke]}),w.buffer&&(Ie.buffer=Ve.link(w.buffer),Ie.type=Ie.type||Ie.buffer+".dtype"),Xe[N]=Ie,Ie})}),Object.keys(X).forEach(function(P){var D=X[P];function N(w,L){var A=w.invoke(L,D),$=w.shared,re=w.constants,oe=$.isBufferArgs,We=$.buffer,Ge={isStream:L.def(!1)},Re=new J;Re.state=Zn,Object.keys(Re).forEach(function(Ie){Ge[Ie]=L.def(""+Re[Ie])});var Ve=Ge.buffer,Ne=Ge.type;L("if(",oe,"(",A,")){",Ge.isStream,"=true;",Ve,"=",We,".createStream(",na,",",A,");",Ne,"=",Ve,".dtype;","}else{",Ve,"=",We,".getBuffer(",A,");","if(",Ve,"){",Ne,"=",Ve,".dtype;",'}else if("constant" in ',A,"){",Ge.state,"=",Xo,";","if(typeof "+A+'.constant === "number"){',Ge[Yn[0]],"=",A,".constant;",Yn.slice(1).map(function(Ie){return Ge[Ie]}).join("="),"=0;","}else{",Yn.map(function(Ie,ke){return Ge[Ie]+"="+A+".constant.length>"+ke+"?"+A+".constant["+ke+"]:0;"}).join(""),"}}else{","if(",oe,"(",A,".buffer)){",Ve,"=",We,".createStream(",na,",",A,".buffer);","}else{",Ve,"=",We,".getBuffer(",A,".buffer);","}",Ne,'="type" in ',A,"?",re.glTypes,"[",A,".type]:",Ve,".dtype;",Ge.normalized,"=!!",A,".normalized;");function Xe(Ie){L(Ge[Ie],"=",A,".",Ie,"|0;")}return Xe("size"),Xe("offset"),Xe("stride"),Xe("divisor"),L("}}"),L.exit("if(",Ge.isStream,"){",We,".destroyStream(",Ve,");","}"),Ge}U[P]=nt(D,N)}),U}function Jr(m){var x=m.static,S=m.dynamic,X={};return Object.keys(x).forEach(function(U){var P=x[U];X[U]=Mr(function(D,N){return typeof P=="number"||typeof P=="boolean"?""+P:D.link(P)})}),Object.keys(S).forEach(function(U){var P=S[U];X[U]=nt(P,function(D,N){return D.invoke(N,P)})}),X}function Mt(m,x,S,X,U){m.static,m.dynamic;var P=kr(m,x),D=fr(m),N=vr(m,D),w=at(m),L=xr(m),A=sr(m,U,P);function $(Ve){var Ne=N[Ve];Ne&&(L[Ve]=Ne)}$(Xt),$(Z(xi));var re=Object.keys(L).length>0,oe={framebuffer:D,draw:w,shader:A,state:L,dirty:re,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(oe.profile=ar(m),oe.uniforms=Xr(S),oe.drawVAO=oe.scopeVAO=w.vao,!oe.drawVAO&&A.program&&!P&&E.angle_instanced_arrays&&w.static.elements){var We=!0,Ge=A.program.attributes.map(function(Ve){var Ne=x.static[Ve];return We=We&&!!Ne,Ne});if(We&&Ge.length>0){var Re=me.getVAO(me.createVAO({attributes:Ge,elements:w.static.elements}));oe.drawVAO=new Br(null,null,null,function(Ve,Ne){return Ve.link(Re)}),oe.useVAO=!0}}return P?oe.useVAO=!0:oe.attributes=it(x),oe.context=Jr(X),oe}function zr(m,x,S){var X=m.shared,U=X.context,P=m.scope();Object.keys(S).forEach(function(D){x.save(U,"."+D);var N=S[D],w=N.append(m,x);Array.isArray(w)?P(U,".",D,"=[",w.join(),"];"):P(U,".",D,"=",w,";")}),x(P)}function Pr(m,x,S,X){var U=m.shared,P=U.gl,D=U.framebuffer,N;ae&&(N=x.def(U.extensions,".webgl_draw_buffers"));var w=m.constants,L=w.drawBuffer,A=w.backBuffer,$;S?$=S.append(m,x):$=x.def(D,".next"),X||x("if(",$,"!==",D,".cur){"),x("if(",$,"){",P,".bindFramebuffer(",mc,",",$,".framebuffer);"),ae&&x(N,".drawBuffersWEBGL(",L,"[",$,".colorAttachments.length]);"),x("}else{",P,".bindFramebuffer(",mc,",null);"),ae&&x(N,".drawBuffersWEBGL(",A,");"),x("}",D,".cur=",$,";"),X||x("}")}function er(m,x,S){var X=m.shared,U=X.gl,P=m.current,D=m.next,N=X.current,w=X.next,L=m.cond(N,".dirty");ie.forEach(function(A){var $=Z(A);if(!($ in S.state)){var re,oe;if($ in D){re=D[$],oe=P[$];var We=z(Ae[$].length,function(Re){return L.def(re,"[",Re,"]")});L(m.cond(We.map(function(Re,Ve){return Re+"!=="+oe+"["+Ve+"]"}).join("||")).then(U,".",Oe[$],"(",We,");",We.map(function(Re,Ve){return oe+"["+Ve+"]="+Re}).join(";"),";"))}else{re=L.def(w,".",$);var Ge=m.cond(re,"!==",N,".",$);L(Ge),$ in ne?Ge(m.cond(re).then(U,".enable(",ne[$],");").else(U,".disable(",ne[$],");"),N,".",$,"=",re,";"):Ge(U,".",Oe[$],"(",re,");",N,".",$,"=",re,";")}}}),Object.keys(S.state).length===0&&L(N,".dirty=false;"),x(L)}function ht(m,x,S,X){var U=m.shared,P=m.current,D=U.current,N=U.gl,w;xc(Object.keys(S)).forEach(function(L){var A=S[L];if(!(X&&!X(A))){var $=A.append(m,x);if(ne[L]){var re=ne[L];Pt(A)?(w=m.link($,{stable:!0}),x(m.cond(w).then(N,".enable(",re,");").else(N,".disable(",re,");")),x(D,".",L,"=",w,";")):(x(m.cond($).then(N,".enable(",re,");").else(N,".disable(",re,");")),x(D,".",L,"=",$,";"))}else if(rn($)){var oe=P[L];x(N,".",Oe[L],"(",$,");",$.map(function(We,Ge){return oe+"["+Ge+"]="+We}).join(";"),";")}else Pt(A)?(w=m.link($,{stable:!0}),x(N,".",Oe[L],"(",w,");",D,".",L,"=",w,";")):x(N,".",Oe[L],"(",$,");",D,".",L,"=",$,";")}})}function yr(m,x){he&&(m.instancing=x.def(m.shared.extensions,".angle_instanced_arrays"))}function Gr(m,x,S,X,U){var P=m.shared,D=m.stats,N=P.current,w=P.timer,L=S.profile;function A(){return typeof performance>"u"?"Date.now()":"performance.now()"}var $,re;function oe(Xe){$=x.def(),Xe($,"=",A(),";"),typeof U=="string"?Xe(D,".count+=",U,";"):Xe(D,".count++;"),_e&&(X?(re=x.def(),Xe(re,"=",w,".getNumPendingQueries();")):Xe(w,".beginQuery(",D,");"))}function We(Xe){Xe(D,".cpuTime+=",A(),"-",$,";"),_e&&(X?Xe(w,".pushScopeStats(",re,",",w,".getNumPendingQueries(),",D,");"):Xe(w,".endQuery();"))}function Ge(Xe){var Ie=x.def(N,".profile");x(N,".profile=",Xe,";"),x.exit(N,".profile=",Ie,";")}var Re;if(L){if(Pt(L)){L.enable?(oe(x),We(x.exit),Ge("true")):Ge("false");return}Re=L.append(m,x),Ge(Re)}else Re=x.def(N,".profile");var Ve=m.block();oe(Ve),x("if(",Re,"){",Ve,"}");var Ne=m.block();We(Ne),x.exit("if(",Re,"){",Ne,"}")}function Qr(m,x,S,X,U){var P=m.shared;function D(w){switch(w){case hl:case yl:case xl:return 2;case dl:case ml:case bl:return 3;case pl:case gl:case _l:return 4;default:return 1}}function N(w,L,A){var $=P.gl,re=x.def(w,".location"),oe=x.def(P.attributes,"[",re,"]"),We=A.state,Ge=A.buffer,Re=[A.x,A.y,A.z,A.w],Ve=["buffer","normalized","offset","stride"];function Ne(){x("if(!",oe,".buffer){",$,".enableVertexAttribArray(",re,");}");var Ie=A.type,ke;if(A.size?ke=x.def(A.size,"||",L):ke=L,x("if(",oe,".type!==",Ie,"||",oe,".size!==",ke,"||",Ve.map(function(Ke){return oe+"."+Ke+"!=="+A[Ke]}).join("||"),"){",$,".bindBuffer(",na,",",Ge,".buffer);",$,".vertexAttribPointer(",[re,ke,Ie,A.normalized,A.stride,A.offset],");",oe,".type=",Ie,";",oe,".size=",ke,";",Ve.map(function(Ke){return oe+"."+Ke+"="+A[Ke]+";"}).join(""),"}"),he){var ze=A.divisor;x("if(",oe,".divisor!==",ze,"){",m.instancing,".vertexAttribDivisorANGLE(",[re,ze],");",oe,".divisor=",ze,";}")}}function Xe(){x("if(",oe,".buffer){",$,".disableVertexAttribArray(",re,");",oe,".buffer=null;","}if(",Yn.map(function(Ie,ke){return oe+"."+Ie+"!=="+Re[ke]}).join("||"),"){",$,".vertexAttrib4f(",re,",",Re,");",Yn.map(function(Ie,ke){return oe+"."+Ie+"="+Re[ke]+";"}).join(""),"}")}We===Zn?Ne():We===Xo?Xe():(x("if(",We,"===",Zn,"){"),Ne(),x("}else{"),Xe(),x("}"))}X.forEach(function(w){var L=w.name,A=S.attributes[L],$;if(A){if(!U(A))return;$=A.append(m,x)}else{if(!U(bc))return;var re=m.scopeAttrib(L);$={},Object.keys(new J).forEach(function(oe){$[oe]=x.def(re,".",oe)})}N(m.link(w),D(w.info.type),$)})}function Kr(m,x,S,X,U,P){for(var D=m.shared,N=D.gl,w,L=0;L<X.length;++L){var A=X[L],$=A.name,re=A.info.type,oe=S.uniforms[$],We=m.link(A),Ge=We+".location",Re;if(oe){if(!U(oe))continue;if(Pt(oe)){var Ve=oe.value;if(re===El||re===Sl){var Ne=m.link(Ve._texture||Ve.color[0]._texture);x(N,".uniform1i(",Ge,",",Ne+".bind());"),x.exit(Ne,".unbind();")}else if(re===Al||re===wl||re===Tl){var Xe=m.global.def("new Float32Array(["+Array.prototype.slice.call(Ve)+"])"),Ie=2;re===wl?Ie=3:re===Tl&&(Ie=4),x(N,".uniformMatrix",Ie,"fv(",Ge,",false,",Xe,");")}else{switch(re){case uc:w="1f";break;case hl:w="2f";break;case dl:w="3f";break;case pl:w="4f";break;case vc:w="1i";break;case cc:w="1i";break;case xl:w="2i";break;case yl:w="2i";break;case bl:w="3i";break;case ml:w="3i";break;case _l:w="4i";break;case gl:w="4i";break}x(N,".uniform",w,"(",Ge,",",rn(Ve)?Array.prototype.slice.call(Ve):Ve,");")}continue}else Re=oe.append(m,x)}else{if(!U(bc))continue;Re=x.def(D.uniforms,"[",_.id($),"]")}re===El?x("if(",Re,"&&",Re,'._reglType==="framebuffer"){',Re,"=",Re,".color[0];","}"):re===Sl&&x("if(",Re,"&&",Re,'._reglType==="framebufferCube"){',Re,"=",Re,".color[0];","}");var ke=1;switch(re){case El:case Sl:var ze=x.def(Re,"._texture");x(N,".uniform1i(",Ge,",",ze,".bind());"),x.exit(ze,".unbind();");continue;case cc:case vc:w="1i";break;case yl:case xl:w="2i",ke=2;break;case ml:case bl:w="3i",ke=3;break;case gl:case _l:w="4i",ke=4;break;case uc:w="1f";break;case hl:w="2f",ke=2;break;case dl:w="3f",ke=3;break;case pl:w="4f",ke=4;break;case Al:w="Matrix2fv";break;case wl:w="Matrix3fv";break;case Tl:w="Matrix4fv";break}if(w.charAt(0)==="M"){x(N,".uniform",w,"(",Ge,",");var Ke=Math.pow(re-Al+2,2),Ar=m.global.def("new Float32Array(",Ke,")");Array.isArray(Re)?x("false,(",z(Ke,function(At){return Ar+"["+At+"]="+Re[At]}),",",Ar,")"):x("false,(Array.isArray(",Re,")||",Re," instanceof Float32Array)?",Re,":(",z(Ke,function(At){return Ar+"["+At+"]="+Re+"["+At+"]"}),",",Ar,")"),x(");")}else if(ke>1){for(var ot=[],Yt=[],an=0;an<ke;++an)Array.isArray(Re)?Yt.push(Re[an]):Yt.push(x.def(Re+"["+an+"]")),P&&ot.push(x.def());P&&x("if(!",m.batchId,"||",ot.map(function(At,Na){return At+"!=="+Yt[Na]}).join("||"),"){",ot.map(function(At,Na){return At+"="+Yt[Na]+";"}).join("")),x(N,".uniform",w,"(",Ge,",",Yt.join(","),");"),P&&x("}")}else{if(P){var on=x.def();x("if(!",m.batchId,"||",on,"!==",Re,"){",on,"=",Re,";")}x(N,".uniform",w,"(",Ge,",",Re,");"),P&&x("}")}}}function rr(m,x,S,X){var U=m.shared,P=U.gl,D=U.draw,N=X.draw;function w(){var ke=N.elements,ze,Ke=x;return ke?((ke.contextDep&&X.contextDynamic||ke.propDep)&&(Ke=S),ze=ke.append(m,Ke),N.elementsActive&&Ke("if("+ze+")"+P+".bindBuffer("+vl+","+ze+".buffer.buffer);")):(ze=Ke.def(),Ke(ze,"=",D,".",Qn,";","if(",ze,"){",P,".bindBuffer(",vl,",",ze,".buffer.buffer);}","else if(",U.vao,".currentVAO){",ze,"=",m.shared.elements+".getElements("+U.vao,".currentVAO.elements);",Ce?"":"if("+ze+")"+P+".bindBuffer("+vl+","+ze+".buffer.buffer);","}")),ze}function L(){var ke=N.count,ze,Ke=x;return ke?((ke.contextDep&&X.contextDynamic||ke.propDep)&&(Ke=S),ze=ke.append(m,Ke)):ze=Ke.def(D,".",ea),ze}var A=w();function $(ke){var ze=N[ke];return ze?ze.contextDep&&X.contextDynamic||ze.propDep?ze.append(m,S):ze.append(m,x):x.def(D,".",ke)}var re=$(Kn),oe=$(fl),We=L();if(typeof We=="number"){if(We===0)return}else S("if(",We,"){"),S.exit("}");var Ge,Re;he&&(Ge=$(sl),Re=m.instancing);var Ve=A+".type",Ne=N.elements&&Pt(N.elements)&&!N.vaoActive;function Xe(){function ke(){S(Re,".drawElementsInstancedANGLE(",[re,We,Ve,oe+"<<(("+Ve+"-"+ju+")>>1)",Ge],");")}function ze(){S(Re,".drawArraysInstancedANGLE(",[re,oe,We,Ge],");")}A&&A!=="null"?Ne?ke():(S("if(",A,"){"),ke(),S("}else{"),ze(),S("}")):ze()}function Ie(){function ke(){S(P+".drawElements("+[re,We,Ve,oe+"<<(("+Ve+"-"+ju+")>>1)"]+");")}function ze(){S(P+".drawArrays("+[re,oe,We]+");")}A&&A!=="null"?Ne?ke():(S("if(",A,"){"),ke(),S("}else{"),ze(),S("}")):ze()}he&&(typeof Ge!="number"||Ge>=0)?typeof Ge=="string"?(S("if(",Ge,">0){"),Xe(),S("}else if(",Ge,"<0){"),Ie(),S("}")):Xe():Ie()}function ur(m,x,S,X,U){var P=we(),D=P.proc("body",U);return he&&(P.instancing=D.def(P.shared.extensions,".angle_instanced_arrays")),m(P,D,S,X),P.compile().body}function br(m,x,S,X){yr(m,x),S.useVAO?S.drawVAO?x(m.shared.vao,".setVAO(",S.drawVAO.append(m,x),");"):x(m.shared.vao,".setVAO(",m.shared.vao,".targetVAO);"):(x(m.shared.vao,".setVAO(null);"),Qr(m,x,S,X.attributes,function(){return!0})),Kr(m,x,S,X.uniforms,function(){return!0},!1),rr(m,x,x,S)}function Ur(m,x){var S=m.proc("draw",1);yr(m,S),zr(m,S,x.context),Pr(m,S,x.framebuffer),er(m,S,x),ht(m,S,x.state),Gr(m,S,x,!1,!0);var X=x.shader.progVar.append(m,S);if(S(m.shared.gl,".useProgram(",X,".program);"),x.shader.program)br(m,S,x,x.shader.program);else{S(m.shared.vao,".setVAO(null);");var U=m.global.def("{}"),P=S.def(X,".id"),D=S.def(U,"[",P,"]");S(m.cond(D).then(D,".call(this,a0);").else(D,"=",U,"[",P,"]=",m.link(function(N){return ur(br,m,x,N,1)}),"(",X,");",D,".call(this,a0);"))}Object.keys(x.state).length>0&&S(m.shared.current,".dirty=true;"),m.shared.vao&&S(m.shared.vao,".setVAO(null);")}function b(m,x,S,X){m.batchId="a1",yr(m,x);function U(){return!0}Qr(m,x,S,X.attributes,U),Kr(m,x,S,X.uniforms,U,!1),rr(m,x,x,S)}function W(m,x,S,X){yr(m,x);var U=S.contextDep,P=x.def(),D="a0",N="a1",w=x.def();m.shared.props=w,m.batchId=P;var L=m.scope(),A=m.scope();x(L.entry,"for(",P,"=0;",P,"<",N,";++",P,"){",w,"=",D,"[",P,"];",A,"}",L.exit);function $(Ve){return Ve.contextDep&&U||Ve.propDep}function re(Ve){return!$(Ve)}if(S.needsContext&&zr(m,A,S.context),S.needsFramebuffer&&Pr(m,A,S.framebuffer),ht(m,A,S.state,$),S.profile&&$(S.profile)&&Gr(m,A,S,!1,!0),X)S.useVAO?S.drawVAO?$(S.drawVAO)?A(m.shared.vao,".setVAO(",S.drawVAO.append(m,A),");"):L(m.shared.vao,".setVAO(",S.drawVAO.append(m,L),");"):L(m.shared.vao,".setVAO(",m.shared.vao,".targetVAO);"):(L(m.shared.vao,".setVAO(null);"),Qr(m,L,S,X.attributes,re),Qr(m,A,S,X.attributes,$)),Kr(m,L,S,X.uniforms,re,!1),Kr(m,A,S,X.uniforms,$,!0),rr(m,L,A,S);else{var oe=m.global.def("{}"),We=S.shader.progVar.append(m,A),Ge=A.def(We,".id"),Re=A.def(oe,"[",Ge,"]");A(m.shared.gl,".useProgram(",We,".program);","if(!",Re,"){",Re,"=",oe,"[",Ge,"]=",m.link(function(Ve){return ur(b,m,S,Ve,2)}),"(",We,");}",Re,".call(this,a0[",P,"],",P,");")}}function H(m,x){var S=m.proc("batch",2);m.batchId="0",yr(m,S);var X=!1,U=!0;Object.keys(x.context).forEach(function(oe){X=X||x.context[oe].propDep}),X||(zr(m,S,x.context),U=!1);var P=x.framebuffer,D=!1;P?(P.propDep?X=D=!0:P.contextDep&&X&&(D=!0),D||Pr(m,S,P)):Pr(m,S,null),x.state.viewport&&x.state.viewport.propDep&&(X=!0);function N(oe){return oe.contextDep&&X||oe.propDep}er(m,S,x),ht(m,S,x.state,function(oe){return!N(oe)}),(!x.profile||!N(x.profile))&&Gr(m,S,x,!1,"a1"),x.contextDep=X,x.needsContext=U,x.needsFramebuffer=D;var w=x.shader.progVar;if(w.contextDep&&X||w.propDep)W(m,S,x,null);else{var L=w.append(m,S);if(S(m.shared.gl,".useProgram(",L,".program);"),x.shader.program)W(m,S,x,x.shader.program);else{S(m.shared.vao,".setVAO(null);");var A=m.global.def("{}"),$=S.def(L,".id"),re=S.def(A,"[",$,"]");S(m.cond(re).then(re,".call(this,a0,a1);").else(re,"=",A,"[",$,"]=",m.link(function(oe){return ur(W,m,x,oe,2)}),"(",L,");",re,".call(this,a0,a1);"))}}Object.keys(x.state).length>0&&S(m.shared.current,".dirty=true;"),m.shared.vao&&S(m.shared.vao,".setVAO(null);")}function Be(m,x){var S=m.proc("scope",3);m.batchId="a2";var X=m.shared,U=X.current;if(zr(m,S,x.context),x.framebuffer&&x.framebuffer.append(m,S),xc(Object.keys(x.state)).forEach(function(N){var w=x.state[N],L=w.append(m,S);rn(L)?L.forEach(function(A,$){$e(A)?S.set(m.next[N],"["+$+"]",A):S.set(m.next[N],"["+$+"]",m.link(A,{stable:!0}))}):Pt(w)?S.set(X.next,"."+N,m.link(L,{stable:!0})):S.set(X.next,"."+N,L)}),Gr(m,S,x,!0,!0),[Qn,fl,ea,sl,Kn].forEach(function(N){var w=x.draw[N];if(w){var L=w.append(m,S);$e(L)?S.set(X.draw,"."+N,L):S.set(X.draw,"."+N,m.link(L),{stable:!0})}}),Object.keys(x.uniforms).forEach(function(N){var w=x.uniforms[N].append(m,S);Array.isArray(w)&&(w="["+w.map(function(L){return $e(L)?L:m.link(L,{stable:!0})})+"]"),S.set(X.uniforms,"["+m.link(_.id(N),{stable:!0})+"]",w)}),Object.keys(x.attributes).forEach(function(N){var w=x.attributes[N].append(m,S),L=m.scopeAttrib(N);Object.keys(new J).forEach(function(A){S.set(L,"."+A,w[A])})}),x.scopeVAO){var P=x.scopeVAO.append(m,S);$e(P)?S.set(X.vao,".targetVAO",P):S.set(X.vao,".targetVAO",m.link(P,{stable:!0}))}function D(N){var w=x.shader[N];if(w){var L=w.append(m,S);$e(L)?S.set(X.shader,"."+N,L):S.set(X.shader,"."+N,m.link(L,{stable:!0}))}}D(_i),D(Ai),Object.keys(x.state).length>0&&(S(U,".dirty=true;"),S.exit(U,".dirty=true;")),S("a1(",m.shared.context,",a0,",m.batchId,");")}function lr(m){if(!(typeof m!="object"||rn(m))){for(var x=Object.keys(m),S=0;S<x.length;++S)if(p.isDynamic(m[x[S]]))return!0;return!1}}function _r(m,x,S){var X=x.static[S];if(!X||!lr(X))return;var U=m.global,P=Object.keys(X),D=!1,N=!1,w=!1,L=m.global.def("{}");P.forEach(function($){var re=X[$];if(p.isDynamic(re)){typeof re=="function"&&(re=X[$]=p.unbox(re));var oe=nt(re,null);D=D||oe.thisDep,w=w||oe.propDep,N=N||oe.contextDep}else{switch(U(L,".",$,"="),typeof re){case"number":U(re);break;case"string":U('"',re,'"');break;case"object":Array.isArray(re)&&U("[",re.join(),"]");break;default:U(m.link(re));break}U(";")}});function A($,re){P.forEach(function(oe){var We=X[oe];if(p.isDynamic(We)){var Ge=$.invoke(re,We);re(L,".",oe,"=",Ge,";")}})}x.dynamic[S]=new p.DynamicVariable(gi,{thisDep:D,contextDep:N,propDep:w,ref:L,append:A}),delete x.static[S]}function De(m,x,S,X,U){var P=we();P.stats=P.link(U),Object.keys(x.static).forEach(function(N){_r(P,x,N)}),Fy.forEach(function(N){_r(P,m,N)});var D=Mt(m,x,S,X,P);return D.shader.program&&(D.shader.program.attributes.sort(function(N,w){return N.name<w.name?-1:1}),D.shader.program.uniforms.sort(function(N,w){return N.name<w.name?-1:1})),Ur(P,D),Be(P,D),H(P,D),t(P.compile(),{destroy:function(){D.shader.program.destroy()}})}return{next:Ue,current:Ae,procs:function(){var m=we(),x=m.proc("poll"),S=m.proc("refresh"),X=m.block();x(X),S(X);var U=m.shared,P=U.gl,D=U.next,N=U.current;X(N,".dirty=false;"),Pr(m,x),Pr(m,S,null,!0);var w;he&&(w=m.link(he)),E.oes_vertex_array_object&&S(m.link(E.oes_vertex_array_object),".bindVertexArrayOES(null);");var L=S.def(U.attributes),A=S.def(0),$=m.cond(A,".buffer");$.then(P,".enableVertexAttribArray(i);",P,".bindBuffer(",na,",",A,".buffer.buffer);",P,".vertexAttribPointer(i,",A,".size,",A,".type,",A,".normalized,",A,".stride,",A,".offset);").else(P,".disableVertexAttribArray(i);",P,".vertexAttrib4f(i,",A,".x,",A,".y,",A,".z,",A,".w);",A,".buffer=null;");var re=m.link(Y.maxAttributes,{stable:!0});return S("for(var i=0;i<",re,";++i){",A,"=",L,"[i];",$,"}"),he&&S("for(var i=0;i<",re,";++i){",w,".vertexAttribDivisorANGLE(i,",L,"[i].divisor);","}"),S(m.shared.vao,".currentVAO=null;",m.shared.vao,".setVAO(",m.shared.vao,".targetVAO);"),Object.keys(ne).forEach(function(oe){var We=ne[oe],Ge=X.def(D,".",oe),Re=m.block();Re("if(",Ge,"){",P,".enable(",We,")}else{",P,".disable(",We,")}",N,".",oe,"=",Ge,";"),S(Re),x("if(",Ge,"!==",N,".",oe,"){",Re,"}")}),Object.keys(Oe).forEach(function(oe){var We=Oe[oe],Ge=Ae[oe],Re,Ve,Ne=m.block();if(Ne(P,".",We,"("),rn(Ge)){var Xe=Ge.length;Re=m.global.def(D,".",oe),Ve=m.global.def(N,".",oe),Ne(z(Xe,function(Ie){return Re+"["+Ie+"]"}),");",z(Xe,function(Ie){return Ve+"["+Ie+"]="+Re+"["+Ie+"];"}).join("")),x("if(",z(Xe,function(Ie){return Re+"["+Ie+"]!=="+Ve+"["+Ie+"]"}).join("||"),"){",Ne,"}")}else Re=X.def(D,".",oe),Ve=X.def(N,".",oe),Ne(Re,");",N,".",oe,"=",Re,";"),x("if(",Re,"!==",Ve,"){",Ne,"}");S(Ne)}),m.compile()}(),compile:De}}function Vy(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var qy=34918,Hy=34919,_c=35007,Wy=function(h,_){if(!_.ext_disjoint_timer_query)return null;var E=[];function Y(){return E.pop()||_.ext_disjoint_timer_query.createQueryEXT()}function le(ve){E.push(ve)}var te=[];function ee(ve){var he=Y();_.ext_disjoint_timer_query.beginQueryEXT(_c,he),te.push(he),_e(te.length-1,te.length,ve)}function ge(){_.ext_disjoint_timer_query.endQueryEXT(_c)}function be(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var me=[];function Le(){return me.pop()||new be}function Ze(ve){me.push(ve)}var Pe=[];function _e(ve,he,ae){var Ce=Le();Ce.startQueryIndex=ve,Ce.endQueryIndex=he,Ce.sum=0,Ce.stats=ae,Pe.push(Ce)}var ce=[],k=[];function J(){var ve,he,ae=te.length;if(ae!==0){k.length=Math.max(k.length,ae+1),ce.length=Math.max(ce.length,ae+1),ce[0]=0,k[0]=0;var Ce=0;for(ve=0,he=0;he<te.length;++he){var Ae=te[he];_.ext_disjoint_timer_query.getQueryObjectEXT(Ae,Hy)?(Ce+=_.ext_disjoint_timer_query.getQueryObjectEXT(Ae,qy),le(Ae)):te[ve++]=Ae,ce[he+1]=Ce,k[he+1]=ve}for(te.length=ve,ve=0,he=0;he<Pe.length;++he){var Ue=Pe[he],ie=Ue.startQueryIndex,ne=Ue.endQueryIndex;Ue.sum+=ce[ne]-ce[ie];var Oe=k[ie],Z=k[ne];Z===Oe?(Ue.stats.gpuTime+=Ue.sum/1e6,Ze(Ue)):(Ue.startQueryIndex=Oe,Ue.endQueryIndex=Z,Pe[ve++]=Ue)}Pe.length=ve}}return{beginQuery:ee,endQuery:ge,pushScopeStats:_e,update:J,getNumPendingQueries:function(){return te.length},clear:function(){E.push.apply(E,te);for(var ve=0;ve<E.length;ve++)_.ext_disjoint_timer_query.deleteQueryEXT(E[ve]);te.length=0,E.length=0},restore:function(){te.length=0,E.length=0}}},Xy=16384,Yy=256,Zy=1024,Jy=34962,Ac="webglcontextlost",wc="webglcontextrestored",Tc=1,Qy=2,Ky=3;function Ec(h,_){for(var E=0;E<h.length;++E)if(h[E]===_)return E;return-1}function em(h){var _=F(h);if(!_)return null;var E=_.gl,Y=E.getContextAttributes();E.isContextLost();var le=j(E,_);if(!le)return null;var te=y(),ee=Vy(),ge=_.cachedCode||{},be=le.extensions,me=Wy(E,be),Le=g(),Ze=E.drawingBufferWidth,Pe=E.drawingBufferHeight,_e={tick:0,time:0,viewportWidth:Ze,viewportHeight:Pe,framebufferWidth:Ze,framebufferHeight:Pe,drawingBufferWidth:Ze,drawingBufferHeight:Pe,pixelRatio:_.pixelRatio},ce={},k={elements:null,primitive:4,count:-1,offset:0,instances:-1},J=xo(E,be),ve=Ao(E,ee,_,Ce),he=p0(E,be,ve,ee),ae=ty(E,be,J,ee,ve,he,k);function Ce(rr){return ae.destroyBuffer(rr)}var Ae=oy(E,te,ee,_),Ue=H0(E,be,J,function(){Oe.procs.poll()},_e,ee,_),ie=W0(E,be,J,ee,_),ne=ey(E,be,J,Ue,ie,ee),Oe=jy(E,te,be,J,ve,he,Ue,ne,ce,ae,Ae,k,_e,me,ge,_),Z=uy(E,ne,Oe.procs.poll,_e),Ee=Oe.next,de=E.canvas,$e=[],nr=[],Me=[],Ye=[_.onDestroy],we=null;function ar(){if($e.length===0){me&&me.update(),we=null;return}we=O.next(ar),Pr();for(var rr=$e.length-1;rr>=0;--rr){var ur=$e[rr];ur&&ur(_e,null,0)}E.flush(),me&&me.update()}function fr(){!we&&$e.length>0&&(we=O.next(ar))}function vr(){we&&(O.cancel(ar),we=null)}function kr(rr){rr.preventDefault(),vr(),nr.forEach(function(ur){ur()})}function sr(rr){E.getError(),le.restore(),Ae.restore(),ve.restore(),Ue.restore(),ie.restore(),ne.restore(),ae.restore(),me&&me.restore(),Oe.procs.refresh(),fr(),Me.forEach(function(ur){ur()})}de&&(de.addEventListener(Ac,kr,!1),de.addEventListener(wc,sr,!1));function at(){$e.length=0,vr(),de&&(de.removeEventListener(Ac,kr),de.removeEventListener(wc,sr)),Ae.clear(),ne.clear(),ie.clear(),ae.clear(),Ue.clear(),he.clear(),ve.clear(),me&&me.clear(),Ye.forEach(function(rr){rr()})}function xr(rr){function ur(U){var P=t({},U);delete P.uniforms,delete P.attributes,delete P.context,delete P.vao,"stencil"in P&&P.stencil.op&&(P.stencil.opBack=P.stencil.opFront=P.stencil.op,delete P.stencil.op);function D(N){if(N in P){var w=P[N];delete P[N],Object.keys(w).forEach(function(L){P[N+"."+L]=w[L]})}}return D("blend"),D("depth"),D("cull"),D("stencil"),D("polygonOffset"),D("scissor"),D("sample"),"vao"in U&&(P.vao=U.vao),P}function br(U,P){var D={},N={};return Object.keys(U).forEach(function(w){var L=U[w];if(p.isDynamic(L)){N[w]=p.unbox(L,w);return}else if(P&&Array.isArray(L)){for(var A=0;A<L.length;++A)if(p.isDynamic(L[A])){N[w]=p.unbox(L,w);return}}D[w]=L}),{dynamic:N,static:D}}var Ur=br(rr.context||{},!0),b=br(rr.uniforms||{},!0),W=br(rr.attributes||{},!1),H=br(ur(rr),!1),Be={gpuTime:0,cpuTime:0,count:0},lr=Oe.compile(H,W,b,Ur,Be),_r=lr.draw,De=lr.batch,m=lr.scope,x=[];function S(U){for(;x.length<U;)x.push(null);return x}function X(U,P){var D;if(typeof U=="function")return m.call(this,null,U,0);if(typeof P=="function")if(typeof U=="number")for(D=0;D<U;++D)m.call(this,null,P,D);else if(Array.isArray(U))for(D=0;D<U.length;++D)m.call(this,U[D],P,D);else return m.call(this,U,P,0);else if(typeof U=="number"){if(U>0)return De.call(this,S(U|0),U|0)}else if(Array.isArray(U)){if(U.length)return De.call(this,U,U.length)}else return _r.call(this,U)}return t(X,{stats:Be,destroy:function(){lr.destroy()}})}var Xr=ne.setFBO=xr({framebuffer:p.define.call(null,Tc,"framebuffer")});function it(rr,ur){var br=0;Oe.procs.poll();var Ur=ur.color;Ur&&(E.clearColor(+Ur[0]||0,+Ur[1]||0,+Ur[2]||0,+Ur[3]||0),br|=Xy),"depth"in ur&&(E.clearDepth(+ur.depth),br|=Yy),"stencil"in ur&&(E.clearStencil(ur.stencil|0),br|=Zy),E.clear(br)}function Jr(rr){if("framebuffer"in rr)if(rr.framebuffer&&rr.framebuffer_reglType==="framebufferCube")for(var ur=0;ur<6;++ur)Xr(t({framebuffer:rr.framebuffer.faces[ur]},rr),it);else Xr(rr,it);else it(null,rr)}function Mt(rr){$e.push(rr);function ur(){var br=Ec($e,rr);function Ur(){var b=Ec($e,Ur);$e[b]=$e[$e.length-1],$e.length-=1,$e.length<=0&&vr()}$e[br]=Ur}return fr(),{cancel:ur}}function zr(){var rr=Ee.viewport,ur=Ee.scissor_box;rr[0]=rr[1]=ur[0]=ur[1]=0,_e.viewportWidth=_e.framebufferWidth=_e.drawingBufferWidth=rr[2]=ur[2]=E.drawingBufferWidth,_e.viewportHeight=_e.framebufferHeight=_e.drawingBufferHeight=rr[3]=ur[3]=E.drawingBufferHeight}function Pr(){_e.tick+=1,_e.time=ht(),zr(),Oe.procs.poll()}function er(){Ue.refresh(),zr(),Oe.procs.refresh(),me&&me.update()}function ht(){return(g()-Le)/1e3}er();function yr(rr,ur){var br;switch(rr){case"frame":return Mt(ur);case"lost":br=nr;break;case"restore":br=Me;break;case"destroy":br=Ye;break}return br.push(ur),{cancel:function(){for(var Ur=0;Ur<br.length;++Ur)if(br[Ur]===ur){br[Ur]=br[br.length-1],br.pop();return}}}}function Gr(){return ge}function Qr(rr){Object.entries(rr).forEach(function(ur){ge[ur[0]]=ur[1]})}var Kr=t(xr,{clear:Jr,prop:p.define.bind(null,Tc),context:p.define.bind(null,Qy),this:p.define.bind(null,Ky),draw:xr({}),buffer:function(rr){return ve.create(rr,Jy,!1,!1)},elements:function(rr){return he.create(rr,!1)},texture:Ue.create2D,cube:Ue.createCube,renderbuffer:ie.create,framebuffer:ne.create,framebufferCube:ne.createCube,vao:ae.createVAO,attributes:Y,frame:Mt,on:yr,limits:J,hasExtension:function(rr){return J.extensions.indexOf(rr.toLowerCase())>=0},read:Z,destroy:at,_gl:E,_refresh:er,poll:function(){Pr(),me&&me.update()},now:ht,stats:ee,getCachedCode:Gr,preloadCachedCode:Qr});return _.onDone(null,Kr),Kr}return em})})(Mp);var Ip=Mp.exports,p_=dn,y_=function(e){if(e?typeof e=="string"&&(e={container:e}):e={},Bh(e)?e={container:e}:m_(e)?e={container:e}:g_(e)?e={gl:e}:e=p_(e,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),e.pixelRatio||(e.pixelRatio=un.pixelRatio||1),e.gl)return e.gl;if(e.canvas&&(e.container=e.canvas.parentNode),e.container){if(typeof e.container=="string"){var t=document.querySelector(e.container);if(!t)throw Error("Element "+e.container+" is not found");e.container=t}Bh(e.container)?(e.canvas=e.container,e.container=e.canvas.parentNode):e.canvas||(e.canvas=Dh(),e.container.appendChild(e.canvas),Nh(e))}else if(!e.canvas)if(typeof document<"u")e.container=document.body||document.documentElement,e.canvas=Dh(),e.container.appendChild(e.canvas),Nh(e);else throw Error("Not DOM environment. Use headless-gl.");return e.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(n){try{e.gl=e.canvas.getContext(n,e.attrs)}catch{}return e.gl}),e.gl};function Nh(r){if(r.container)if(r.container==document.body)document.body.style.width||(r.canvas.width=r.width||r.pixelRatio*un.innerWidth),document.body.style.height||(r.canvas.height=r.height||r.pixelRatio*un.innerHeight);else{var e=r.container.getBoundingClientRect();r.canvas.width=r.width||e.right-e.left,r.canvas.height=r.height||e.bottom-e.top}}function Bh(r){return typeof r.getContext=="function"&&"width"in r&&"height"in r}function m_(r){return typeof r.nodeName=="string"&&typeof r.appendChild=="function"&&typeof r.getBoundingClientRect=="function"}function g_(r){return typeof r.drawArrays=="function"||typeof r.drawElements=="function"}function Dh(){var r=document.createElement("canvas");return r.style.position="absolute",r.style.top=0,r.style.left=0,r}var x_=Rp,b_=[32,126],__=A_;function A_(r){r=r||{};var e=r.shape?r.shape:r.canvas?[r.canvas.width,r.canvas.height]:[512,512],t=r.canvas||document.createElement("canvas"),n=r.font,i=typeof r.step=="number"?[r.step,r.step]:r.step||[32,32],a=r.chars||b_;if(n&&typeof n!="string"&&(n=x_(n)),!Array.isArray(a))a=String(a).split("");else if(a.length===2&&typeof a[0]=="number"&&typeof a[1]=="number"){for(var o=[],f=a[0],l=0;f<=a[1];f++)o[l++]=String.fromCharCode(f);a=o}e=e.slice(),t.width=e[0],t.height=e[1];var s=t.getContext("2d");s.fillStyle="#000",s.fillRect(0,0,t.width,t.height),s.font=n,s.textAlign="center",s.textBaseline="middle",s.fillStyle="#fff";for(var u=i[0]/2,v=i[1]/2,f=0;f<a.length;f++)s.fillText(a[f],u,v),(u+=i[0])>e[0]-i[0]/2&&(u=i[0]/2,v+=i[1]);return t}var hr={},Lr={},Vs=32;Lr.INT_BITS=Vs;Lr.INT_MAX=2147483647;Lr.INT_MIN=-1<<Vs-1;Lr.sign=function(r){return(r>0)-(r<0)};Lr.abs=function(r){var e=r>>Vs-1;return(r^e)-e};Lr.min=function(r,e){return e^(r^e)&-(r<e)};Lr.max=function(r,e){return r^(r^e)&-(r<e)};Lr.isPow2=function(r){return!(r&r-1)&&!!r};Lr.log2=function(r){var e,t;return e=(r>65535)<<4,r>>>=e,t=(r>255)<<3,r>>>=t,e|=t,t=(r>15)<<2,r>>>=t,e|=t,t=(r>3)<<1,r>>>=t,e|=t,e|r>>1};Lr.log10=function(r){return r>=1e9?9:r>=1e8?8:r>=1e7?7:r>=1e6?6:r>=1e5?5:r>=1e4?4:r>=1e3?3:r>=100?2:r>=10?1:0};Lr.popCount=function(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),(r+(r>>>4)&252645135)*16843009>>>24};function Np(r){var e=32;return r&=-r,r&&e--,r&65535&&(e-=16),r&16711935&&(e-=8),r&252645135&&(e-=4),r&858993459&&(e-=2),r&1431655765&&(e-=1),e}Lr.countTrailingZeros=Np;Lr.nextPow2=function(r){return r+=r===0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1};Lr.prevPow2=function(r){return r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r-(r>>>1)};Lr.parity=function(r){return r^=r>>>16,r^=r>>>8,r^=r>>>4,r&=15,27030>>>r&1};var Ga=new Array(256);(function(r){for(var e=0;e<256;++e){var t=e,n=e,i=7;for(t>>>=1;t;t>>>=1)n<<=1,n|=t&1,--i;r[e]=n<<i&255}})(Ga);Lr.reverse=function(r){return Ga[r&255]<<24|Ga[r>>>8&255]<<16|Ga[r>>>16&255]<<8|Ga[r>>>24&255]};Lr.interleave2=function(r,e){return r&=65535,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e&=65535,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1};Lr.deinterleave2=function(r,e){return r=r>>>e&1431655765,r=(r|r>>>1)&858993459,r=(r|r>>>2)&252645135,r=(r|r>>>4)&16711935,r=(r|r>>>16)&65535,r<<16>>16};Lr.interleave3=function(r,e,t){return r&=1023,r=(r|r<<16)&4278190335,r=(r|r<<8)&251719695,r=(r|r<<4)&3272356035,r=(r|r<<2)&1227133513,e&=1023,e=(e|e<<16)&4278190335,e=(e|e<<8)&251719695,e=(e|e<<4)&3272356035,e=(e|e<<2)&1227133513,r|=e<<1,t&=1023,t=(t|t<<16)&4278190335,t=(t|t<<8)&251719695,t=(t|t<<4)&3272356035,t=(t|t<<2)&1227133513,r|t<<2};Lr.deinterleave3=function(r,e){return r=r>>>e&1227133513,r=(r|r>>>2)&3272356035,r=(r|r>>>4)&251719695,r=(r|r>>>8)&4278190335,r=(r|r>>>16)&1023,r<<22>>22};Lr.nextCombination=function(r){var e=r|r-1;return e+1|(~e&-~e)-1>>>Np(r)+1};function Bp(r,e,t){var n=r[t]|0;if(n<=0)return[];var i=new Array(n),a;if(t===r.length-1)for(a=0;a<n;++a)i[a]=e;else for(a=0;a<n;++a)i[a]=Bp(r,e,t+1);return i}function w_(r,e){var t,n;for(t=new Array(r),n=0;n<r;++n)t[n]=e;return t}function T_(r,e){switch(typeof e>"u"&&(e=0),typeof r){case"number":if(r>0)return w_(r|0,e);break;case"object":if(typeof r.length=="number")return Bp(r,e,0);break}return[]}var E_=T_;const S_={},C_=Object.freeze(Object.defineProperty({__proto__:null,default:S_},Symbol.toStringTag,{value:"Module"})),F_=Hd(C_);var cn=Lr,Yr=E_,Dp=F_.Buffer;un.__TYPEDARRAY_POOL||(un.__TYPEDARRAY_POOL={UINT8:Yr([32,0]),UINT16:Yr([32,0]),UINT32:Yr([32,0]),BIGUINT64:Yr([32,0]),INT8:Yr([32,0]),INT16:Yr([32,0]),INT32:Yr([32,0]),BIGINT64:Yr([32,0]),FLOAT:Yr([32,0]),DOUBLE:Yr([32,0]),DATA:Yr([32,0]),UINT8C:Yr([32,0]),BUFFER:Yr([32,0])});var O_=typeof Uint8ClampedArray<"u",L_=typeof BigUint64Array<"u",R_=typeof BigInt64Array<"u",Ir=un.__TYPEDARRAY_POOL;Ir.UINT8C||(Ir.UINT8C=Yr([32,0]));Ir.BIGUINT64||(Ir.BIGUINT64=Yr([32,0]));Ir.BIGINT64||(Ir.BIGINT64=Yr([32,0]));Ir.BUFFER||(Ir.BUFFER=Yr([32,0]));var co=Ir.DATA,vo=Ir.BUFFER;hr.free=function(e){if(Dp.isBuffer(e))vo[cn.log2(e.length)].push(e);else{if(Object.prototype.toString.call(e)!=="[object ArrayBuffer]"&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,n=cn.log2(t)|0;co[n].push(e)}};function kp(r){if(r){var e=r.length||r.byteLength,t=cn.log2(e);co[t].push(r)}}function M_(r){kp(r.buffer)}hr.freeUint8=hr.freeUint16=hr.freeUint32=hr.freeBigUint64=hr.freeInt8=hr.freeInt16=hr.freeInt32=hr.freeBigInt64=hr.freeFloat32=hr.freeFloat=hr.freeFloat64=hr.freeDouble=hr.freeUint8Clamped=hr.freeDataView=M_;hr.freeArrayBuffer=kp;hr.freeBuffer=function(e){vo[cn.log2(e.length)].push(e)};hr.malloc=function(e,t){if(t===void 0||t==="arraybuffer")return ft(e);switch(t){case"uint8":return qs(e);case"uint16":return zp(e);case"uint32":return Pp(e);case"int8":return Gp(e);case"int16":return Up(e);case"int32":return $p(e);case"float":case"float32":return jp(e);case"double":case"float64":return Vp(e);case"uint8_clamped":return qp(e);case"bigint64":return Wp(e);case"biguint64":return Hp(e);case"buffer":return Yp(e);case"data":case"dataview":return Xp(e);default:return null}return null};function ft(e){var e=cn.nextPow2(e),t=cn.log2(e),n=co[t];return n.length>0?n.pop():new ArrayBuffer(e)}hr.mallocArrayBuffer=ft;function qs(r){return new Uint8Array(ft(r),0,r)}hr.mallocUint8=qs;function zp(r){return new Uint16Array(ft(2*r),0,r)}hr.mallocUint16=zp;function Pp(r){return new Uint32Array(ft(4*r),0,r)}hr.mallocUint32=Pp;function Gp(r){return new Int8Array(ft(r),0,r)}hr.mallocInt8=Gp;function Up(r){return new Int16Array(ft(2*r),0,r)}hr.mallocInt16=Up;function $p(r){return new Int32Array(ft(4*r),0,r)}hr.mallocInt32=$p;function jp(r){return new Float32Array(ft(4*r),0,r)}hr.mallocFloat32=hr.mallocFloat=jp;function Vp(r){return new Float64Array(ft(8*r),0,r)}hr.mallocFloat64=hr.mallocDouble=Vp;function qp(r){return O_?new Uint8ClampedArray(ft(r),0,r):qs(r)}hr.mallocUint8Clamped=qp;function Hp(r){return L_?new BigUint64Array(ft(8*r),0,r):null}hr.mallocBigUint64=Hp;function Wp(r){return R_?new BigInt64Array(ft(8*r),0,r):null}hr.mallocBigInt64=Wp;function Xp(r){return new DataView(ft(r),0,r)}hr.mallocDataView=Xp;function Yp(r){r=cn.nextPow2(r);var e=cn.log2(r),t=vo[e];return t.length>0?t.pop():new Dp(r)}hr.mallocBuffer=Yp;hr.clearCache=function(){for(var e=0;e<32;++e)Ir.UINT8[e].length=0,Ir.UINT16[e].length=0,Ir.UINT32[e].length=0,Ir.INT8[e].length=0,Ir.INT16[e].length=0,Ir.INT32[e].length=0,Ir.FLOAT[e].length=0,Ir.DOUBLE[e].length=0,Ir.BIGUINT64[e].length=0,Ir.BIGINT64[e].length=0,Ir.UINT8C[e].length=0,co[e].length=0,vo[e].length=0};var I_=Object.prototype.toString,N_=function(r){var e;return I_.call(r)==="[object Object]"&&(e=Object.getPrototypeOf(r),e===null||e===Object.getPrototypeOf({}))},Zp=function(e,t){t||(t=[0,""]),e=String(e);var n=parseFloat(e,10);return t[0]=n,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t},B_=Zp,D_=Jp,za=96;function Cs(r,e){var t=B_(getComputedStyle(r).getPropertyValue(e));return t[0]*Jp(t[1],r)}function k_(r,e){var t=document.createElement("div");t.style["font-size"]="128"+r,e.appendChild(t);var n=Cs(t,"font-size")/128;return e.removeChild(t),n}function Jp(r,e){switch(e=e||document.body,r=(r||"px").trim().toLowerCase(),(e===window||e===document)&&(e=document.body),r){case"%":return e.clientHeight/100;case"ch":case"ex":return k_(r,e);case"em":return Cs(e,"font-size");case"rem":return Cs(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return za;case"cm":return za/2.54;case"mm":return za/25.4;case"pt":return za/72;case"pc":return za/6}return 1}var z_=ho,P_=ho.canvas=document.createElement("canvas"),zi=P_.getContext("2d"),Qp=Qi([32,126]);ho.createPairs=Qi;ho.ascii=Qp;function ho(r,e){Array.isArray(r)&&(r=r.join(", "));var t={},n,i=16,a=.05;e&&(e.length===2&&typeof e[0]=="number"?n=Qi(e):Array.isArray(e)?n=e:(e.o?n=Qi(e.o):e.pairs&&(n=e.pairs),e.fontSize&&(i=e.fontSize),e.threshold!=null&&(a=e.threshold))),n||(n=Qp),zi.font=i+"px "+r;for(var o=0;o<n.length;o++){var f=n[o],l=zi.measureText(f[0]).width+zi.measureText(f[1]).width,s=zi.measureText(f).width;if(Math.abs(l-s)>i*a){var u=(s-l)/i;t[f]=u*1e3}}return t}function Qi(r){for(var e=[],t=r[0];t<=r[1];t++)for(var n=String.fromCharCode(t),i=r[0];i<r[1];i++){var a=String.fromCharCode(i),o=n+a;e.push(o)}return e}var G_=sn;sn.canvas=document.createElement("canvas");sn.cache={};function sn(o,e){e||(e={}),(typeof o=="string"||Array.isArray(o))&&(e.family=o);var t=Array.isArray(e.family)?e.family.join(", "):e.family;if(!t)throw Error("`family` must be defined");var n=e.size||e.fontSize||e.em||48,i=e.weight||e.fontWeight||"",a=e.style||e.fontStyle||"",o=[a,i,n].join(" ")+"px "+t,f=e.origin||"top";if(sn.cache[t]&&n<=sn.cache[t].em)return kh(sn.cache[t],f);var l=e.canvas||sn.canvas,s=l.getContext("2d"),u={upper:e.upper!==void 0?e.upper:"H",lower:e.lower!==void 0?e.lower:"x",descent:e.descent!==void 0?e.descent:"p",ascent:e.ascent!==void 0?e.ascent:"h",tittle:e.tittle!==void 0?e.tittle:"i",overshoot:e.overshoot!==void 0?e.overshoot:"O"},v=Math.ceil(n*1.5);l.height=v,l.width=v*.5,s.font=o;var d="H",c={top:0};s.clearRect(0,0,v,v),s.textBaseline="top",s.fillStyle="black",s.fillText(d,0,0);var p=Gt(s.getImageData(0,0,v,v));s.clearRect(0,0,v,v),s.textBaseline="bottom",s.fillText(d,0,v);var O=Gt(s.getImageData(0,0,v,v));c.lineHeight=c.bottom=v-O+p,s.clearRect(0,0,v,v),s.textBaseline="alphabetic",s.fillText(d,0,v);var g=Gt(s.getImageData(0,0,v,v)),y=v-g-1+p;c.baseline=c.alphabetic=y,s.clearRect(0,0,v,v),s.textBaseline="middle",s.fillText(d,0,v*.5);var R=Gt(s.getImageData(0,0,v,v));c.median=c.middle=v-R-1+p-v*.5,s.clearRect(0,0,v,v),s.textBaseline="hanging",s.fillText(d,0,v*.5);var T=Gt(s.getImageData(0,0,v,v));c.hanging=v-T-1+p-v*.5,s.clearRect(0,0,v,v),s.textBaseline="ideographic",s.fillText(d,0,v);var M=Gt(s.getImageData(0,0,v,v));if(c.ideographic=v-M-1+p,u.upper&&(s.clearRect(0,0,v,v),s.textBaseline="top",s.fillText(u.upper,0,0),c.upper=Gt(s.getImageData(0,0,v,v)),c.capHeight=c.baseline-c.upper),u.lower&&(s.clearRect(0,0,v,v),s.textBaseline="top",s.fillText(u.lower,0,0),c.lower=Gt(s.getImageData(0,0,v,v)),c.xHeight=c.baseline-c.lower),u.tittle&&(s.clearRect(0,0,v,v),s.textBaseline="top",s.fillText(u.tittle,0,0),c.tittle=Gt(s.getImageData(0,0,v,v))),u.ascent&&(s.clearRect(0,0,v,v),s.textBaseline="top",s.fillText(u.ascent,0,0),c.ascent=Gt(s.getImageData(0,0,v,v))),u.descent&&(s.clearRect(0,0,v,v),s.textBaseline="top",s.fillText(u.descent,0,0),c.descent=zh(s.getImageData(0,0,v,v))),u.overshoot){s.clearRect(0,0,v,v),s.textBaseline="top",s.fillText(u.overshoot,0,0);var B=zh(s.getImageData(0,0,v,v));c.overshoot=B-y}for(var V in c)c[V]/=n;return c.em=n,sn.cache[t]=c,kh(c,f)}function kh(r,e){var t={};typeof e=="string"&&(e=r[e]);for(var n in r)n!=="em"&&(t[n]=r[n]-e);return t}function Gt(r){for(var e=r.height,t=r.data,n=3;n<t.length;n+=4)if(t[n]!==0)return Math.floor((n-3)*.25/e)}function zh(r){for(var e=r.height,t=r.data,n=t.length-1;n>0;n-=4)if(t[n]!==0)return Math.floor((n-3)*.25/e)}var oa=d_,U_=dn,$_=Ip,j_=y_,V_=_p,as=Ya,q_=__,ln=hr,H_=ao,W_=N_,X_=Zp,Y_=D_,Z_=z_,J_=ri,Q_=G_,K_=Ka,e2=Lr,Ph=e2.nextPow2,Gh=new V_,Xi=!1;if(document.body){var is=document.body.appendChild(document.createElement("div"));is.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(is).fontStretch&&(Xi=!0),document.body.removeChild(is)}var dr=function(e){r2(e)?(e={regl:e},this.gl=e.regl._gl):this.gl=j_(e),this.shader=Gh.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=e.regl||$_({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),Gh.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(W_(e)?e:{})};dr.prototype.createShader=function(){var e=this.regl,t=e({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:e.prop("count"),offset:e.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:e.this("sizeBuffer")},width:{offset:0,stride:8,buffer:e.this("sizeBuffer")},char:e.this("charBuffer"),position:e.this("position")},uniforms:{atlasSize:function(i,a){return[a.atlas.width,a.atlas.height]},atlasDim:function(i,a){return[a.atlas.cols,a.atlas.rows]},atlas:function(i,a){return a.atlas.texture},charStep:function(i,a){return a.atlas.step},em:function(i,a){return a.atlas.em},color:e.prop("color"),opacity:e.prop("opacity"),viewport:e.this("viewportArray"),scale:e.this("scale"),align:e.prop("align"),baseline:e.prop("baseline"),translate:e.this("translate"),positionOffset:e.prop("positionOffset")},primitive:"points",viewport:e.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`}),n={};return{regl:e,draw:t,atlas:n}};dr.prototype.update=function(e){var t=this;if(typeof e=="string")e={text:e};else if(!e)return;e=U_(e,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0),e.opacity!=null&&(Array.isArray(e.opacity)?this.opacity=e.opacity.map(function(pe){return parseFloat(pe)}):this.opacity=parseFloat(e.opacity)),e.viewport!=null&&(this.viewport=H_(e.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),e.kerning!=null&&(this.kerning=e.kerning),e.offset!=null&&(typeof e.offset=="number"&&(e.offset=[e.offset,0]),this.positionOffset=K_(e.offset)),e.direction&&(this.direction=e.direction),e.range&&(this.range=e.range,this.scale=[1/(e.range[2]-e.range[0]),1/(e.range[3]-e.range[1])],this.translate=[-e.range[0],-e.range[1]]),e.scale&&(this.scale=e.scale),e.translate&&(this.translate=e.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),!this.font.length&&!e.font&&(e.font=dr.baseFontSize+"px sans-serif");var n=!1,i=!1;if(e.font&&(Array.isArray(e.font)?e.font:[e.font]).forEach(function(pe,Se){if(typeof pe=="string")try{pe=oa.parse(pe)}catch{pe=oa.parse(dr.baseFontSize+"px "+pe)}else{var xe=pe.style,je=pe.weight,tr=pe.stretch,He=pe.variant;pe=oa.parse(oa.stringify(pe)),xe&&(pe.style=xe),je&&(pe.weight=je),tr&&(pe.stretch=tr),He&&(pe.variant=He)}var Je=oa.stringify({size:dr.baseFontSize,family:pe.family,stretch:Xi?pe.stretch:void 0,variant:pe.variant,weight:pe.weight,style:pe.style}),or=X_(pe.size),ir=Math.round(or[0]*Y_(or[1]));if(ir!==t.fontSize[Se]&&(i=!0,t.fontSize[Se]=ir),(!t.font[Se]||Je!=t.font[Se].baseString)&&(n=!0,t.font[Se]=dr.fonts[Je],!t.font[Se])){var Rr=pe.family.join(", "),Sr=[pe.style];pe.style!=pe.variant&&Sr.push(pe.variant),pe.variant!=pe.weight&&Sr.push(pe.weight),Xi&&pe.weight!=pe.stretch&&Sr.push(pe.stretch),t.font[Se]={baseString:Je,family:Rr,weight:pe.weight,stretch:pe.stretch,style:pe.style,variant:pe.variant,width:{},kerning:{},metrics:Q_(Rr,{origin:"top",fontSize:dr.baseFontSize,fontStyle:Sr.join(" ")})},dr.fonts[Je]=t.font[Se]}}),(n||i)&&this.font.forEach(function(pe,Se){var xe=oa.stringify({size:t.fontSize[Se],family:pe.family,stretch:Xi?pe.stretch:void 0,variant:pe.variant,weight:pe.weight,style:pe.style});if(t.fontAtlas[Se]=t.shader.atlas[xe],!t.fontAtlas[Se]){var je=pe.metrics;t.shader.atlas[xe]=t.fontAtlas[Se]={fontString:xe,step:Math.ceil(t.fontSize[Se]*je.bottom*.5)*2,em:t.fontSize[Se],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:t.regl.texture()}}e.text==null&&(e.text=t.text)}),typeof e.text=="string"&&e.position&&e.position.length>2){for(var a=Array(e.position.length*.5),o=0;o<a.length;o++)a[o]=e.text;e.text=a}var f;if(e.text!=null||n){if(this.textOffsets=[0],Array.isArray(e.text)){this.count=e.text[0].length,this.counts=[this.count];for(var l=1;l<e.text.length;l++)this.textOffsets[l]=this.textOffsets[l-1]+e.text[l-1].length,this.count+=e.text[l].length,this.counts.push(e.text[l].length);this.text=e.text.join("")}else this.text=e.text,this.count=this.text.length,this.counts=[this.count];f=[],this.font.forEach(function(pe,Se){dr.atlasContext.font=pe.baseString;for(var xe=t.fontAtlas[Se],je=0;je<t.text.length;je++){var tr=t.text.charAt(je);if(xe.ids[tr]==null&&(xe.ids[tr]=xe.chars.length,xe.chars.push(tr),f.push(tr)),pe.width[tr]==null&&(pe.width[tr]=dr.atlasContext.measureText(tr).width/dr.baseFontSize,t.kerning)){var He=[];for(var Je in pe.width)He.push(Je+tr,tr+Je);J_(pe.kerning,Z_(pe.family,{pairs:He}))}}})}if(e.position)if(e.position.length>2){for(var s=!e.position[0].length,u=ln.mallocFloat(this.count*2),v=0,d=0;v<this.counts.length;v++){var c=this.counts[v];if(s)for(var p=0;p<c;p++)u[d++]=e.position[v*2],u[d++]=e.position[v*2+1];else for(var O=0;O<c;O++)u[d++]=e.position[v][0],u[d++]=e.position[v][1]}this.position.call?this.position({type:"float",data:u}):this.position=this.regl.buffer({type:"float",data:u}),ln.freeFloat(u)}else this.position.destroy&&this.position.destroy(),this.position={constant:e.position};if(e.text||n){var g=ln.mallocUint8(this.count),y=ln.mallocFloat(this.count*2);this.textWidth=[];for(var R=0,T=0;R<this.counts.length;R++){for(var M=this.counts[R],B=this.font[R]||this.font[0],V=this.fontAtlas[R]||this.fontAtlas[0],I=0;I<M;I++){var F=this.text.charAt(T),j=this.text.charAt(T-1);if(g[T]=V.ids[F],y[T*2]=B.width[F],I){var z=y[T*2-2],q=y[T*2],C=y[T*2-1],G=C+z*.5+q*.5;if(this.kerning){var Q=B.kerning[j+F];Q&&(G+=Q*.001)}y[T*2+1]=G}else y[T*2+1]=y[T*2]*.5;T++}this.textWidth.push(y.length?y[T*2-2]*.5+y[T*2-1]:0)}e.align||(e.align=this.align),this.charBuffer({data:g,type:"uint8",usage:"stream"}),this.sizeBuffer({data:y,type:"float",usage:"stream"}),ln.freeUint8(g),ln.freeFloat(y),f.length&&this.font.forEach(function(pe,Se){var xe=t.fontAtlas[Se],je=xe.step,tr=Math.floor(dr.maxAtlasSize/je),He=Math.min(tr,xe.chars.length),Je=Math.ceil(xe.chars.length/He),or=Ph(He*je),ir=Ph(Je*je);xe.width=or,xe.height=ir,xe.rows=Je,xe.cols=He,xe.em&&xe.texture({data:q_({canvas:dr.atlasCanvas,font:xe.fontString,chars:xe.chars,shape:[or,ir],step:[je,je]})})})}if(e.align&&(this.align=e.align,this.alignOffset=this.textWidth.map(function(pe,Se){var xe=Array.isArray(t.align)?t.align.length>1?t.align[Se]:t.align[0]:t.align;if(typeof xe=="number")return xe;switch(xe){case"right":case"end":return-pe;case"center":case"centre":case"middle":return-pe*.5}return 0})),this.baseline==null&&e.baseline==null&&(e.baseline=0),e.baseline!=null&&(this.baseline=e.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(pe,Se){var xe=(t.font[Se]||t.font[0]).metrics,je=0;return je+=xe.bottom*.5,typeof pe=="number"?je+=pe-xe.baseline:je+=-xe[pe],je*=-1,je})),e.color!=null)if(e.color||(e.color="transparent"),typeof e.color=="string"||!isNaN(e.color))this.color=as(e.color,"uint8");else{var fe;if(typeof e.color[0]=="number"&&e.color.length>this.counts.length){var ue=e.color.length;fe=ln.mallocUint8(ue);for(var K=(e.color.subarray||e.color.slice).bind(e.color),se=0;se<ue;se+=4)fe.set(as(K(se,se+4),"uint8"),se)}else{var Te=e.color.length;fe=ln.mallocUint8(Te*4);for(var ye=0;ye<Te;ye++)fe.set(as(e.color[ye]||0,"uint8"),ye*4)}this.color=fe}if(e.position||e.text||e.color||e.baseline||e.align||e.font||e.offset||e.opacity){var Fe=this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2;if(Fe){var Qe=Math.max(this.position.length*.5||0,this.color.length*.25||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,this.positionOffset.length*.5||0);this.batch=Array(Qe);for(var qe=0;qe<this.batch.length;qe++)this.batch[qe]={count:this.counts.length>1?this.counts[qe]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[qe]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(qe*4,qe*4+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[qe]:this.opacity,baseline:this.baselineOffset[qe]!=null?this.baselineOffset[qe]:this.baselineOffset[0],align:this.align?this.alignOffset[qe]!=null?this.alignOffset[qe]:this.alignOffset[0]:0,atlas:this.fontAtlas[qe]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(qe*2,qe*2+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]}};dr.prototype.destroy=function(){};dr.prototype.kerning=!0;dr.prototype.position={constant:new Float32Array(2)};dr.prototype.translate=null;dr.prototype.scale=null;dr.prototype.font=null;dr.prototype.text="";dr.prototype.positionOffset=[0,0];dr.prototype.opacity=1;dr.prototype.color=new Uint8Array([0,0,0,255]);dr.prototype.alignOffset=[0,0];dr.maxAtlasSize=1024;dr.atlasCanvas=document.createElement("canvas");dr.atlasContext=dr.atlasCanvas.getContext("2d",{alpha:!1});dr.baseFontSize=64;dr.fonts={};function r2(r){return typeof r=="function"&&r._gl&&r.prop&&r.texture&&r.buffer}var t2=dr,n2=bm,a2=Ip,i2=function(e,t,n){var i=e._fullLayout,a=!0;return i._glcanvas.each(function(o){if(o.regl){o.regl.preloadCachedCode(n);return}if(!(o.pick&&!i._has("parcoords"))){try{o.regl=a2({canvas:this,attributes:{antialias:!o.pick,preserveDrawingBuffer:!0},pixelRatio:e._context.plotGlPixelRatio||un.devicePixelRatio,extensions:t||[],cachedCode:n||{}})}catch{a=!1}o.regl||(a=!1),a&&this.addEventListener("webglcontextlost",function(f){e&&e.emit&&e.emit("plotly_webglcontextlost",{event:f,layer:o.key})},!1)}}),a||n2({container:i._glcontainer.node()}),a},Uh=f1,$h=zb,o2=Vb,jh=t2,os=wr,l2=_m.selectMode,f2=i2,s2=eo,u2=Am,c2=tp.styleTextSelection,Kp={};function v2(r,e,t,n){var i=r._size,a=r.width*n,o=r.height*n,f=i.l*n,l=i.b*n,s=i.r*n,u=i.t*n,v=i.w*n,d=i.h*n;return[f+e.domain[0]*v,l+t.domain[0]*d,a-s-(1-e.domain[1])*v,o-u-(1-t.domain[1])*d]}var h2=np.exports=function(e,t,n){if(n.length){var i=e._fullLayout,a=t._scene,o=t.xaxis,f=t.yaxis,l,s;if(a){var u=f2(e,["ANGLE_instanced_arrays","OES_element_index_uint"],Kp);if(!u){a.init();return}var v=a.count,d=i._glcanvas.data()[0].regl;if(u2(e,t,n),a.dirty){if((a.line2d||a.error2d)&&!(a.scatter2d||a.fill2d||a.glText)&&d.clear({}),a.error2d===!0&&(a.error2d=o2(d)),a.line2d===!0&&(a.line2d=$h(d)),a.scatter2d===!0&&(a.scatter2d=Uh(d)),a.fill2d===!0&&(a.fill2d=$h(d)),a.glText===!0)for(a.glText=new Array(v),l=0;l<v;l++)a.glText[l]=new jh(d);if(a.glText){if(v>a.glText.length){var c=v-a.glText.length;for(l=0;l<c;l++)a.glText.push(new jh(d))}else if(v<a.glText.length){var p=a.glText.length-v,O=a.glText.splice(v,p);O.forEach(function(Te){Te.destroy()})}for(l=0;l<v;l++)a.glText[l].update(a.textOptions[l])}if(a.line2d&&(a.line2d.update(a.lineOptions),a.lineOptions=a.lineOptions.map(function(Te){if(Te&&Te.positions){for(var ye=Te.positions,Fe=0;Fe<ye.length&&(isNaN(ye[Fe])||isNaN(ye[Fe+1]));)Fe+=2;for(var Qe=ye.length-2;Qe>Fe&&(isNaN(ye[Qe])||isNaN(ye[Qe+1]));)Qe-=2;Te.positions=ye.slice(Fe,Qe+2)}return Te}),a.line2d.update(a.lineOptions)),a.error2d){var g=(a.errorXOptions||[]).concat(a.errorYOptions||[]);a.error2d.update(g)}a.scatter2d&&a.scatter2d.update(a.markerOptions),a.fillOrder=os.repeat(null,v),a.fill2d&&(a.fillOptions=a.fillOptions.map(function(Te,ye){var Fe=n[ye];if(!(!Te||!Fe||!Fe[0]||!Fe[0].trace)){var Qe=Fe[0],qe=Qe.trace,pe=Qe.t,Se=a.lineOptions[ye],xe,je,tr=[];qe._ownfill&&tr.push(ye),qe._nexttrace&&tr.push(ye+1),tr.length&&(a.fillOrder[ye]=tr);var He=[],Je=Se&&Se.positions||pe.positions,or,ir;if(qe.fill==="tozeroy"){for(or=0;or<Je.length&&isNaN(Je[or+1]);)or+=2;for(ir=Je.length-2;ir>or&&isNaN(Je[ir+1]);)ir-=2;Je[or+1]!==0&&(He=[Je[or],0]),He=He.concat(Je.slice(or,ir+2)),Je[ir+1]!==0&&(He=He.concat([Je[ir],0]))}else if(qe.fill==="tozerox"){for(or=0;or<Je.length&&isNaN(Je[or]);)or+=2;for(ir=Je.length-2;ir>or&&isNaN(Je[ir]);)ir-=2;Je[or]!==0&&(He=[0,Je[or+1]]),He=He.concat(Je.slice(or,ir+2)),Je[ir]!==0&&(He=He.concat([0,Je[ir+1]]))}else if(qe.fill==="toself"||qe.fill==="tonext"){for(He=[],xe=0,Te.splitNull=!0,je=0;je<Je.length;je+=2)(isNaN(Je[je])||isNaN(Je[je+1]))&&(He=He.concat(Je.slice(xe,je)),He.push(Je[xe],Je[xe+1]),He.push(null,null),xe=je+2);He=He.concat(Je.slice(xe)),xe&&He.push(Je[xe],Je[xe+1])}else{var Rr=qe._nexttrace;if(Rr){var Sr=a.lineOptions[ye+1];if(Sr){var Nr=Sr.positions;if(qe.fill==="tonexty"){for(He=Je.slice(),ye=Math.floor(Nr.length/2);ye--;){var pr=Nr[ye*2],st=Nr[ye*2+1];isNaN(pr)||isNaN(st)||He.push(pr,st)}Te.fill=Rr.fillcolor}}}}if(qe._prevtrace&&qe._prevtrace.fill==="tonext"){var cr=a.lineOptions[ye-1].positions,Hr=He.length/2;xe=Hr;var Wr=[xe];for(je=0;je<cr.length;je+=2)(isNaN(cr[je])||isNaN(cr[je+1]))&&(Wr.push(je/2+Hr+1),xe=je+2);He=He.concat(cr),Te.hole=Wr}return Te.fillmode=qe.fill,Te.opacity=qe.opacity,Te.positions=He,Te}}),a.fill2d.update(a.fillOptions))}var y=i.dragmode,R=l2(y),T=i.clickmode.indexOf("select")>-1;for(l=0;l<v;l++){var M=n[l][0],B=M.trace,V=M.t,I=V.index,F=B._length,j=V.x,z=V.y;if(B.selectedpoints||R||T){if(R||(R=!0),B.selectedpoints){var q=a.selectBatch[I]=os.selIndices2selPoints(B),C={};for(s=0;s<q.length;s++)C[q[s]]=1;var G=[];for(s=0;s<F;s++)C[s]||G.push(s);a.unselectBatch[I]=G}var Q=V.xpx=new Array(F),fe=V.ypx=new Array(F);for(s=0;s<F;s++)Q[s]=o.c2p(j[s]),fe[s]=f.c2p(z[s])}else V.xpx=V.ypx=null}if(R){if(a.select2d||(a.select2d=Uh(i._glcanvas.data()[1].regl)),a.scatter2d){var ue=new Array(v);for(l=0;l<v;l++)ue[l]=a.selectBatch[l].length||a.unselectBatch[l].length?a.markerUnselectedOptions[l]:{};a.scatter2d.update(ue)}a.select2d&&(a.select2d.update(a.markerOptions),a.select2d.update(a.markerSelectedOptions)),a.glText&&n.forEach(function(Te){var ye=((Te||[])[0]||{}).trace||{};s2.hasText(ye)&&c2(Te)})}else a.scatter2d&&a.scatter2d.update(a.markerOptions);var K={viewport:v2(i,o,f,e._context.plotGlPixelRatio),range:[(o._rl||o.range)[0],(f._rl||f.range)[0],(o._rl||o.range)[1],(f._rl||f.range)[1]]},se=os.repeat(K,a.count);a.fill2d&&a.fill2d.update(se),a.line2d&&a.line2d.update(se),a.error2d&&a.error2d.update(se.concat(se)),a.scatter2d&&a.scatter2d.update(se),a.select2d&&a.select2d.update(se),a.glText&&a.glText.forEach(function(Te){Te.update(K)})}}};h2.reglPrecompiled=Kp;var d2=np.exports,e0=Ix;e0.plot=d2;var p2=e0,y2=p2;const m2=Ds(y2);var pt=Rs,g2=Bd,x2=Ns,ls=Ls.axisHoverFormat,b2=Vd.hovertemplateAttrs,_2=Vd.texttemplateAttrs,A2=Is,lt=Ms.extendFlat,w2=lt({z:{valType:"data_array",editType:"calc",description:"Sets the z data."},x:lt({},pt.x,{impliedEdits:{xtype:"array"}}),x0:lt({},pt.x0,{impliedEdits:{xtype:"scaled"}}),dx:lt({},pt.dx,{impliedEdits:{xtype:"scaled"}}),y:lt({},pt.y,{impliedEdits:{ytype:"array"}}),y0:lt({},pt.y0,{impliedEdits:{ytype:"scaled"}}),dy:lt({},pt.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:lt({},pt.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:lt({},pt.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:lt({},pt.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:lt({},pt.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:lt({},pt.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:lt({},pt.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc",description:"Sets the text elements associated with each z value."},hovertext:{valType:"data_array",editType:"calc",description:"Same as `text`."},transpose:{valType:"boolean",dflt:!1,editType:"calc",description:"Transposes the z data."},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes",description:["If *array*, the heatmap's x coordinates are given by *x*","(the default behavior when `x` is provided).","If *scaled*, the heatmap's x coordinates are given by *x0* and *dx*","(the default behavior when `x` is not provided)."].join(" ")},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes",description:["If *array*, the heatmap's y coordinates are given by *y*","(the default behavior when `y` is provided)","If *scaled*, the heatmap's y coordinates are given by *y0* and *dy*","(the default behavior when `y` is not provided)"].join(" ")},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc",description:["Picks a smoothing algorithm use to smooth `z` data."].join(" ")},hoverongaps:{valType:"boolean",dflt:!0,editType:"none",description:["Determines whether or not gaps","(i.e. {nan} or missing values)","in the `z` data have hover labels associated with them."].join(" ")},connectgaps:{valType:"boolean",editType:"calc",description:["Determines whether or not gaps","(i.e. {nan} or missing values)","in the `z` data are filled in.","It is defaulted to true if `z` is a","one dimensional array and `zsmooth` is not false;","otherwise it is defaulted to false."].join(" ")},xgap:{valType:"number",dflt:0,min:0,editType:"plot",description:"Sets the horizontal gap (in pixels) between bricks."},ygap:{valType:"number",dflt:0,min:0,editType:"plot",description:"Sets the vertical gap (in pixels) between bricks."},xhoverformat:ls("x"),yhoverformat:ls("y"),zhoverformat:ls("z",1),hovertemplate:b2(),texttemplate:_2({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:x2({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style",description:"Sets the text font."}),showlegend:lt({},g2.showlegend,{dflt:!1}),zorder:pt.zorder},{transforms:void 0},A2("",{cLetter:"z",autoColorDflt:!1})),Hs={COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}},Cr=w2,Yi=Rs,r0=Ls,fs=r0.axisHoverFormat,T2=r0.descriptionOnlyNumbers,E2=Is,S2=wm.dash,C2=Ns,la=Ms.extendFlat,t0=Hs,Vh=t0.COMPARISON_OPS2,qh=t0.INTERVAL_OPS,Hh=Yi.line,n0=la({z:Cr.z,x:Cr.x,x0:Cr.x0,dx:Cr.dx,y:Cr.y,y0:Cr.y0,dy:Cr.dy,xperiod:Cr.xperiod,yperiod:Cr.yperiod,xperiod0:Yi.xperiod0,yperiod0:Yi.yperiod0,xperiodalignment:Cr.xperiodalignment,yperiodalignment:Cr.yperiodalignment,text:Cr.text,hovertext:Cr.hovertext,transpose:Cr.transpose,xtype:Cr.xtype,ytype:Cr.ytype,xhoverformat:fs("x"),yhoverformat:fs("y"),zhoverformat:fs("z",1),hovertemplate:Cr.hovertemplate,texttemplate:la({},Cr.texttemplate,{description:["For this trace it only has an effect if `coloring` is set to *heatmap*.",Cr.texttemplate.description].join(" ")}),textfont:la({},Cr.textfont,{description:["For this trace it only has an effect if `coloring` is set to *heatmap*.",Cr.textfont.description].join(" ")}),hoverongaps:Cr.hoverongaps,connectgaps:la({},Cr.connectgaps,{description:["Determines whether or not gaps","(i.e. {nan} or missing values)","in the `z` data are filled in.","It is defaulted to true if `z` is a","one dimensional array","otherwise it is defaulted to false."].join(" ")}),fillcolor:{valType:"color",editType:"calc",description:["Sets the fill color if `contours.type` is *constraint*.","Defaults to a half-transparent variant of the line color,","marker color, or marker line color, whichever is available."].join(" ")},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0},description:["Determines whether or not the contour level attributes are","picked by an algorithm.","If *true*, the number of contour levels can be set in `ncontours`.","If *false*, set the contour level attributes in `contours`."].join(" ")},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc",description:["Sets the maximum number of contour levels. The actual number","of contours will be chosen automatically to be less than or","equal to the value of `ncontours`.","Has an effect only if `autocontour` is *true* or if","`contours.size` is missing."].join(" ")},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc",description:["If `levels`, the data is represented as a contour plot with multiple","levels displayed. If `constraint`, the data is represented as constraints","with the invalid region shaded as specified by the `operation` and","`value` parameters."].join(" ")},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1},description:["Sets the starting contour level value.","Must be less than `contours.end`"].join(" ")},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1},description:["Sets the end contour level value.","Must be more than `contours.start`"].join(" ")},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1},description:["Sets the step between each contour level.","Must be positive."].join(" ")},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc",description:["Determines the coloring method showing the contour values.","If *fill*, coloring is done evenly between each contour level","If *heatmap*, a heatmap gradient coloring is applied","between each contour level.","If *lines*, coloring is done on the contour lines.","If *none*, no coloring is applied on this trace."].join(" ")},showlines:{valType:"boolean",dflt:!0,editType:"plot",description:["Determines whether or not the contour lines are drawn.","Has an effect only if `contours.coloring` is set to *fill*."].join(" ")},showlabels:{valType:"boolean",dflt:!1,editType:"plot",description:["Determines whether to label the contour lines with their values."].join(" ")},labelfont:C2({editType:"plot",colorEditType:"style",description:["Sets the font used for labeling the contour levels.","The default color comes from the lines, if shown.","The default family and size come from `layout.font`."].join(" ")}),labelformat:{valType:"string",dflt:"",editType:"plot",description:T2("contour label")},operation:{valType:"enumerated",values:[].concat(Vh).concat(qh),dflt:"=",editType:"calc",description:["Sets the constraint operation.","*=* keeps regions equal to `value`","*<* and *<=* keep regions less than `value`","*>* and *>=* keep regions greater than `value`","*[]*, *()*, *[)*, and *(]* keep regions inside `value[0]` to `value[1]`","*][*, *)(*, *](*, *)[* keep regions outside `value[0]` to value[1]`","Open vs. closed intervals make no difference to constraint display, but","all versions are allowed for consistency with filter transforms."].join(" ")},value:{valType:"any",dflt:0,editType:"calc",description:["Sets the value or values of the constraint boundary.","When `operation` is set to one of the comparison values","("+Vh+")","*value* is expected to be a number.","When `operation` is set to one of the interval values","("+qh+")","*value* is expected to be an array of two numbers where the first","is the lower bound and the second is the upper bound."].join(" ")},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:la({},Hh.color,{editType:"style+colorbars",description:["Sets the color of the contour level.","Has no effect if `contours.coloring` is set to *lines*."].join(" ")}),width:{valType:"number",min:0,editType:"style+colorbars",description:["Sets the contour line width in (in px)","Defaults to *0.5* when `contours.type` is *levels*.","Defaults to *2* when `contour.type` is *constraint*."].join(" ")},dash:S2,smoothing:la({},Hh.smoothing,{description:["Sets the amount of smoothing for the contour lines,","where *0* corresponds to no smoothing."].join(" ")}),editType:"plot"},zorder:Yi.zorder},E2("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"})),F2=Ln,Zi=wr,O2=vn,L2=function(e,t,n,i,a,o){var f=n("z");a=a||"x",o=o||"y";var l,s;if(f===void 0||!f.length)return 0;if(Zi.isArray1D(f)){l=n(a),s=n(o);var u=Zi.minRowLength(l),v=Zi.minRowLength(s);if(u===0||v===0)return 0;t._length=Math.min(u,v,f.length)}else{if(l=Wh(a,n),s=Wh(o,n),!R2(f))return 0;n("transpose"),t._length=null}if(e.type==="heatmapgl")return!0;var d=O2.getComponentMethod("calendars","handleTraceDefaults");return d(e,t,[a,o],i),!0};function Wh(r,e){var t=e(r),n=t?e(r+"type","array"):"scaled";return n==="scaled"&&(e(r+"0"),e("d"+r)),t}function R2(r){for(var e=!0,t=!1,n=!1,i,a=0;a<r.length;a++){if(i=r[a],!Zi.isArrayOrTypedArray(i)){e=!1;break}i.length>0&&(t=!0);for(var o=0;o<i.length;o++)if(F2(i[o])){n=!0;break}}return e&&t&&n}var M2=wr,a0=function(e,t,n,i){i||(i={});var a=e("contours.showlabels");if(a){var o=t.font;M2.coerceFont(e,"contours.labelfont",o,{overrideDflt:{color:n}}),e("contours.labelformat")}i.hasHover!==!1&&e("zhoverformat")},Xh=Ln,I2=a0,i0=ro,Yh=i0.addOpacity,N2=i0.opacity,o0=Hs,Zh=wr.isArrayOrTypedArray,B2=o0.CONSTRAINT_REDUCTION,D2=o0.COMPARISON_OPS2,k2=function(e,t,n,i,a,o){var f=t.contours,l,s,u,v=n("contours.operation");if(f._operation=B2[v],z2(n,f),v==="="?l=f.showlines=!0:(l=n("contours.showlines"),u=n("fillcolor",Yh((e.line||{}).color||a,.5))),l){var d=u&&N2(u)?Yh(t.fillcolor,1):a;s=n("line.color",d),n("line.width",2),n("line.dash")}n("line.smoothing"),I2(n,i,s,o)};function z2(r,e){var t;D2.indexOf(e.operation)===-1?(r("contours.value",[0,1]),Zh(e.value)?e.value.length>2?e.value=e.value.slice(2):e.length===0?e.value=[0,1]:e.length<2?(t=parseFloat(e.value[0]),e.value=[t,t+1]):e.value=[parseFloat(e.value[0]),parseFloat(e.value[1])]:Xh(e.value)&&(t=parseFloat(e.value),e.value=[t,t+1])):(r("contours.value",0),Xh(e.value)||(Zh(e.value)?e.value=parseFloat(e.value[0]):e.value=0))}var P2=function(e,t,n,i){var a=i("contours.start"),o=i("contours.end"),f=a===!1||o===!1,l=n("contours.size"),s;f?s=t.autocontour=!0:s=n("autocontour",!1),(s||!l)&&n("ncontours")},G2=Tm,U2=a0,$2=function(e,t,n,i,a){var o=n("contours.coloring"),f,l="";o==="fill"&&(f=n("contours.showlines")),f!==!1&&(o!=="lines"&&(l=n("line.color","#000")),n("line.width",.5),n("line.dash")),o!=="none"&&(e.showlegend!==!0&&(t.showlegend=!1),t._dfltShowLegend=!1,G2(e,t,i,n,{prefix:"",cLetter:"z"})),n("line.smoothing"),U2(n,i,l,a)},Jh=wr,j2=function(e,t){e("texttemplate");var n=Jh.extendFlat({},t.font,{color:"auto",size:"auto"});Jh.coerceFont(e,"textfont",n)},ss=wr,V2=L2,q2=Dd,H2=k2,W2=P2,X2=$2,Y2=j2,Qh=n0,Z2=function(e,t,n,i){function a(s,u){return ss.coerce(e,t,Qh,s,u)}function o(s){return ss.coerce2(e,t,Qh,s)}var f=V2(e,t,a,i);if(!f){t.visible=!1;return}q2(e,t,i,a),a("xhoverformat"),a("yhoverformat"),a("text"),a("hovertext"),a("hoverongaps"),a("hovertemplate");var l=a("contours.type")==="constraint";a("connectgaps",ss.isArray1D(t.z)),l?H2(e,t,a,i,n):(W2(e,t,a,o),X2(e,t,a,i)),t.contours&&t.contours.coloring==="heatmap"&&Y2(a,i),a("zorder")},fa=Ln,J2={count:function(r,e,t){return t[r]++,1},sum:function(r,e,t,n){var i=n[e];return fa(i)?(i=Number(i),t[r]+=i,i):0},avg:function(r,e,t,n,i){var a=n[e];return fa(a)&&(a=Number(a),t[r]+=a,i[r]++),0},min:function(r,e,t,n){var i=n[e];if(fa(i))if(i=Number(i),fa(t[r])){if(t[r]>i){var a=i-t[r];return t[r]=i,a}}else return t[r]=i,i;return 0},max:function(r,e,t,n){var i=n[e];if(fa(i))if(i=Number(i),fa(t[r])){if(t[r]<i){var a=i-t[r];return t[r]=i,a}}else return t[r]=i,i;return 0}},Q2={percent:function(r,e){for(var t=r.length,n=100/e,i=0;i<t;i++)r[i]*=n},probability:function(r,e){for(var t=r.length,n=0;n<t;n++)r[n]/=e},density:function(r,e,t,n){var i=r.length;n=n||1;for(var a=0;a<i;a++)r[a]*=t[a]*n},"probability density":function(r,e,t,n){var i=r.length;n&&(e/=n);for(var a=0;a<i;a++)r[a]*=t[a]/e}},K2=function(e,t){for(var n=e.length,i=0,a=0;a<n;a++)t[a]?(e[a]/=t[a],i+=e[a]):e[a]=null;return i},ba=Za,Fn=ba.ONEAVGYEAR,Kh=ba.ONEAVGMONTH,Ki=ba.ONEDAY,ed=ba.ONEHOUR,rd=ba.ONEMIN,td=ba.ONESEC,nd=hn.tickIncrement,eA=function(e,t,n,i,a){var o=-1.1*t,f=-.1*t,l=e-f,s=n[0],u=n[1],v=Math.min(Pi(s+f,s+l,i,a),Pi(u+f,u+l,i,a)),d=Math.min(Pi(s+o,s+f,i,a),Pi(u+o,u+f,i,a)),c,p;if(v>d&&d<Math.abs(u-s)/4e3?(c=v,p=!1):(c=Math.min(v,d),p=!0),i.type==="date"&&c>Ki){var O=c===Fn?1:6,g=c===Fn?"M12":"M1";return function(y,R){var T=i.c2d(y,Fn,a),M=T.indexOf("-",O);M>0&&(T=T.substr(0,M));var B=i.d2c(T,0,a);if(B<y){var V=nd(B,g,!1,a);(B+V)/2<y+e&&(B=V)}return R&&p?nd(B,g,!0,a):B}}return function(y,R){var T=c*Math.round(y/c);return T+c/10<y&&T+c*.9<y+e&&(T+=c),R&&p&&(T-=c),T}};function Pi(r,e,t,n){if(r*e<=0)return 1/0;for(var i=Math.abs(e-r),a=t.type==="date",o=ad(i,a),f=0;f<10;f++){var l=ad(o*80,a);if(o===l)break;if(rA(l,r,e,a,t,n))o=l;else break}return o}function ad(r,e){return e&&r>td?r>Ki?r>Fn*1.1?Fn:r>Kh*1.1?Kh:Ki:r>ed?ed:r>rd?rd:td:Math.pow(10,Math.floor(Math.log(r)/Math.LN10))}function rA(r,e,t,n,i,a){if(n&&r>Ki){var o=id(e,i,a),f=id(t,i,a),l=r===Fn?0:1;return o[l]!==f[l]}return Math.floor(t/r)-Math.floor(e/r)>.1}function id(r,e,t){var n=e.c2d(r,Fn,t).split("-");return n[0]===""&&(n.unshift(),n[0]="-"+n[0]),n}var tA=Ln,wt=wr,od=vn,fn=hn;function l0(r,e,t,n,i){var a=n+"bins",o=r._fullLayout,f=e["_"+n+"bingroup"],l=o._histogramBinOpts[f],s=o.barmode==="overlay",u,v,d,c,p,O,g,y=function(Se){return t.r2c(Se,0,c)},R=function(Se){return t.c2r(Se,0,c)},T=t.type==="date"?function(Se){return Se||Se===0?wt.cleanDate(Se,null,c):null}:function(Se){return tA(Se)?Number(Se):null};function M(Se,xe,je){xe[Se+"Found"]?(xe[Se]=T(xe[Se]),xe[Se]===null&&(xe[Se]=je[Se])):(O[Se]=xe[Se]=je[Se],wt.nestedProperty(v[0],a+"."+Se).set(je[Se]))}if(e["_"+n+"autoBinFinished"])delete e["_"+n+"autoBinFinished"];else{v=l.traces;var B=[],V=!0,I=!1,F=!1;for(u=0;u<v.length;u++)if(d=v[u],d.visible){var j=l.dirs[u];p=d["_"+j+"pos0"]=t.makeCalcdata(d,j),B=wt.concat(B,p),delete d["_"+n+"autoBinFinished"],e.visible===!0&&(V?V=!1:(delete d._autoBin,d["_"+n+"autoBinFinished"]=1),od.traceIs(d,"2dMap")&&(I=!0),d.type==="histogram2dcontour"&&(F=!0))}c=v[0][n+"calendar"];var z=fn.autoBin(B,t,l.nbins,I,c,l.sizeFound&&l.size),q=v[0]._autoBin={};if(O=q[l.dirs[0]]={},F&&(l.size||(z.start=R(fn.tickIncrement(y(z.start),z.size,!0,c))),l.end===void 0&&(z.end=R(fn.tickIncrement(y(z.end),z.size,!1,c)))),s&&!od.traceIs(e,"2dMap")&&z._dataSpan===0&&t.type!=="category"&&t.type!=="multicategory"&&e.bingroup===""&&typeof e.xbins>"u"){if(i)return[z,p,!0];z=nA(r,e,t,n,a)}g=d.cumulative||{},g.enabled&&g.currentbin!=="include"&&(g.direction==="decreasing"?z.start=R(fn.tickIncrement(y(z.start),z.size,!0,c)):z.end=R(fn.tickIncrement(y(z.end),z.size,!1,c))),l.size=z.size,l.sizeFound||(O.size=z.size,wt.nestedProperty(v[0],a+".size").set(z.size)),M("start",l,z),M("end",l,z)}p=e["_"+n+"pos0"],delete e["_"+n+"pos0"];var C=e._input[a]||{},G=wt.extendFlat({},l),Q=l.start,fe=t.r2l(C.start),ue=fe!==void 0;if((l.startFound||ue)&&fe!==t.r2l(Q)){var K=ue?fe:wt.aggNums(Math.min,null,p),se={type:t.type==="category"||t.type==="multicategory"?"linear":t.type,r2l:t.r2l,dtick:l.size,tick0:Q,calendar:c,range:[K,fn.tickIncrement(K,l.size,!1,c)].map(t.l2r)},Te=fn.tickFirst(se);Te>t.r2l(K)&&(Te=fn.tickIncrement(Te,l.size,!0,c)),G.start=t.l2r(Te),ue||wt.nestedProperty(e,a+".start").set(G.start)}var ye=l.end,Fe=t.r2l(C.end),Qe=Fe!==void 0;if((l.endFound||Qe)&&Fe!==t.r2l(ye)){var qe=Qe?Fe:wt.aggNums(Math.max,null,p);G.end=t.l2r(qe),Qe||wt.nestedProperty(e,a+".start").set(G.end)}var pe="autobin"+n;return e._input[pe]===!1&&(e._input[a]=wt.extendFlat({},e[a]||{}),delete e._input[pe],delete e[pe]),[G,p]}function nA(r,e,t,n,i){var a=r._fullLayout,o=aA(r,e),f=!1,l=1/0,s=[e],u,v,d;for(u=0;u<o.length;u++)if(v=o[u],v===e)f=!0;else if(!f)d=a._histogramBinOpts[v["_"+n+"bingroup"]],l=Math.min(l,d.size||v[i].size);else{var c=l0(r,v,t,n,!0),p=c[0],O=c[2];v["_"+n+"autoBinFinished"]=1,v["_"+n+"pos0"]=c[1],O?s.push(v):l=Math.min(l,p.size)}var g=new Array(s.length);for(u=0;u<s.length;u++)for(var y=s[u]["_"+n+"pos0"],R=0;R<y.length;R++)if(y[R]!==void 0){g[u]=y[R];break}for(isFinite(l)||(l=wt.distinctVals(g).minDiff),u=0;u<s.length;u++){v=s[u];var T=v[n+"calendar"],M={start:t.c2r(g[u]-l/2,0,T),end:t.c2r(g[u]+l/2,0,T),size:l};v._input[i]=v[i]=M,d=a._histogramBinOpts[v["_"+n+"bingroup"]],d&&wt.extendFlat(d,M)}return e[i]}function aA(r,e){for(var t=e.xaxis,n=e.yaxis,i=e.orientation,a=[],o=r._fullData,f=0;f<o.length;f++){var l=o[f];l.type==="histogram"&&l.visible===!0&&l.orientation===i&&l.xaxis===t&&l.yaxis===n&&a.push(l)}return a}var iA={calcAllAutoBins:l0},ld=wr,sa=hn,fd=J2,oA=Q2,lA=K2,fA=eA,sd=iA.calcAllAutoBins,sA=function(e,t){var n=sa.getFromId(e,t.xaxis),i=sa.getFromId(e,t.yaxis),a=t.xcalendar,o=t.ycalendar,f=function(rt){return n.r2c(rt,0,a)},l=function(rt){return i.r2c(rt,0,o)},s=function(rt){return n.c2r(rt,0,a)},u=function(rt){return i.c2r(rt,0,o)},v,d,c,p,O=sd(e,t,n,"x"),g=O[0],y=O[1],R=sd(e,t,i,"y"),T=R[0],M=R[1],B=t._length;y.length>B&&y.splice(B,y.length-B),M.length>B&&M.splice(B,M.length-B);var V=[],I=[],F=[],j=typeof g.size=="string",z=typeof T.size=="string",q=[],C=[],G=j?q:g,Q=z?C:T,fe=0,ue=[],K=[],se=t.histnorm,Te=t.histfunc,ye=se.indexOf("density")!==-1,Fe=Te==="max"||Te==="min",Qe=Fe?null:0,qe=fd.count,pe=oA[se],Se=!1,xe=[],je=[],tr="z"in t?t.z:"marker"in t&&Array.isArray(t.marker.color)?t.marker.color:"";tr&&Te!=="count"&&(Se=Te==="avg",qe=fd[Te]);var He=g.size,Je=f(g.start),or=f(g.end)+(Je-sa.tickIncrement(Je,He,!1,a))/1e6;for(v=Je;v<or;v=sa.tickIncrement(v,He,!1,a))I.push(Qe),q.push(v),Se&&F.push(0);q.push(v);var ir=I.length,Rr=(v-Je)/ir,Sr=s(Je+Rr/2),Nr=T.size,pr=l(T.start),st=l(T.end)+(pr-sa.tickIncrement(pr,Nr,!1,o))/1e6;for(v=pr;v<st;v=sa.tickIncrement(v,Nr,!1,o)){V.push(I.slice()),C.push(v);var cr=new Array(ir);for(d=0;d<ir;d++)cr[d]=[];K.push(cr),Se&&ue.push(F.slice())}C.push(v);var Hr=V.length,Wr=(v-pr)/Hr,It=u(pr+Wr/2);ye&&(xe=ud(I.length,G,Rr,j),je=ud(V.length,Q,Wr,z)),!j&&n.type==="date"&&(G=cd(f,G)),!z&&i.type==="date"&&(Q=cd(l,Q));var ut=!0,ct=!0,$r=new Array(ir),yt=new Array(Hr),mt=1/0,Et=1/0,Jt=1/0,St=1/0;for(v=0;v<B;v++){var Nt=y[v],$t=M[v];c=ld.findBin(Nt,G),p=ld.findBin($t,Q),c>=0&&c<ir&&p>=0&&p<Hr&&(fe+=qe(c,v,V[p],tr,ue[p]),K[p][c].push(v),ut&&($r[c]===void 0?$r[c]=Nt:$r[c]!==Nt&&(ut=!1)),ct&&(yt[p]===void 0?yt[p]=$t:yt[p]!==$t&&(ct=!1)),mt=Math.min(mt,Nt-q[c]),Et=Math.min(Et,q[c+1]-Nt),Jt=Math.min(Jt,$t-C[p]),St=Math.min(St,C[p+1]-$t))}if(Se)for(p=0;p<Hr;p++)fe+=lA(V[p],ue[p]);if(pe)for(p=0;p<Hr;p++)pe(V[p],fe,xe,je[p]);return{x:y,xRanges:vd(q,ut&&$r,mt,Et,n,a),x0:Sr,dx:Rr,y:M,yRanges:vd(C,ct&&yt,Jt,St,i,o),y0:It,dy:Wr,z:V,pts:K}};function ud(r,e,t,n){var i=new Array(r),a;if(n)for(a=0;a<r;a++)i[a]=1/(e[a+1]-e[a]);else{var o=1/t;for(a=0;a<r;a++)i[a]=o}return i}function cd(r,e){return{start:r(e.start),end:r(e.end),size:e.size}}function vd(r,e,t,n,i,a){var o,f=r.length-1,l=new Array(f),s=fA(t,n,r,i,a);for(o=0;o<f;o++){var u=(e||[])[o];l[o]=u===void 0?[s(r[o]),s(r[o+1],!0)]:[u,u]}return l}var Ut=wr,hd=Za.BADNUM,dd=Bs,uA=function(e,t,n,i,a,o){var f=e._length,l=t.makeCalcdata(e,i),s=n.makeCalcdata(e,a);l=dd(e,t,i,l).vals,s=dd(e,n,a,s).vals;var u=e.text,v=u!==void 0&&Ut.isArray1D(u),d=e.hovertext,c=d!==void 0&&Ut.isArray1D(d),p,O,g=Ut.distinctVals(l),y=g.vals,R=Ut.distinctVals(s),T=R.vals,M=[],B,V,I=T.length,F=y.length;for(p=0;p<o.length;p++)M[p]=Ut.init2dArray(I,F);v&&(B=Ut.init2dArray(I,F)),c&&(V=Ut.init2dArray(I,F));var j=Ut.init2dArray(I,F);for(p=0;p<f;p++)if(l[p]!==hd&&s[p]!==hd){var z=Ut.findBin(l[p]+g.minDiff/2,y),q=Ut.findBin(s[p]+R.minDiff/2,T);for(O=0;O<o.length;O++){var C=o[O],G=e[C],Q=M[O];Q[q][z]=G[p],j[q][z]=p}v&&(B[q][z]=u[p]),c&&(V[q][z]=d[p])}for(e["_"+i]=y,e["_"+a]=T,O=0;O<o.length;O++)e["_"+o[O]]=M[O];v&&(e._text=B),c&&(e._hovertext=V),t&&t.type==="category"&&(e["_"+i+"CategoryMap"]=y.map(function(fe){return t._categories[fe]})),n&&n.type==="category"&&(e["_"+a+"CategoryMap"]=T.map(function(fe){return n._categories[fe]})),e._after2before=j},cA=Ln,vA=wr,Gi=Za.BADNUM,hA=function(e,t,n,i){var a,o,f,l,s,u;function v(y){if(cA(y))return+y}if(t&&t.transpose){for(a=0,s=0;s<e.length;s++)a=Math.max(a,e[s].length);if(a===0)return!1;f=function(y){return y.length},l=function(y,R,T){return(y[T]||[])[R]}}else a=e.length,f=function(y,R){return y[R].length},l=function(y,R,T){return(y[R]||[])[T]};var d=function(y,R,T){return R===Gi||T===Gi?Gi:l(y,R,T)};function c(y){if(t&&t.type!=="carpet"&&t.type!=="contourcarpet"&&y&&y.type==="category"&&t["_"+y._id.charAt(0)].length){var R=y._id.charAt(0),T={},M=t["_"+R+"CategoryMap"]||t[R];for(s=0;s<M.length;s++)T[M[s]]=s;return function(B){var V=T[y._categories[B]];return V+1?V:Gi}}else return vA.identity}var p=c(n),O=c(i);i&&i.type==="category"&&(a=i._categories.length);var g=new Array(a);for(s=0;s<a;s++)for(n&&n.type==="category"?o=n._categories.length:o=f(e,s),g[s]=new Array(o),u=0;u<o;u++)g[s][u]=v(d(e,O(s),p(u)));return g},us=vn,pd=wr.isArrayOrTypedArray,dA=function(e,t,n,i,a,o){var f=[],l=us.traceIs(e,"contour"),s=us.traceIs(e,"histogram"),u=us.traceIs(e,"gl2d"),v,d,c,p=pd(t)&&t.length>1;if(p&&!s&&o.type!=="category"){var O=t.length;if(O<=a){if(l||u)f=Array.from(t).slice(0,a);else if(a===1)o.type==="log"?f=[.5*t[0],2*t[0]]:f=[t[0]-.5,t[0]+.5];else if(o.type==="log"){for(f=[Math.pow(t[0],1.5)/Math.pow(t[1],.5)],c=1;c<O;c++)f.push(Math.sqrt(t[c-1]*t[c]));f.push(Math.pow(t[O-1],1.5)/Math.pow(t[O-2],.5))}else{for(f=[1.5*t[0]-.5*t[1]],c=1;c<O;c++)f.push((t[c-1]+t[c])*.5);f.push(1.5*t[O-1]-.5*t[O-2])}if(O<a){var g=f[f.length-1],y;if(o.type==="log")for(y=g/f[f.length-2],c=O;c<a;c++)g*=y,f.push(g);else for(y=g-f[f.length-2],c=O;c<a;c++)g+=y,f.push(g)}}else return l?t.slice(0,a):t.slice(0,a+1)}else{var R=e[o._id.charAt(0)+"calendar"];if(s)v=o.r2c(n,0,R);else if(pd(t)&&t.length===1)v=t[0];else if(n===void 0)v=0;else{var T=o.type==="log"?o.d2c:o.r2c;v=T(n,0,R)}for(d=i||1,c=l||u?0:-.5;c<a;c++)f.push(v+d*c)}return f},cs=vn,vs=wr,Ui=hn,yd=Bs,pA=sA,yA=Cm,mA=uA,gA=hA,xA=Sm,bA=Em,$i=dA,Fs=Za.BADNUM,_A=function(e,t){var n=Ui.getFromId(e,t.xaxis||"x"),i=Ui.getFromId(e,t.yaxis||"y"),a=cs.traceIs(t,"contour"),o=cs.traceIs(t,"histogram"),f=cs.traceIs(t,"gl2d"),l=a?"best":t.zsmooth,s,u,v,d,c,p,O,g,y,R,T;if(n._minDtick=0,i._minDtick=0,o)T=pA(e,t),d=T.orig_x,s=T.x,u=T.x0,v=T.dx,g=T.orig_y,c=T.y,p=T.y0,O=T.dy,y=T.z;else{var M=t.z;vs.isArray1D(M)?(mA(t,n,i,"x","y",["z"]),s=t._x,c=t._y,M=t._z):(d=t.x?n.makeCalcdata(t,"x"):[],g=t.y?i.makeCalcdata(t,"y"):[],s=yd(t,n,"x",d).vals,c=yd(t,i,"y",g).vals,t._x=s,t._y=c),u=t.x0,v=t.dx,p=t.y0,O=t.dy,y=gA(M,t,n,i)}(n.rangebreaks||i.rangebreaks)&&(y=AA(s,c,y),o||(s=md(s),c=md(c),t._x=s,t._y=c)),!o&&(a||t.connectgaps)&&(t._emptypoints=bA(y),xA(y,t._emptypoints));function B(Q){l=t._input.zsmooth=t.zsmooth=!1,vs.warn('cannot use zsmooth: "fast": '+Q)}function V(Q){if(Q.length>1){var fe=(Q[Q.length-1]-Q[0])/(Q.length-1),ue=Math.abs(fe/100);for(R=0;R<Q.length-1;R++)if(Math.abs(Q[R+1]-Q[R]-fe)>ue)return!1}return!0}t._islinear=!1,n.type==="log"||i.type==="log"?l==="fast"&&B("log axis found"):V(s)?V(c)?t._islinear=!0:l==="fast"&&B("y scale is not linear"):l==="fast"&&B("x scale is not linear");var I=vs.maxRowLength(y),F=t.xtype==="scaled"?"":s,j=$i(t,F,u,v,I,n),z=t.ytype==="scaled"?"":c,q=$i(t,z,p,O,y.length,i);f||(t._extremes[n._id]=Ui.findExtremes(n,j),t._extremes[i._id]=Ui.findExtremes(i,q));var C={x:j,y:q,z:y,text:t._text||t.text,hovertext:t._hovertext||t.hovertext};if(t.xperiodalignment&&d&&(C.orig_x=d),t.yperiodalignment&&g&&(C.orig_y=g),F&&F.length===j.length-1&&(C.xCenter=F),z&&z.length===q.length-1&&(C.yCenter=z),o&&(C.xRanges=T.xRanges,C.yRanges=T.yRanges,C.pts=T.pts),a||yA(e,t,{vals:y}),a&&t.contours&&t.contours.coloring==="heatmap"){var G={type:t.type==="contour"?"heatmap":"histogram2d",xcalendar:t.xcalendar,ycalendar:t.ycalendar};C.xfill=$i(G,F,u,v,I,n),C.yfill=$i(G,z,p,O,y.length,i)}return[C]};function md(r){for(var e=[],t=r.length,n=0;n<t;n++){var i=r[n];i!==Fs&&e.push(i)}return e}function AA(r,e,t){for(var n=[],i=-1,a=0;a<t.length;a++)if(e[a]!==Fs){i++,n[i]=[];for(var o=0;o<t[a].length;o++)r[o]!==Fs&&n[i].push(t[a][o])}return n}var Os=hn,hs=wr,wA=function(e,t){var n=e.contours;if(e.autocontour){var i=e.zmin,a=e.zmax;(e.zauto||i===void 0)&&(i=hs.aggNums(Math.min,null,t)),(e.zauto||a===void 0)&&(a=hs.aggNums(Math.max,null,t));var o=gd(i,a,e.ncontours);n.size=o.dtick,n.start=Os.tickFirst(o),o.range.reverse(),n.end=Os.tickFirst(o),n.start===i&&(n.start+=n.size),n.end===a&&(n.end-=n.size),n.start>n.end&&(n.start=n.end=(n.start+n.end)/2),e._input.contours||(e._input.contours={}),hs.extendFlat(e._input.contours,{start:n.start,end:n.end,size:n.size}),e._input.autocontour=!0}else if(n.type!=="constraint"){var f=n.start,l=n.end,s=e._input.contours;if(f>l&&(n.start=s.start=l,l=n.end=s.end=f,f=n.start),!(n.size>0)){var u;f===l?u=1:u=gd(f,l,e.ncontours).dtick,s.size=n.size=u}}};function gd(r,e,t){var n={type:"linear",range:[r,e]};return Os.autoTicks(n,(e-r)/(t||15)),n}var po=function(e){return e.end+e.size/1e6},xd=Rn,TA=_A,EA=wA,SA=po,CA=function(e,t){var n=TA(e,t),i=n[0].z;EA(t,i);var a=t.contours,o=xd.extractOpts(t),f;if(a.coloring==="heatmap"&&o.auto&&t.autocontour===!1){var l=a.start,s=SA(a),u=a.size||1,v=Math.floor((s-l)/u)+1;isFinite(u)||(u=1,v=1);var d=l-u/2,c=d+v*u;f=[d,c]}else f=i;return xd.calc(e,t,{vals:f,cLetter:"z"}),n},f0={},Ws={};(function(r){r.CSS_DECLARATIONS=[["image-rendering","optimizeSpeed"],["image-rendering","-moz-crisp-edges"],["image-rendering","-o-crisp-edges"],["image-rendering","-webkit-optimize-contrast"],["image-rendering","optimize-contrast"],["image-rendering","crisp-edges"],["image-rendering","pixelated"]],r.STYLE=r.CSS_DECLARATIONS.map(function(e){return e.join(": ")+"; "}).join("")})(Ws);var bd=Ws,FA=Xa,ds=wr,ua=null;function OA(){if(ua!==null)return ua;ua=!1;var r=ds.isIE()||ds.isSafari()||ds.isIOS();if(window.navigator.userAgent&&!r){var e=Array.from(bd.CSS_DECLARATIONS).reverse(),t=window.CSS&&window.CSS.supports||window.supportsCSS;if(typeof t=="function")ua=e.some(function(o){return t.apply(null,o)});else{var n=FA.tester.append("image").attr("style",bd.STYLE),i=window.getComputedStyle(n.node()),a=i.imageRendering;ua=e.some(function(o){var f=o[1];return a===f||a===f.toLowerCase()}),n.remove()}}return ua}var LA=OA,_d=Ja,RA=Lm,MA=vn,IA=Xa,NA=hn,Tt=wr,Ad=qd,BA=kd,DA=ro,kA=Rn.extractOpts,zA=Rn.makeColorScaleFuncFromTrace,PA=Om,GA=Fm,ps=GA.LINE_SPACING,UA=LA,$A=Ws.STYLE,s0="heatmap-label";function u0(r){return r.selectAll("g."+s0)}function wd(r){u0(r).remove()}var jA=function(r,e,t,n){var i=e.xaxis,a=e.yaxis;Tt.makeTraceGroups(n,t,"hm").each(function(o){var f=_d.select(this),l=o[0],s=l.trace,u=s.xgap||0,v=s.ygap||0,d=l.z,c=l.x,p=l.y,O=l.xCenter,g=l.yCenter,y=MA.traceIs(s,"contour"),R=y?"best":s.zsmooth,T=d.length,M=Tt.maxRowLength(d),B=!1,V=!1,I,F,j,z,q,C,G,Q;for(C=0;I===void 0&&C<c.length-1;)I=i.c2p(c[C]),C++;for(C=c.length-1;F===void 0&&C>0;)F=i.c2p(c[C]),C--;for(F<I&&(j=F,F=I,I=j,B=!0),C=0;z===void 0&&C<p.length-1;)z=a.c2p(p[C]),C++;for(C=p.length-1;q===void 0&&C>0;)q=a.c2p(p[C]),C--;q<z&&(j=z,z=q,q=j,V=!0),y&&(O=c,g=p,c=l.xfill,p=l.yfill);var fe="default";if(R?fe=R==="best"?"smooth":"fast":s._islinear&&u===0&&v===0&&UA()&&(fe="fast"),fe!=="fast"){var ue=R==="best"?0:.5;I=Math.max(-ue*i._length,I),F=Math.min((1+ue)*i._length,F),z=Math.max(-ue*a._length,z),q=Math.min((1+ue)*a._length,q)}var K=Math.round(F-I),se=Math.round(q-z),Te=I>=i._length||F<=0||z>=a._length||q<=0;if(Te){var ye=f.selectAll("image").data([]);ye.exit().remove(),wd(f);return}var Fe,Qe;fe==="fast"?(Fe=M,Qe=T):(Fe=K,Qe=se);var qe=document.createElement("canvas");qe.width=Fe,qe.height=Qe;var pe=qe.getContext("2d",{willReadFrequently:!0}),Se=zA(s,{noNumericCheck:!0,returnArray:!0}),xe,je;fe==="fast"?(xe=B?function(gr){return M-1-gr}:Tt.identity,je=V?function(gr){return T-1-gr}:Tt.identity):(xe=function(gr){return Tt.constrain(Math.round(i.c2p(c[gr])-I),0,K)},je=function(gr){return Tt.constrain(Math.round(a.c2p(p[gr])-z),0,se)});var tr=je(0),He=[tr,tr],Je=B?0:1,or=V?0:1,ir=0,Rr=0,Sr=0,Nr=0,pr,st,cr,Hr,Wr;function It(gr,Ft){if(gr!==void 0){var Er=Se(gr);return Er[0]=Math.round(Er[0]),Er[1]=Math.round(Er[1]),Er[2]=Math.round(Er[2]),ir+=Ft,Rr+=Er[0]*Ft,Sr+=Er[1]*Ft,Nr+=Er[2]*Ft,Er}return[0,0,0,0]}function ut(gr,Ft,Er,Eo){var tt=gr[Er.bin0];if(tt===void 0)return It(void 0,1);var _n=gr[Er.bin1],Ht=Ft[Er.bin0],_t=Ft[Er.bin1],So=_n-tt||0,en=Ht-tt||0,Ot;return _n===void 0?_t===void 0?Ot=0:Ht===void 0?Ot=2*(_t-tt):Ot=(2*_t-Ht-tt)*2/3:_t===void 0?Ht===void 0?Ot=0:Ot=(2*tt-_n-Ht)*2/3:Ht===void 0?Ot=(2*_t-_n-tt)*2/3:Ot=_t+tt-_n-Ht,It(tt+Er.frac*So+Eo.frac*(en+Er.frac*Ot))}if(fe!=="default"){var ct=0,$r;try{$r=new Uint8Array(Fe*Qe*4)}catch{$r=new Array(Fe*Qe*4)}if(fe==="smooth"){var yt=O||c,mt=g||p,Et=new Array(yt.length),Jt=new Array(mt.length),St=new Array(K),Nt=O?Ed:Td,$t=g?Ed:Td,rt,Qt,Nn;for(C=0;C<yt.length;C++)Et[C]=Math.round(i.c2p(yt[C])-I);for(C=0;C<mt.length;C++)Jt[C]=Math.round(a.c2p(mt[C])-z);for(C=0;C<K;C++)St[C]=Nt(C,Et);for(G=0;G<se;G++)for(rt=$t(G,Jt),Qt=d[rt.bin0],Nn=d[rt.bin1],C=0;C<K;C++,ct+=4)Wr=ut(Qt,Nn,St[C],rt),Sd($r,ct,Wr)}else for(G=0;G<T;G++)for(Hr=d[G],He=je(G),C=0;C<M;C++)Wr=It(Hr[C],1),ct=(He*M+xe(C))*4,Sd($r,ct,Wr);var Bn=pe.createImageData(Fe,Qe);try{Bn.data.set($r)}catch{var Dn=Bn.data,yo=Dn.length;for(G=0;G<yo;G++)Dn[G]=$r[G]}pe.putImageData(Bn,0,0)}else{var mo=Math.floor(u/2),go=Math.floor(v/2);for(G=0;G<T;G++)if(Hr=d[G],He.reverse(),He[or]=je(G+1),!(He[0]===He[1]||He[0]===void 0||He[1]===void 0))for(st=xe(0),pr=[st,st],C=0;C<M;C++)pr.reverse(),pr[Je]=xe(C+1),!(pr[0]===pr[1]||pr[0]===void 0||pr[1]===void 0)&&(cr=Hr[C],Wr=It(cr,(pr[1]-pr[0])*(He[1]-He[0])),pe.fillStyle="rgba("+Wr.join(",")+")",pe.fillRect(pr[0]+mo,He[0]+go,pr[1]-pr[0]-u,He[1]-He[0]-v))}Rr=Math.round(Rr/ir),Sr=Math.round(Sr/ir),Nr=Math.round(Nr/ir);var xo=RA("rgb("+Rr+","+Sr+","+Nr+")");r._hmpixcount=(r._hmpixcount||0)+ir,r._hmlumcount=(r._hmlumcount||0)+ir*xo.getLuminance();var Dr=f.selectAll("image").data(o);Dr.enter().append("svg:image").attr({xmlns:PA.svg,preserveAspectRatio:"none"}),Dr.attr({height:se,width:K,x:I,y:z,"xlink:href":qe.toDataURL("image/png")}),fe==="fast"&&!R&&Dr.attr("style",$A),wd(f);var gt=s.texttemplate;if(gt){var Zr=kA(s),kn={type:"linear",range:[Zr.min,Zr.max],_separators:i._separators,_numFormat:i._numFormat},ai=s.type==="histogram2dcontour",Kt=s.type==="contour",ii=Kt?1:0,oi=Kt?T-1:T,bo=Kt?1:0,_o=Kt?M-1:M,Bt=[];for(C=ii;C<oi;C++){var jt;if(Kt)jt=l.y[C];else if(ai){if(C===0||C===T-1)continue;jt=l.y[C]}else if(l.yCenter)jt=l.yCenter[C];else{if(C+1===T&&l.y[C+1]===void 0)continue;jt=(l.y[C]+l.y[C+1])/2}var _a=Math.round(a.c2p(jt));if(!(0>_a||_a>a._length))for(G=bo;G<_o;G++){var Vt;if(Kt)Vt=l.x[G];else if(ai){if(G===0||G===M-1)continue;Vt=l.x[G]}else if(l.xCenter)Vt=l.xCenter[G];else{if(G+1===M&&l.x[G+1]===void 0)continue;Vt=(l.x[G]+l.x[G+1])/2}var Aa=Math.round(i.c2p(Vt));if(!(0>Aa||Aa>i._length)){var Ct=BA({x:Vt,y:jt},s,r._fullLayout);Ct.x=Vt,Ct.y=jt;var zn=l.z[C][G];zn===void 0?(Ct.z="",Ct.zLabel=""):(Ct.z=zn,Ct.zLabel=NA.tickText(kn,zn,"hover").text);var Pn=l.text&&l.text[C]&&l.text[C][G];(Pn===void 0||Pn===!1)&&(Pn=""),Ct.text=Pn;var wa=Tt.texttemplateString(gt,Ct,r._fullLayout._d3locale,Ct,s._meta||{});if(wa){var mn=wa.split("<br>"),li=mn.length,Ta=0;for(Q=0;Q<li;Q++)Ta=Math.max(Ta,mn[Q].length);Bt.push({l:li,c:Ta,t:wa,x:Aa,y:_a,z:zn})}}}}var xt=s.textfont,bt=xt.size,Ea=r._fullLayout.font.size;if(!bt||bt==="auto"){var Dt=1/0,qt=1/0,gn=0,xn=0;for(Q=0;Q<Bt.length;Q++){var vt=Bt[Q];if(gn=Math.max(gn,vt.l),xn=Math.max(xn,vt.c),Q<Bt.length-1){var bn=Bt[Q+1],Sa=Math.abs(bn.x-vt.x),Ca=Math.abs(bn.y-vt.y);Sa&&(Dt=Math.min(Dt,Sa)),Ca&&(qt=Math.min(qt,Ca))}}!isFinite(Dt)||!isFinite(qt)?bt=Ea:(Dt-=u,qt-=v,Dt/=xn,qt/=gn,Dt/=ps/2,qt/=ps,bt=Math.min(Math.floor(Dt),Math.floor(qt),Ea))}if(bt<=0||!isFinite(bt))return;var Ao=function(gr){return gr.x},wo=function(gr){return gr.y-bt*(gr.l*ps/2-1)},To=u0(f).data(Bt);To.enter().append("g").classed(s0,1).append("text").attr("text-anchor","middle").each(function(gr){var Ft=_d.select(this),Er=xt.color;(!Er||Er==="auto")&&(Er=DA.contrast(gr.z===void 0?r._fullLayout.plot_bgcolor:"rgba("+Se(gr.z).join()+")")),Ft.attr("data-notex",1).call(Ad.positionText,Ao(gr),wo(gr)).call(IA.font,{family:xt.family,size:bt,color:Er,weight:xt.weight,style:xt.style,variant:xt.variant,textcase:xt.textcase,lineposition:xt.lineposition,shadow:xt.shadow}).text(gr.t).call(Ad.convertToTspans,r)})}})};function Td(r,e){var t=e.length-2,n=Tt.constrain(Tt.findBin(r,e),0,t),i=e[n],a=e[n+1],o=Tt.constrain(n+(r-i)/(a-i)-.5,0,t),f=Math.round(o),l=Math.abs(o-f);return!o||o===t||!l?{bin0:f,bin1:f,frac:0}:{bin0:f,frac:l,bin1:Math.round(f+l/(o-f))}}function Ed(r,e){var t=e.length-1,n=Tt.constrain(Tt.findBin(r,e),0,t),i=e[n],a=e[n+1],o=(r-i)/(a-i)||0;return o<=0?{bin0:n,bin1:n,frac:0}:o<.5?{bin0:n,bin1:n+1,frac:o}:{bin0:n+1,bin1:n,frac:1-o}}function Sd(r,e,t){r[e]=t[0],r[e+1]=t[1],r[e+2]=t[2],r[e+3]=Math.round(t[3]*255)}var Xs={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}},ji=Xs,VA=function(e){var t=e[0].z,n=t.length,i=t[0].length,a=n===2||i===2,o,f,l,s,u,v,d,c,p;for(f=0;f<n-1;f++)for(s=[],f===0&&(s=s.concat(ji.BOTTOMSTART)),f===n-2&&(s=s.concat(ji.TOPSTART)),o=0;o<i-1;o++)for(l=s.slice(),o===0&&(l=l.concat(ji.LEFTSTART)),o===i-2&&(l=l.concat(ji.RIGHTSTART)),u=o+","+f,v=[[t[f][o],t[f][o+1]],[t[f+1][o],t[f+1][o+1]]],p=0;p<e.length;p++)c=e[p],d=qA(c.level,v),d&&(c.crossings[u]=d,l.indexOf(d)!==-1&&(c.starts.push([o,f]),a&&l.indexOf(d,l.indexOf(d)+1)!==-1&&c.starts.push([o,f])))};function qA(r,e){var t=(e[0][0]>r?0:1)+(e[0][1]>r?0:2)+(e[1][1]>r?0:4)+(e[1][0]>r?0:8);if(t===5||t===10){var n=(e[0][0]+e[0][1]+e[1][0]+e[1][1])/4;return r>n?t===5?713:1114:t===5?104:208}return t===15?0:t}var Ji=wr,ya=Xs,HA=function(e,t,n){var i,a,o,f,l;for(t=t||.01,n=n||.01,o=0;o<e.length;o++){for(f=e[o],l=0;l<f.starts.length;l++)a=f.starts[l],Cd(f,a,"edge",t,n);for(i=0;Object.keys(f.crossings).length&&i<1e4;)i++,a=Object.keys(f.crossings)[0].split(",").map(Number),Cd(f,a,void 0,t,n);i===1e4&&Ji.log("Infinite loop in contour?")}};function Pa(r,e,t,n){return Math.abs(r[0]-e[0])<t&&Math.abs(r[1]-e[1])<n}function WA(r,e){var t=r[2]-e[2],n=r[3]-e[3];return Math.sqrt(t*t+n*n)}function Cd(r,e,t,n,i){var a=e.join(","),o=r.crossings[a],f=XA(o,t,e),l=[Fd(r,e,[-f[0],-f[1]])],s=r.z.length,u=r.z[0].length,v=e.slice(),d=f.slice(),c;for(c=0;c<1e4;c++){if(o>20?(o=ya.CHOOSESADDLE[o][(f[0]||f[1])<0?0:1],r.crossings[a]=ya.SADDLEREMAINDER[o]):delete r.crossings[a],f=ya.NEWDELTA[o],!f){Ji.log("Found bad marching index:",o,e,r.level);break}l.push(Fd(r,e,f)),e[0]+=f[0],e[1]+=f[1],a=e.join(","),Pa(l[l.length-1],l[l.length-2],n,i)&&l.pop();var p=f[0]&&(e[0]<0||e[0]>u-2)||f[1]&&(e[1]<0||e[1]>s-2),O=e[0]===v[0]&&e[1]===v[1]&&f[0]===d[0]&&f[1]===d[1];if(O||t&&p)break;o=r.crossings[a]}c===1e4&&Ji.log("Infinite loop in contour?");var g=Pa(l[0],l[l.length-1],n,i),y=0,R=.2*r.smoothing,T=[],M=0,B,V,I,F,j,z,q,C,G,Q,fe;for(c=1;c<l.length;c++)q=WA(l[c],l[c-1]),y+=q,T.push(q);var ue=y/T.length*R;function K(ye){return l[ye%l.length]}for(c=l.length-2;c>=M;c--)if(B=T[c],B<ue){for(I=0,V=c-1;V>=M&&B+T[V]<ue;V--)B+=T[V];if(g&&c===l.length-2)for(I=0;I<V&&B+T[I]<ue;I++)B+=T[I];j=c-V+I+1,z=Math.floor((c+V+I+2)/2),!g&&c===l.length-2?F=l[l.length-1]:!g&&V===-1?F=l[0]:j%2?F=K(z):F=[(K(z)[0]+K(z+1)[0])/2,(K(z)[1]+K(z+1)[1])/2],l.splice(V+1,c-V+1,F),c=V+1,I&&(M=I),g&&(c===l.length-2?l[I]=l[l.length-1]:c===0&&(l[l.length-1]=l[0]))}for(l.splice(0,M),c=0;c<l.length;c++)l[c].length=2;if(!(l.length<2))if(g)l.pop(),r.paths.push(l);else{t||Ji.log("Unclosed interior contour?",r.level,v.join(","),l.join("L"));var se=!1;for(C=0;C<r.edgepaths.length;C++)if(Q=r.edgepaths[C],!se&&Pa(Q[0],l[l.length-1],n,i)){l.pop(),se=!0;var Te=!1;for(G=0;G<r.edgepaths.length;G++)if(fe=r.edgepaths[G],Pa(fe[fe.length-1],l[0],n,i)){Te=!0,l.shift(),r.edgepaths.splice(C,1),G===C?r.paths.push(l.concat(fe)):(G>C&&G--,r.edgepaths[G]=fe.concat(l,Q));break}Te||(r.edgepaths[C]=l.concat(Q))}for(C=0;C<r.edgepaths.length&&!se;C++)Q=r.edgepaths[C],Pa(Q[Q.length-1],l[0],n,i)&&(l.shift(),r.edgepaths[C]=Q.concat(l),se=!0);se||r.edgepaths.push(l)}}function XA(r,e,t){var n=0,i=0;return r>20&&e?r===208||r===1114?n=t[0]===0?1:-1:i=t[1]===0?1:-1:ya.BOTTOMSTART.indexOf(r)!==-1?i=1:ya.LEFTSTART.indexOf(r)!==-1?n=1:ya.TOPSTART.indexOf(r)!==-1?i=-1:n=-1,[n,i]}function Fd(r,e,t){var n=e[0]+Math.max(t[0],0),i=e[1]+Math.max(t[1],0),a=r.z[i][n],o=r.xaxis,f=r.yaxis;if(t[1]){var l=(r.level-a)/(r.z[i][n+1]-a),s=(l!==1?(1-l)*o.c2l(r.x[n]):0)+(l!==0?l*o.c2l(r.x[n+1]):0);return[o.c2p(o.l2c(s),!0),f.c2p(r.y[i],!0),n+l,i]}else{var u=(r.level-a)/(r.z[i+1][n]-a),v=(u!==1?(1-u)*f.c2l(r.y[i]):0)+(u!==0?u*f.c2l(r.y[i+1]):0);return[o.c2p(r.x[n],!0),f.c2p(f.l2c(v),!0),n,i+u]}}var ys=Hs,YA=Ln,ZA={"[]":Od("[]"),"][":Od("]["),">":ms(">"),"<":ms("<"),"=":ms("=")};function c0(r,e){var t=Array.isArray(e),n;function i(a){return YA(a)?+a:null}return ys.COMPARISON_OPS2.indexOf(r)!==-1?n=i(t?e[0]:e):ys.INTERVAL_OPS.indexOf(r)!==-1?n=t?[i(e[0]),i(e[1])]:[i(e),i(e)]:ys.SET_OPS.indexOf(r)!==-1&&(n=t?e.map(i):[i(e)]),n}function Od(r){return function(e){e=c0(r,e);var t=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]);return{start:t,end:n,size:n-t}}}function ms(r){return function(e){return e=c0(r,e),{start:e,end:1/0,size:1/0}}}var Ld=wr,JA=ZA,QA=po,KA=function(e,t,n){for(var i=e.type==="constraint"?JA[e._operation](e.value):e,a=i.size,o=[],f=QA(i),l=n.trace._carpetTrace,s=l?{xaxis:l.aaxis,yaxis:l.baxis,x:n.a,y:n.b}:{xaxis:t.xaxis,yaxis:t.yaxis,x:n.x,y:n.y},u=i.start;u<f;u+=a)if(o.push(Ld.extendFlat({level:u,crossings:{},starts:[],edgepaths:[],paths:[],z:n.z,smoothing:n.trace.line.smoothing},s)),o.length>1e3){Ld.warn("Too many contours, clipping at 1000",e);break}return o},da=wr,ew=function(r,e){var t,n,i,a=function(l){return l.reverse()},o=function(l){return l};switch(e){case"=":case"<":return r;case">":for(r.length!==1&&da.warn("Contour data invalid for the specified inequality operation."),n=r[0],t=0;t<n.edgepaths.length;t++)n.edgepaths[t]=a(n.edgepaths[t]);for(t=0;t<n.paths.length;t++)n.paths[t]=a(n.paths[t]);for(t=0;t<n.starts.length;t++)n.starts[t]=a(n.starts[t]);return r;case"][":var f=a;a=o,o=f;case"[]":for(r.length!==2&&da.warn("Contour data invalid for the specified inequality range operation."),n=Rd(r[0]),i=Rd(r[1]),t=0;t<n.edgepaths.length;t++)n.edgepaths[t]=a(n.edgepaths[t]);for(t=0;t<n.paths.length;t++)n.paths[t]=a(n.paths[t]);for(t=0;t<n.starts.length;t++)n.starts[t]=a(n.starts[t]);for(;i.edgepaths.length;)n.edgepaths.push(o(i.edgepaths.shift()));for(;i.paths.length;)n.paths.push(o(i.paths.shift()));for(;i.starts.length;)n.starts.push(o(i.starts.shift()));return[n]}};function Rd(r){return da.extendFlat({},r,{edgepaths:da.extendDeep([],r.edgepaths),paths:da.extendDeep([],r.paths),starts:da.extendDeep([],r.starts)})}var rw=function(r,e){var t=r[0],n=t.z,i;switch(e.type){case"levels":var a=Math.min(n[0][0],n[0][1]);for(i=0;i<r.length;i++){var o=r[i];o.prefixBoundary=!o.edgepaths.length&&(a>o.level||o.starts.length&&a===o.level)}break;case"constraint":if(t.prefixBoundary=!1,t.edgepaths.length)return;var f=t.x.length,l=t.y.length,s=-1/0,u=1/0;for(i=0;i<l;i++)u=Math.min(u,n[i][0]),u=Math.min(u,n[i][f-1]),s=Math.max(s,n[i][0]),s=Math.max(s,n[i][f-1]);for(i=1;i<f-1;i++)u=Math.min(u,n[0][i]),u=Math.min(u,n[l-1][i]),s=Math.max(s,n[0][i]),s=Math.max(s,n[l-1][i]);var v=e.value,d,c;switch(e._operation){case">":v>s&&(t.prefixBoundary=!0);break;case"<":(v<u||t.starts.length&&v===u)&&(t.prefixBoundary=!0);break;case"[]":d=Math.min(v[0],v[1]),c=Math.max(v[0],v[1]),(c<u||d>s||t.starts.length&&c===u)&&(t.prefixBoundary=!0);break;case"][":d=Math.min(v[0],v[1]),c=Math.max(v[0],v[1]),d<u&&c>s&&(t.prefixBoundary=!0);break}break}};(function(r){var e=Ja,t=wr,n=Xa,i=Rn,a=qd,o=hn,f=Rm,l=jA,s=VA,u=HA,v=KA,d=ew,c=rw,p=Xs,O=p.LABELOPTIMIZER;r.plot=function(F,j,z,q){var C=j.xaxis,G=j.yaxis;t.makeTraceGroups(q,z,"contour").each(function(Q){var fe=e.select(this),ue=Q[0],K=ue.trace,se=ue.x,Te=ue.y,ye=K.contours,Fe=v(ye,j,ue),Qe=t.ensureSingle(fe,"g","heatmapcoloring"),qe=[];ye.coloring==="heatmap"&&(qe=[Q]),l(F,j,qe,Qe),s(Fe),u(Fe);var pe=C.c2p(se[0],!0),Se=C.c2p(se[se.length-1],!0),xe=G.c2p(Te[0],!0),je=G.c2p(Te[Te.length-1],!0),tr=[[pe,je],[Se,je],[Se,xe],[pe,xe]],He=Fe;ye.type==="constraint"&&(He=d(Fe,ye._operation)),g(fe,tr,ye),y(fe,He,tr,ye),T(fe,Fe,F,ue,ye),B(fe,j,F,ue,tr)})};function g(I,F,j){var z=t.ensureSingle(I,"g","contourbg"),q=z.selectAll("path").data(j.coloring==="fill"?[0]:[]);q.enter().append("path"),q.exit().remove(),q.attr("d","M"+F.join("L")+"Z").style("stroke","none")}function y(I,F,j,z){var q=z.coloring==="fill"||z.type==="constraint"&&z._operation!=="=",C="M"+j.join("L")+"Z";q&&c(F,z);var G=t.ensureSingle(I,"g","contourfill"),Q=G.selectAll("path").data(q?F:[]);Q.enter().append("path"),Q.exit().remove(),Q.each(function(fe){var ue=(fe.prefixBoundary?C:"")+R(fe,j);ue?e.select(this).attr("d",ue).style("stroke","none"):e.select(this).remove()})}function R(I,F){var j="",z=0,q=I.edgepaths.map(function(pe,Se){return Se}),C=!0,G,Q,fe,ue,K,se;function Te(pe){return Math.abs(pe[1]-F[0][1])<.01}function ye(pe){return Math.abs(pe[1]-F[2][1])<.01}function Fe(pe){return Math.abs(pe[0]-F[0][0])<.01}function Qe(pe){return Math.abs(pe[0]-F[2][0])<.01}for(;q.length;){for(se=n.smoothopen(I.edgepaths[z],I.smoothing),j+=C?se:se.replace(/^M/,"L"),q.splice(q.indexOf(z),1),G=I.edgepaths[z][I.edgepaths[z].length-1],ue=-1,fe=0;fe<4;fe++){if(!G){t.log("Missing end?",z,I);break}for(Te(G)&&!Qe(G)?Q=F[1]:Fe(G)?Q=F[0]:ye(G)?Q=F[3]:Qe(G)&&(Q=F[2]),K=0;K<I.edgepaths.length;K++){var qe=I.edgepaths[K][0];Math.abs(G[0]-Q[0])<.01?Math.abs(G[0]-qe[0])<.01&&(qe[1]-G[1])*(Q[1]-qe[1])>=0&&(Q=qe,ue=K):Math.abs(G[1]-Q[1])<.01?Math.abs(G[1]-qe[1])<.01&&(qe[0]-G[0])*(Q[0]-qe[0])>=0&&(Q=qe,ue=K):t.log("endpt to newendpt is not vert. or horz.",G,Q,qe)}if(G=Q,ue>=0)break;j+="L"+Q}if(ue===I.edgepaths.length){t.log("unclosed perimeter path");break}z=ue,C=q.indexOf(z)===-1,C&&(z=q[0],j+="Z")}for(z=0;z<I.paths.length;z++)j+=n.smoothclosed(I.paths[z],I.smoothing);return j}function T(I,F,j,z,q){var C=j._context.staticPlot,G=t.ensureSingle(I,"g","contourlines"),Q=q.showlines!==!1,fe=q.showlabels,ue=Q&&fe,K=r.createLines(G,Q||fe,F,C),se=r.createLineClip(G,ue,j,z.trace.uid),Te=I.selectAll("g.contourlabels").data(fe?[0]:[]);if(Te.exit().remove(),Te.enter().append("g").classed("contourlabels",!0),fe){var ye=[],Fe=[];t.clearLocationCache();var Qe=r.labelFormatter(j,z),qe=n.tester.append("text").attr("data-notex",1).call(n.font,q.labelfont),pe=F[0].xaxis,Se=F[0].yaxis,xe=pe._length,je=Se._length,tr=pe.range,He=Se.range,Je=t.aggNums(Math.min,null,z.x),or=t.aggNums(Math.max,null,z.x),ir=t.aggNums(Math.min,null,z.y),Rr=t.aggNums(Math.max,null,z.y),Sr=Math.max(pe.c2p(Je,!0),0),Nr=Math.min(pe.c2p(or,!0),xe),pr=Math.max(Se.c2p(Rr,!0),0),st=Math.min(Se.c2p(ir,!0),je),cr={};tr[0]<tr[1]?(cr.left=Sr,cr.right=Nr):(cr.left=Nr,cr.right=Sr),He[0]<He[1]?(cr.top=pr,cr.bottom=st):(cr.top=st,cr.bottom=pr),cr.middle=(cr.top+cr.bottom)/2,cr.center=(cr.left+cr.right)/2,ye.push([[cr.left,cr.top],[cr.right,cr.top],[cr.right,cr.bottom],[cr.left,cr.bottom]]);var Hr=Math.sqrt(xe*xe+je*je),Wr=p.LABELDISTANCE*Hr/Math.max(1,F.length/p.LABELINCREASE);K.each(function(It){var ut=r.calcTextOpts(It.level,Qe,qe,j);e.select(this).selectAll("path").each(function(){var ct=this,$r=t.getVisibleSegment(ct,cr,ut.height/2);if($r&&!($r.len<(ut.width+ut.height)*p.LABELMIN))for(var yt=Math.min(Math.ceil($r.len/Wr),p.LABELMAX),mt=0;mt<yt;mt++){var Et=r.findBestTextLocation(ct,$r,ut,Fe,cr);if(!Et)break;r.addLabelData(Et,ut,Fe,ye)}})}),qe.remove(),r.drawLabels(Te,Fe,j,se,ue?ye:null)}fe&&!Q&&K.remove()}r.createLines=function(I,F,j,z){var q=j[0].smoothing,C=I.selectAll("g.contourlevel").data(F?j:[]);if(C.exit().remove(),C.enter().append("g").classed("contourlevel",!0),F){var G=C.selectAll("path.openline").data(function(fe){return fe.pedgepaths||fe.edgepaths});G.exit().remove(),G.enter().append("path").classed("openline",!0),G.attr("d",function(fe){return n.smoothopen(fe,q)}).style("stroke-miterlimit",1).style("vector-effect",z?"none":"non-scaling-stroke");var Q=C.selectAll("path.closedline").data(function(fe){return fe.ppaths||fe.paths});Q.exit().remove(),Q.enter().append("path").classed("closedline",!0),Q.attr("d",function(fe){return n.smoothclosed(fe,q)}).style("stroke-miterlimit",1).style("vector-effect",z?"none":"non-scaling-stroke")}return C},r.createLineClip=function(I,F,j,z){var q=j._fullLayout._clips,C=F?"clipline"+z:null,G=q.selectAll("#"+C).data(F?[0]:[]);return G.exit().remove(),G.enter().append("clipPath").classed("contourlineclip",!0).attr("id",C),n.setClipUrl(I,C,j),G},r.labelFormatter=function(I,F){var j=I._fullLayout,z=F.trace,q=z.contours,C={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(q.labelformat)C.tickformat=q.labelformat,f(C,j);else{var G=i.extractOpts(z);if(G&&G.colorbar&&G.colorbar._axis)C=G.colorbar._axis;else{if(q.type==="constraint"){var Q=q.value;t.isArrayOrTypedArray(Q)?C.range=[Q[0],Q[Q.length-1]]:C.range=[Q,Q]}else C.range=[q.start,q.end],C.nticks=(q.end-q.start)/q.size;C.range[0]===C.range[1]&&(C.range[1]+=C.range[0]||1),C.nticks||(C.nticks=1e3),f(C,j),o.prepTicks(C),C._tmin=null,C._tmax=null}}return function(fe){return o.tickText(C,fe).text}},r.calcTextOpts=function(I,F,j,z){var q=F(I);j.text(q).call(a.convertToTspans,z);var C=j.node(),G=n.bBox(C,!0);return{text:q,width:G.width,height:G.height,fontSize:+C.style["font-size"].replace("px",""),level:I,dy:(G.top+G.bottom)/2}},r.findBestTextLocation=function(I,F,j,z,q){var C=j.width,G,Q,fe,ue,K;F.isClosed?(Q=F.len/O.INITIALSEARCHPOINTS,G=F.min+Q/2,fe=F.max):(Q=(F.len-C)/(O.INITIALSEARCHPOINTS+1),G=F.min+Q+C/2,fe=F.max-(Q+C)/2);for(var se=1/0,Te=0;Te<O.ITERATIONS;Te++){for(var ye=G;ye<fe;ye+=Q){var Fe=t.getTextLocation(I,F.total,ye,C),Qe=M(Fe,j,z,q);Qe<se&&(se=Qe,K=Fe,ue=ye)}if(se>O.MAXCOST*2)break;Te&&(Q/=2),G=ue-Q/2,fe=G+Q*1.5}if(se<=O.MAXCOST)return K};function M(I,F,j,z){var q=F.width/2,C=F.height/2,G=I.x,Q=I.y,fe=I.theta,ue=Math.cos(fe)*q,K=Math.sin(fe)*q,se=(G>z.center?z.right-G:G-z.left)/(ue+Math.abs(Math.sin(fe)*C)),Te=(Q>z.middle?z.bottom-Q:Q-z.top)/(Math.abs(K)+Math.cos(fe)*C);if(se<1||Te<1)return 1/0;var ye=O.EDGECOST*(1/(se-1)+1/(Te-1));ye+=O.ANGLECOST*fe*fe;for(var Fe=G-ue,Qe=Q-K,qe=G+ue,pe=Q+K,Se=0;Se<j.length;Se++){var xe=j[Se],je=Math.cos(xe.theta)*xe.width/2,tr=Math.sin(xe.theta)*xe.width/2,He=t.segmentDistance(Fe,Qe,qe,pe,xe.x-je,xe.y-tr,xe.x+je,xe.y+tr)*2/(F.height+xe.height),Je=xe.level===F.level,or=Je?O.SAMELEVELDISTANCE:1;if(He<=or)return 1/0;var ir=O.NEIGHBORCOST*(Je?O.SAMELEVELFACTOR:1);ye+=ir/(He-or)}return ye}r.addLabelData=function(I,F,j,z){var q=F.fontSize,C=F.width+q/3,G=Math.max(0,F.height-q/3),Q=I.x,fe=I.y,ue=I.theta,K=Math.sin(ue),se=Math.cos(ue),Te=function(Fe,Qe){return[Q+Fe*se-Qe*K,fe+Fe*K+Qe*se]},ye=[Te(-C/2,-G/2),Te(-C/2,G/2),Te(C/2,G/2),Te(C/2,-G/2)];j.push({text:F.text,x:Q,y:fe,dy:F.dy,theta:ue,level:F.level,width:C,height:G}),z.push(ye)},r.drawLabels=function(I,F,j,z,q){var C=I.selectAll("text").data(F,function(ue){return ue.text+","+ue.x+","+ue.y+","+ue.theta});if(C.exit().remove(),C.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(ue){var K=ue.x+Math.sin(ue.theta)*ue.dy,se=ue.y-Math.cos(ue.theta)*ue.dy;e.select(this).text(ue.text).attr({x:K,y:se,transform:"rotate("+180*ue.theta/Math.PI+" "+K+" "+se+")"}).call(a.convertToTspans,j)}),q){for(var G="",Q=0;Q<q.length;Q++)G+="M"+q[Q].join("L")+"Z";var fe=t.ensureSingle(z,"path","");fe.attr("d",G)}};function B(I,F,j,z,q){var C=z.trace,G=j._fullLayout._clips,Q="clip"+C.uid,fe=G.selectAll("#"+Q).data(C.connectgaps?[]:[0]);if(fe.enter().append("clipPath").classed("contourclip",!0).attr("id",Q),fe.exit().remove(),C.connectgaps===!1){var ue={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:F.xaxis,yaxis:F.yaxis,x:z.x,y:z.y,z:V(z),smoothing:0};s([ue]),u([ue]),c([ue],{type:"levels"});var K=t.ensureSingle(fe,"path","");K.attr("d",(ue.prefixBoundary?"M"+q.join("L")+"Z":"")+R(ue,q))}else Q=null;n.setClipUrl(I,Q,j)}function V(I){var F=I.trace._emptypoints,j=[],z=I.z.length,q=I.z[0].length,C,G=[],Q;for(C=0;C<q;C++)G.push(1);for(C=0;C<z;C++)j.push(G.slice());for(C=0;C<F.length;C++)Q=F[C],j[Q[0]][Q[1]]=0;return I.zmask=j,j}})(f0);var tw=Ja,nw=function(e){tw.select(e).selectAll(".hm image").style("opacity",function(t){return t.trace.opacity})},aw=Ja,gs=Rn,iw=po,v0=function(e){var t=e.contours,n=t.start,i=iw(t),a=t.size||1,o=Math.floor((i-n)/a)+1,f=t.coloring==="lines"?0:1,l=gs.extractOpts(e);isFinite(a)||(a=1,o=1);var s=l.reversescale?gs.flipScale(l.colorscale):l.colorscale,u=s.length,v=new Array(u),d=new Array(u),c,p,O=l.min,g=l.max;if(t.coloring==="heatmap"){for(p=0;p<u;p++)c=s[p],v[p]=c[0]*(g-O)+O,d[p]=c[1];var y=aw.extent([O,g,t.start,t.start+a*(o-1)]),R=y[O<g?0:1],T=y[O<g?1:0];R!==O&&(v.splice(0,0,R),d.splice(0,0,d[0])),T!==g&&(v.push(T),d.push(d[d.length-1]))}else{var M=e._input&&typeof e._input.zmin=="number"&&typeof e._input.zmax=="number";for(M&&(n<=O||i>=g)&&(n<=O&&(n=O),i>=g&&(i=g),o=Math.floor((i-n)/a)+1,f=0),p=0;p<u;p++)c=s[p],v[p]=(c[0]*(o+f-1)-f/2)*a+n,d[p]=c[1];(M||e.autocontour)&&(v[0]>O&&(v.unshift(O),d.unshift(d[0])),v[v.length-1]<g&&(v.push(g),d.push(d[d.length-1])))}return gs.makeColorScaleFunc({domain:v,range:d},{noNumericCheck:!0})},Vi=Ja,Md=Xa,ow=nw,lw=v0,fw=function(e){var t=Vi.select(e).selectAll("g.contour");t.style("opacity",function(n){return n[0].trace.opacity}),t.each(function(n){var i=Vi.select(this),a=n[0].trace,o=a.contours,f=a.line,l=o.size||1,s=o.start,u=o.type==="constraint",v=!u&&o.coloring==="lines",d=!u&&o.coloring==="fill",c=v||d?lw(a):null;i.selectAll("g.contourlevel").each(function(g){Vi.select(this).selectAll("path").call(Md.lineGroupStyle,f.width,v?c(g.level):f.color,f.dash)});var p=o.labelfont;if(i.selectAll("g.contourlabels text").each(function(g){Md.font(Vi.select(this),{weight:p.weight,style:p.style,variant:p.variant,textcase:p.textcase,lineposition:p.lineposition,shadow:p.shadow,family:p.family,size:p.size,color:p.color||(v?c(g.level):f.color)})}),u)i.selectAll("g.contourfill path").style("fill",a.fillcolor);else if(d){var O;i.selectAll("g.contourfill path").style("fill",function(g){return O===void 0&&(O=g.level),c(g.level+.5*l)}),O===void 0&&(O=s),i.selectAll("g.contourbg path").style("fill",c(O-.5*l))}}),ow(e)},Id=Rn,sw=v0,uw=po;function cw(r,e,t){var n=e.contours,i=e.line,a=n.size||1,o=n.coloring,f=sw(e);if(o==="heatmap"){var l=Id.extractOpts(e);t._fillgradient=l.reversescale?Id.flipScale(l.colorscale):l.colorscale,t._zrange=[l.min,l.max]}else o==="fill"&&(t._fillcolor=f);t._line={color:o==="lines"?f:i.color,width:n.showlines!==!1?i.width:0,dash:i.dash},t._levels={start:n.start,end:uw(n),size:a}}var vw={min:"zmin",max:"zmax",calc:cw},Nd=Mm,Ua=wr,qi=Ua.isArrayOrTypedArray,hw=hn,dw=Rn.extractOpts,pw=function(e,t,n,i,a){a||(a={});var o=a.isContour,f=e.cd[0],l=f.trace,s=e.xa,u=e.ya,v=f.x,d=f.y,c=f.z,p=f.xCenter,O=f.yCenter,g=f.zmask,y=l.zhoverformat,R=v,T=d,M,B,V,I;if(e.index!==!1){try{V=Math.round(e.index[1]),I=Math.round(e.index[0])}catch{Ua.error("Error hovering on heatmap, pointNumber must be [row,col], found:",e.index);return}if(V<0||V>=c[0].length||I<0||I>c.length)return}else{if(Nd.inbox(t-v[0],t-v[v.length-1],0)>0||Nd.inbox(n-d[0],n-d[d.length-1],0)>0)return;if(o){var F;for(R=[2*v[0]-v[1]],F=1;F<v.length;F++)R.push((v[F]+v[F-1])/2);for(R.push([2*v[v.length-1]-v[v.length-2]]),T=[2*d[0]-d[1]],F=1;F<d.length;F++)T.push((d[F]+d[F-1])/2);T.push([2*d[d.length-1]-d[d.length-2]])}V=Math.max(0,Math.min(R.length-2,Ua.findBin(t,R))),I=Math.max(0,Math.min(T.length-2,Ua.findBin(n,T)))}var j=s.c2p(v[V]),z=s.c2p(v[V+1]),q=u.c2p(d[I]),C=u.c2p(d[I+1]),G,Q;o?(G=f.orig_x||v,Q=f.orig_y||d,z=j,M=G[V],C=q,B=Q[I]):(G=f.orig_x||p||v,Q=f.orig_y||O||d,M=p?G[V]:(G[V]+G[V+1])/2,B=O?Q[I]:(Q[I]+Q[I+1])/2,s&&s.type==="category"&&(M=v[V]),u&&u.type==="category"&&(B=d[I]),l.zsmooth&&(j=z=s.c2p(M),q=C=u.c2p(B)));var fe=c[I][V];if(g&&!g[I][V]&&(fe=void 0),!(fe===void 0&&!l.hoverongaps)){var ue;qi(f.hovertext)&&qi(f.hovertext[I])?ue=f.hovertext[I][V]:qi(f.text)&&qi(f.text[I])&&(ue=f.text[I][V]);var K=dw(l),se={type:"linear",range:[K.min,K.max],hoverformat:y,_separators:s._separators,_numFormat:s._numFormat},Te=hw.tickText(se,fe,"hover").text;return[Ua.extendFlat(e,{index:l._after2before?l._after2before[I][V]:[I,V],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:j,x1:z,y0:q,y1:C,xLabelVal:M,yLabelVal:B,zLabelVal:fe,zLabel:Te,text:ue})]}},Hi=ro,yw=pw,mw=function(e,t,n,i,a){a||(a={}),a.isContour=!0;var o=yw(e,t,n,i,a);return o&&o.forEach(function(f){var l=f.trace;l.contours.type==="constraint"&&(l.fillcolor&&Hi.opacity(l.fillcolor)?f.color=Hi.addOpacity(l.fillcolor,1):l.contours.showlines&&Hi.opacity(l.line.color)&&(f.color=Hi.addOpacity(l.line.color,1)))}),o},gw={attributes:n0,supplyDefaults:Z2,calc:CA,plot:f0.plot,style:fw,colorbar:vw,hoverPoints:mw,moduleType:"trace",name:"contour",basePlotModule:jd,categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{description:["The data from which contour lines are computed is set in `z`.","Data in `z` must be a {2D array} of numbers.","Say that `z` has N rows and M columns, then by default,","these N rows correspond to N y coordinates","(set in `y` or auto-generated) and the M columns","correspond to M x coordinates (set in `x` or auto-generated).","By setting `transpose` to *true*, the above behavior is flipped."].join(" ")}},xw=gw;const bw=Ds(xw);Im.register([Bm,m2,bw]);export{Im as default};
